2026-Jan-18 16:57:40.246019 Starting deployment of Erkondus/Eleicao:main to servidor2.
2026-Jan-18 16:57:40.947660 Preparing container with helper image: ghcr.io/coollabsio/coolify-helper:1.0.12
2026-Jan-18 16:57:41.302082 [CMD]: docker stop -t 30 hcckg4sggwwogskw8soscgcw
2026-Jan-18 16:57:41.302082 Error response from daemon: No such container: hcckg4sggwwogskw8soscgcw
2026-Jan-18 16:57:41.773048 [CMD]: docker run -d --network coolify --name hcckg4sggwwogskw8soscgcw  --rm -v /var/run/docker.sock:/var/run/docker.sock ghcr.io/coollabsio/coolify-helper:1.0.12
2026-Jan-18 16:57:41.773048 8334a377d598af80441315a36b5169b8de8841e23b4451f4490324b2cdeb8624
2026-Jan-18 16:57:43.151393 [CMD]: docker exec hcckg4sggwwogskw8soscgcw bash -c 'GIT_SSH_COMMAND="ssh -o ConnectTimeout=30 -p 22 -o Port=22 -o LogLevel=ERROR -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null" git ls-remote https://github.com/Erkondus/Eleicao refs/heads/main'
2026-Jan-18 16:57:43.151393 17fb466bc8d27ad3536f8aa75bf016bdb6d8c698	refs/heads/main
2026-Jan-18 16:57:43.170087 ----------------------------------------
2026-Jan-18 16:57:43.176093 Importing Erkondus/Eleicao:main (commit sha 17fb466bc8d27ad3536f8aa75bf016bdb6d8c698) to /artifacts/hcckg4sggwwogskw8soscgcw.
2026-Jan-18 16:57:43.585224 [CMD]: docker exec hcckg4sggwwogskw8soscgcw bash -c 'git clone --depth=1 --recurse-submodules --shallow-submodules -b 'main' 'https://github.com/Erkondus/Eleicao' '/artifacts/hcckg4sggwwogskw8soscgcw' && cd '/artifacts/hcckg4sggwwogskw8soscgcw' && if [ -f .gitmodules ]; then sed -i "s#git@\(.*\):#https://\1/#g" '/artifacts/hcckg4sggwwogskw8soscgcw'/.gitmodules || true && git submodule sync && GIT_SSH_COMMAND="ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null" git submodule update --init --recursive --depth=1; fi && cd '/artifacts/hcckg4sggwwogskw8soscgcw' && GIT_SSH_COMMAND="ssh -o StrictHostKeyChecking=no -o UserKnownHostsFile=/dev/null" git lfs pull'
2026-Jan-18 16:57:43.585224 Cloning into '/artifacts/hcckg4sggwwogskw8soscgcw'...
2026-Jan-18 16:57:46.063339 [CMD]: docker exec hcckg4sggwwogskw8soscgcw bash -c 'cd /artifacts/hcckg4sggwwogskw8soscgcw && git log -1 17fb466bc8d27ad3536f8aa75bf016bdb6d8c698 --pretty=%B'
2026-Jan-18 16:57:46.063339 feat(docker): add docker-compose config for production deployment
2026-Jan-18 16:57:46.063339 
2026-Jan-18 16:57:46.063339 Add new docker-compose.yaml configuration optimized for production deployment with Coolify network support. Remove local database service and configure DNS settings for external hostname resolution. Update DEPLOY.md with DNS troubleshooting guide.
2026-Jan-18 16:57:47.689724 [CMD]: docker exec hcckg4sggwwogskw8soscgcw bash -c 'cat /artifacts/hcckg4sggwwogskw8soscgcw/Dockerfile'
2026-Jan-18 16:57:47.689724 FROM node:20-alpine AS builder
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 WORKDIR /app
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 COPY package*.json ./
2026-Jan-18 16:57:47.689724 RUN npm ci
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 COPY . .
2026-Jan-18 16:57:47.689724 RUN npm run build
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 FROM node:20-alpine AS runner
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 WORKDIR /app
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 RUN apk add --no-cache dumb-init
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 ENV NODE_ENV=production
2026-Jan-18 16:57:47.689724 ENV PORT=5000
2026-Jan-18 16:57:47.689724 # Force IPv4 DNS resolution to fix ENETUNREACH errors with cloud databases
2026-Jan-18 16:57:47.689724 ENV NODE_OPTIONS="--dns-result-order=ipv4first"
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 COPY --from=builder /app/dist ./dist
2026-Jan-18 16:57:47.689724 COPY --from=builder /app/package*.json ./
2026-Jan-18 16:57:47.689724 COPY --from=builder /app/drizzle.config.ts ./
2026-Jan-18 16:57:47.689724 COPY --from=builder /app/shared ./shared
2026-Jan-18 16:57:47.689724 COPY --from=builder /app/server ./server
2026-Jan-18 16:57:47.689724 COPY --from=builder /app/node_modules ./node_modules
2026-Jan-18 16:57:47.689724 COPY docker-entrypoint.sh ./
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 RUN addgroup --system --gid 1001 nodejs && \
2026-Jan-18 16:57:47.689724 adduser --system --uid 1001 expressjs && \
2026-Jan-18 16:57:47.689724 chown -R expressjs:nodejs /app
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 RUN chmod +x docker-entrypoint.sh
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 USER expressjs
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 EXPOSE 5000
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
2026-Jan-18 16:57:47.689724 CMD wget --no-verbose --tries=1 --spider http://localhost:5000/api/health || exit 1
2026-Jan-18 16:57:47.689724 
2026-Jan-18 16:57:47.689724 ENTRYPOINT ["dumb-init", "--"]
2026-Jan-18 16:57:47.689724 CMD ["./docker-entrypoint.sh"]
2026-Jan-18 16:57:48.123513 Creating build-time .env file in /artifacts (outside Docker context).
2026-Jan-18 16:57:48.952734 [CMD]: docker exec hcckg4sggwwogskw8soscgcw bash -c 'cat /artifacts/hcckg4sggwwogskw8soscgcw/Dockerfile'
2026-Jan-18 16:57:48.952734 FROM node:20-alpine AS builder
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 WORKDIR /app
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 COPY package*.json ./
2026-Jan-18 16:57:48.952734 RUN npm ci
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 COPY . .
2026-Jan-18 16:57:48.952734 RUN npm run build
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 FROM node:20-alpine AS runner
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 WORKDIR /app
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 RUN apk add --no-cache dumb-init
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 ENV NODE_ENV=production
2026-Jan-18 16:57:48.952734 ENV PORT=5000
2026-Jan-18 16:57:48.952734 # Force IPv4 DNS resolution to fix ENETUNREACH errors with cloud databases
2026-Jan-18 16:57:48.952734 ENV NODE_OPTIONS="--dns-result-order=ipv4first"
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 COPY --from=builder /app/dist ./dist
2026-Jan-18 16:57:48.952734 COPY --from=builder /app/package*.json ./
2026-Jan-18 16:57:48.952734 COPY --from=builder /app/drizzle.config.ts ./
2026-Jan-18 16:57:48.952734 COPY --from=builder /app/shared ./shared
2026-Jan-18 16:57:48.952734 COPY --from=builder /app/server ./server
2026-Jan-18 16:57:48.952734 COPY --from=builder /app/node_modules ./node_modules
2026-Jan-18 16:57:48.952734 COPY docker-entrypoint.sh ./
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 RUN addgroup --system --gid 1001 nodejs && \
2026-Jan-18 16:57:48.952734 adduser --system --uid 1001 expressjs && \
2026-Jan-18 16:57:48.952734 chown -R expressjs:nodejs /app
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 RUN chmod +x docker-entrypoint.sh
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 USER expressjs
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 EXPOSE 5000
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
2026-Jan-18 16:57:48.952734 CMD wget --no-verbose --tries=1 --spider http://localhost:5000/api/health || exit 1
2026-Jan-18 16:57:48.952734 
2026-Jan-18 16:57:48.952734 ENTRYPOINT ["dumb-init", "--"]
2026-Jan-18 16:57:48.952734 CMD ["./docker-entrypoint.sh"]
2026-Jan-18 16:57:48.972124 Final Dockerfile:
2026-Jan-18 16:57:49.785591 [CMD]: docker exec hcckg4sggwwogskw8soscgcw bash -c 'cat /artifacts/hcckg4sggwwogskw8soscgcw/Dockerfile'
2026-Jan-18 16:57:49.785591 FROM node:20-alpine AS builder
2026-Jan-18 16:57:49.785591 ARG DATABASE_URL=postgresql://postgres:<REDACTED>:5432/postgres
2026-Jan-18 16:57:49.785591 ARG PORT=5000
2026-Jan-18 16:57:49.785591 ARG SESSION_SECRET=Edehx0r80qv7T6hMFPfhEUiyzNLSlBCm+gw34t/vG7w=
2026-Jan-18 16:57:49.785591 ARG OPENAI_API_KEY=<REDACTED>
2026-Jan-18 16:57:49.785591 ARG COOLIFY_URL=https://simulavoto.bpxgroup.com.br
2026-Jan-18 16:57:49.785591 ARG COOLIFY_FQDN=simulavoto.bpxgroup.com.br
2026-Jan-18 16:57:49.785591 ARG COOLIFY_BRANCH=main
2026-Jan-18 16:57:49.785591 ARG COOLIFY_RESOURCE_UUID=zsg08co8ocgcgoo4o8okgccw
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 WORKDIR /app
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 COPY package*.json ./
2026-Jan-18 16:57:49.785591 RUN npm ci
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 COPY . .
2026-Jan-18 16:57:49.785591 RUN npm run build
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 FROM node:20-alpine AS runner
2026-Jan-18 16:57:49.785591 ARG DATABASE_URL=postgresql://postgres:<REDACTED>:5432/postgres
2026-Jan-18 16:57:49.785591 ARG PORT=5000
2026-Jan-18 16:57:49.785591 ARG SESSION_SECRET=Edehx0r80qv7T6hMFPfhEUiyzNLSlBCm+gw34t/vG7w=
2026-Jan-18 16:57:49.785591 ARG OPENAI_API_KEY=<REDACTED>
2026-Jan-18 16:57:49.785591 ARG COOLIFY_URL=https://simulavoto.bpxgroup.com.br
2026-Jan-18 16:57:49.785591 ARG COOLIFY_FQDN=simulavoto.bpxgroup.com.br
2026-Jan-18 16:57:49.785591 ARG COOLIFY_BRANCH=main
2026-Jan-18 16:57:49.785591 ARG COOLIFY_RESOURCE_UUID=zsg08co8ocgcgoo4o8okgccw
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 WORKDIR /app
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 RUN apk add --no-cache dumb-init
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 ENV NODE_ENV=production
2026-Jan-18 16:57:49.785591 ENV PORT=5000
2026-Jan-18 16:57:49.785591 # Force IPv4 DNS resolution to fix ENETUNREACH errors with cloud databases
2026-Jan-18 16:57:49.785591 ENV NODE_OPTIONS="--dns-result-order=ipv4first"
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 COPY --from=builder /app/dist ./dist
2026-Jan-18 16:57:49.785591 COPY --from=builder /app/package*.json ./
2026-Jan-18 16:57:49.785591 COPY --from=builder /app/drizzle.config.ts ./
2026-Jan-18 16:57:49.785591 COPY --from=builder /app/shared ./shared
2026-Jan-18 16:57:49.785591 COPY --from=builder /app/server ./server
2026-Jan-18 16:57:49.785591 COPY --from=builder /app/node_modules ./node_modules
2026-Jan-18 16:57:49.785591 COPY docker-entrypoint.sh ./
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 RUN addgroup --system --gid 1001 nodejs && \
2026-Jan-18 16:57:49.785591 adduser --system --uid 1001 expressjs && \
2026-Jan-18 16:57:49.785591 chown -R expressjs:nodejs /app
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 RUN chmod +x docker-entrypoint.sh
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 USER expressjs
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 EXPOSE 5000
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 HEALTHCHECK --interval=30s --timeout=10s --start-period=5s --retries=3 \
2026-Jan-18 16:57:49.785591 CMD wget --no-verbose --tries=1 --spider http://localhost:5000/api/health || exit 1
2026-Jan-18 16:57:49.785591 
2026-Jan-18 16:57:49.785591 ENTRYPOINT ["dumb-init", "--"]
2026-Jan-18 16:57:49.785591 CMD ["./docker-entrypoint.sh"]
2026-Jan-18 16:57:49.793926 ----------------------------------------
2026-Jan-18 16:57:49.801536 Building docker image started.
2026-Jan-18 16:57:49.807242 To check the current progress, click on Show Debug Logs.
2026-Jan-18 16:57:50.633702 [CMD]: docker exec hcckg4sggwwogskw8soscgcw bash -c 'cat /artifacts/build.sh'
2026-Jan-18 16:57:50.633702 cd /artifacts/hcckg4sggwwogskw8soscgcw && set -a && source /artifacts/build-time.env && set +a && docker build --no-cache   --network host -f /artifacts/hcckg4sggwwogskw8soscgcw/Dockerfile --build-arg COOLIFY_URL --build-arg COOLIFY_FQDN --build-arg COOLIFY_BRANCH --build-arg COOLIFY_RESOURCE_UUID --build-arg DATABASE_URL --build-arg PORT --build-arg SESSION_SECRET --build-arg OPENAI_API_KEY --build-arg COOLIFY_BUILD_SECRETS_HASH=f4fb9b6943d2a9dbe1ea7a0a0927c0f414c37026f8e3e2be7f81b7d918ffedd5 --build-arg 'COOLIFY_URL' --build-arg 'COOLIFY_FQDN' --build-arg 'COOLIFY_BRANCH' --build-arg 'COOLIFY_RESOURCE_UUID' --progress plain -t zsg08co8ocgcgoo4o8okgccw:17fb466bc8d27ad3536f8aa75bf016bdb6d8c698 /artifacts/hcckg4sggwwogskw8soscgcw
2026-Jan-18 16:57:51.685158 [CMD]: docker exec hcckg4sggwwogskw8soscgcw bash -c 'bash /artifacts/build.sh'
2026-Jan-18 16:57:51.685158 #0 building with "default" instance using docker driver
2026-Jan-18 16:57:51.685158 
2026-Jan-18 16:57:51.685158 #1 [internal] load build definition from Dockerfile
2026-Jan-18 16:57:51.687924 #1 transferring dockerfile: 2.17kB 0.0s done
2026-Jan-18 16:57:51.687924 #1 DONE 0.0s
2026-Jan-18 16:57:51.687924 
2026-Jan-18 16:57:51.687924 #2 [internal] load metadata for docker.io/library/node:20-alpine
2026-Jan-18 16:57:52.502247 #2 DONE 1.0s
2026-Jan-18 16:57:52.708489 #3 [internal] load .dockerignore
2026-Jan-18 16:57:52.708489 #3 transferring context: 150B done
2026-Jan-18 16:57:52.708489 #3 DONE 0.0s
2026-Jan-18 16:57:52.708489 
2026-Jan-18 16:57:52.708489 #4 [builder 1/6] FROM docker.io/library/node:20-alpine@sha256:3960ed74dfe320a67bf8da9555b6bade25ebda2b22b6081d2f60fd7d5d430e9c
2026-Jan-18 16:57:52.708489 #4 resolve docker.io/library/node:20-alpine@sha256:3960ed74dfe320a67bf8da9555b6bade25ebda2b22b6081d2f60fd7d5d430e9c 0.0s done
2026-Jan-18 16:57:52.708489 #4 DONE 0.0s
2026-Jan-18 16:57:52.708489 
2026-Jan-18 16:57:52.708489 #5 [builder 2/6] WORKDIR /app
2026-Jan-18 16:57:52.708489 #5 CACHED
2026-Jan-18 16:57:52.708489 
2026-Jan-18 16:57:52.708489 #6 [internal] load build context
2026-Jan-18 16:57:52.872411 #6 transferring context: 12.10MB 0.2s done
2026-Jan-18 16:57:52.872411 #6 DONE 0.2s
2026-Jan-18 16:57:52.872411 
2026-Jan-18 16:57:52.872411 #7 [builder 3/6] COPY package*.json ./
2026-Jan-18 16:57:52.872411 #7 DONE 0.1s
2026-Jan-18 16:57:52.872411 
2026-Jan-18 16:57:52.872411 #8 [runner  3/12] RUN apk add --no-cache dumb-init
2026-Jan-18 16:57:53.606587 #8 1.028 (1/1) Installing dumb-init (1.2.5-r3)
2026-Jan-18 16:57:53.729906 #8 1.039 Executing busybox-1.37.0-r30.trigger
2026-Jan-18 16:57:53.729906 #8 1.081 OK: 10.9 MiB in 19 packages
2026-Jan-18 16:57:53.729906 #8 DONE 1.1s
2026-Jan-18 16:57:53.729906 
2026-Jan-18 16:57:53.729906 #9 [builder 4/6] RUN npm ci
2026-Jan-18 16:58:09.139102 #9 16.27
2026-Jan-18 16:58:09.139102 #9 16.27 added 539 packages, and audited 540 packages in 16s
2026-Jan-18 16:58:09.139102 #9 16.27
2026-Jan-18 16:58:09.139102 #9 16.27 74 packages are looking for funding
2026-Jan-18 16:58:09.139102 #9 16.27   run `npm fund` for details
2026-Jan-18 16:58:09.309948 #9 16.28
2026-Jan-18 16:58:09.309948 #9 16.28 3 high severity vulnerabilities
2026-Jan-18 16:58:09.309948 #9 16.28
2026-Jan-18 16:58:09.309948 #9 16.28 To address all issues, run:
2026-Jan-18 16:58:09.309948 #9 16.28   npm audit fix
2026-Jan-18 16:58:09.309948 #9 16.28
2026-Jan-18 16:58:09.309948 #9 16.28 Run `npm audit` for details.
2026-Jan-18 16:58:09.309948 #9 16.28 npm notice
2026-Jan-18 16:58:09.309948 #9 16.28 npm notice New major version of npm available! 10.8.2 -> 11.7.0
2026-Jan-18 16:58:09.309948 #9 16.28 npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.7.0
2026-Jan-18 16:58:09.309948 #9 16.28 npm notice To update run: npm install -g npm@11.7.0
2026-Jan-18 16:58:09.309948 #9 16.28 npm notice
2026-Jan-18 16:58:10.047147 #9 DONE 17.2s
2026-Jan-18 16:58:10.200422 #10 [builder 5/6] COPY . .
2026-Jan-18 16:58:10.632982 #10 DONE 0.6s
2026-Jan-18 16:58:10.786557 #11 [builder 6/6] RUN npm run build
2026-Jan-18 16:58:11.001071 #11 0.365
2026-Jan-18 16:58:11.001071 #11 0.365 > rest-express@1.0.0 build
2026-Jan-18 16:58:11.001071 #11 0.365 > tsx script/build.ts
2026-Jan-18 16:58:11.001071 #11 0.365
2026-Jan-18 16:58:12.305816 #11 1.670 building client...
2026-Jan-18 16:58:12.422360 #11 1.787 vite v7.3.0 building client environment for production...
2026-Jan-18 16:58:13.157889 #11 2.522 transforming...
2026-Jan-18 16:58:15.100583 #11 4.465
2026-Jan-18 16:58:15.100583 #11 4.465 A PostCSS plugin did not pass the `from` option to `postcss.parse`. This may cause imported assets to be incorrectly transformed. If you've recently added a PostCSS plugin that raised this warning, please contact the package author to fix the issue.
2026-Jan-18 16:58:24.210353 #11 13.57 ✓ 2628 modules transformed.
2026-Jan-18 16:58:24.893400 #11 14.26 rendering chunks...
2026-Jan-18 16:58:25.432056 #11 14.80 computing gzip size...
2026-Jan-18 16:58:25.653330 #11 14.86 ../dist/public/index.html                              2.01 kB │ gzip:   0.77 kB
2026-Jan-18 16:58:25.653330 #11 14.86 ../dist/public/assets/index-DCOJjWfS.css             100.61 kB │ gzip:  15.38 kB
2026-Jan-18 16:58:25.653330 #11 14.86 ../dist/public/assets/purify.es-Bzr520pe.js           22.45 kB │ gzip:   8.63 kB
2026-Jan-18 16:58:25.653330 #11 14.86 ../dist/public/assets/index.es-XeApgkjF.js           158.55 kB │ gzip:  52.90 kB
2026-Jan-18 16:58:25.653330 #11 14.86 ../dist/public/assets/html2canvas.esm-DXEQVQnt.js    201.04 kB │ gzip:  47.43 kB
2026-Jan-18 16:58:25.653330 #11 14.86 ../dist/public/assets/index-DKLVkW5j.js            1,519.18 kB │ gzip: 432.65 kB
2026-Jan-18 16:58:25.653330 #11 14.86
2026-Jan-18 16:58:25.653330 #11 14.86 (!) Some chunks are larger than 500 kB after minification. Consider:
2026-Jan-18 16:58:25.653330 #11 14.86 - Using dynamic import() to code-split the application
2026-Jan-18 16:58:25.653330 #11 14.86 - Use build.rollupOptions.output.manualChunks to improve chunking: https://rollupjs.org/configuration-options/#output-manualchunks
2026-Jan-18 16:58:25.653330 #11 14.86 - Adjust chunk size limit for this warning via build.chunkSizeWarningLimit.
2026-Jan-18 16:58:25.653330 #11 14.86 ✓ built in 12.40s
2026-Jan-18 16:58:25.653330 #11 14.86 building server...
2026-Jan-18 16:58:25.947147 #11 15.31
2026-Jan-18 16:58:25.947147 #11 15.31   dist/index.cjs  950.1kb
2026-Jan-18 16:58:25.947147 #11 15.31
2026-Jan-18 16:58:25.947147 #11 15.31 ⚡ Done in 432ms
2026-Jan-18 16:58:26.220516 #11 DONE 15.6s
2026-Jan-18 16:58:41.547749 #12 [runner  4/12] COPY --from=builder /app/dist ./dist
2026-Jan-18 16:58:41.760019 #12 DONE 0.1s
2026-Jan-18 16:58:41.760019 
2026-Jan-18 16:58:41.760019 #13 [runner  5/12] COPY --from=builder /app/package*.json ./
2026-Jan-18 16:58:42.408614 #13 DONE 0.8s
2026-Jan-18 16:58:42.655109 #14 [runner  6/12] COPY --from=builder /app/drizzle.config.ts ./
2026-Jan-18 16:58:42.655109 #14 DONE 0.0s
2026-Jan-18 16:58:42.655109 
2026-Jan-18 16:58:42.655109 #15 [runner  7/12] COPY --from=builder /app/shared ./shared
2026-Jan-18 16:58:42.655109 #15 DONE 0.0s
2026-Jan-18 16:58:42.655109 
2026-Jan-18 16:58:42.655109 #16 [runner  8/12] COPY --from=builder /app/server ./server
2026-Jan-18 16:58:42.655109 #16 DONE 0.0s
2026-Jan-18 16:58:42.655109 
2026-Jan-18 16:58:42.655109 #17 [runner  9/12] COPY --from=builder /app/node_modules ./node_modules
2026-Jan-18 16:58:50.778365 #17 DONE 8.3s
2026-Jan-18 16:58:50.932535 #18 [runner 10/12] COPY docker-entrypoint.sh ./
2026-Jan-18 16:58:51.065230 #18 DONE 0.3s
2026-Jan-18 16:58:51.218320 #19 [runner 11/12] RUN addgroup --system --gid 1001 nodejs &&     adduser --system --uid 1001 expressjs &&     chown -R expressjs:nodejs /app
2026-Jan-18 16:59:40.846066 #19 DONE 49.8s
2026-Jan-18 16:59:40.998845 #20 [runner 12/12] RUN chmod +x docker-entrypoint.sh
2026-Jan-18 16:59:41.180142 #20 DONE 0.3s
2026-Jan-18 16:59:41.336484 #21 exporting to image
2026-Jan-18 16:59:41.336484 #21 exporting layers
2026-Jan-18 17:00:09.949869 #21 exporting layers 28.8s done
2026-Jan-18 17:00:10.080259 #21 exporting manifest sha256:a7be734b32be85ce6db73ec53e39d430e7bbde1d1e9ed1198ad3d95ccb03ca48 0.0s done
2026-Jan-18 17:00:10.080259 #21 exporting config sha256:4c33740ef0590bcecae3b3ee321c58ae9025051080c820ad004f2213254dfbb1 0.0s done
2026-Jan-18 17:00:10.080259 #21 exporting attestation manifest sha256:ccd1b4770083415fa6eb9c99af80f3ac2986b016f999898216279dc6ec261e55
2026-Jan-18 17:00:10.201512 #21 exporting attestation manifest sha256:ccd1b4770083415fa6eb9c99af80f3ac2986b016f999898216279dc6ec261e55 0.1s done
2026-Jan-18 17:00:10.201512 #21 exporting manifest list sha256:17990ed8dc2007957fe27fadd63113debbe918d95076d1b28743f5df059d19c4
2026-Jan-18 17:00:10.421007 #21 exporting manifest list sha256:17990ed8dc2007957fe27fadd63113debbe918d95076d1b28743f5df059d19c4 0.0s done
2026-Jan-18 17:00:10.421007 #21 naming to docker.io/library/zsg08co8ocgcgoo4o8okgccw:17fb466bc8d27ad3536f8aa75bf016bdb6d8c698 0.0s done
2026-Jan-18 17:00:10.421007 #21 unpacking to docker.io/library/zsg08co8ocgcgoo4o8okgccw:17fb466bc8d27ad3536f8aa75bf016bdb6d8c698
2026-Jan-18 17:00:30.675970 #21 unpacking to docker.io/library/zsg08co8ocgcgoo4o8okgccw:17fb466bc8d27ad3536f8aa75bf016bdb6d8c698 20.4s done
2026-Jan-18 17:00:30.867081 #21 DONE 49.5s
2026-Jan-18 17:00:30.874405 4 warnings found (use docker --debug to expand):
2026-Jan-18 17:00:30.874405 - SecretsUsedInArgOrEnv: Do not use ARG or ENV instructions for sensitive data (ARG "OPENAI_API_KEY") (line 23)
2026-Jan-18 17:00:30.874405 - SecretsUsedInArgOrEnv: Do not use ARG or ENV instructions for sensitive data (ARG "SESSION_SECRET") (line 4)
2026-Jan-18 17:00:30.874405 - SecretsUsedInArgOrEnv: Do not use ARG or ENV instructions for sensitive data (ARG "OPENAI_API_KEY") (line 5)
2026-Jan-18 17:00:30.874405 - SecretsUsedInArgOrEnv: Do not use ARG or ENV instructions for sensitive data (ARG "SESSION_SECRET") (line 22)
2026-Jan-18 17:00:30.896613 Building docker image completed.
2026-Jan-18 17:00:30.935200 Creating .env file with runtime variables for container.
2026-Jan-18 17:00:31.900320 ----------------------------------------
2026-Jan-18 17:00:31.914299 Rolling update started.
2026-Jan-18 17:00:32.979050 [CMD]: docker exec hcckg4sggwwogskw8soscgcw bash -c 'COOLIFY_URL=https://simulavoto.bpxgroup.com.br COOLIFY_FQDN=simulavoto.bpxgroup.com.br COOLIFY_BRANCH=main COOLIFY_RESOURCE_UUID=zsg08co8ocgcgoo4o8okgccw  docker compose --project-name zsg08co8ocgcgoo4o8okgccw --project-directory /artifacts/hcckg4sggwwogskw8soscgcw -f /artifacts/hcckg4sggwwogskw8soscgcw/docker-compose.yaml up --build -d'
2026-Jan-18 17:00:32.979050 Container zsg08co8ocgcgoo4o8okgccw-165738101001  Creating
2026-Jan-18 17:00:33.843461 zsg08co8ocgcgoo4o8okgccw-165738101001 Your kernel does not support memory swappiness capabilities or the cgroup is not mounted. Memory swappiness discarded.
2026-Jan-18 17:00:33.851975 Container zsg08co8ocgcgoo4o8okgccw-165738101001  Created
2026-Jan-18 17:00:33.871078 Container zsg08co8ocgcgoo4o8okgccw-165738101001  Starting
2026-Jan-18 17:00:34.076718 Container zsg08co8ocgcgoo4o8okgccw-165738101001  Started
2026-Jan-18 17:00:34.095178 New container started.
2026-Jan-18 17:00:34.104554 Custom healthcheck found in Dockerfile.
2026-Jan-18 17:00:34.121267 Waiting for healthcheck to pass on the new container.
2026-Jan-18 17:00:34.140134 Waiting for the start period (5 seconds) before starting healthcheck.
2026-Jan-18 17:00:39.582640 [CMD]: docker inspect --format='{{json .State.Health.Status}}' zsg08co8ocgcgoo4o8okgccw-165738101001
2026-Jan-18 17:00:39.582640 "starting"
2026-Jan-18 17:00:39.994347 [CMD]: docker inspect --format='{{json .State.Health.Log}}' zsg08co8ocgcgoo4o8okgccw-165738101001
2026-Jan-18 17:00:39.994347 []
2026-Jan-18 17:00:40.002650 Attempt 1 of 3 | Healthcheck status: "starting"
2026-Jan-18 17:01:10.404132 [CMD]: docker inspect --format='{{json .State.Health.Status}}' zsg08co8ocgcgoo4o8okgccw-165738101001
2026-Jan-18 17:01:10.404132 "unhealthy"
2026-Jan-18 17:01:10.776536 [CMD]: docker inspect --format='{{json .State.Health.Log}}' zsg08co8ocgcgoo4o8okgccw-165738101001
2026-Jan-18 17:01:10.776536 []
2026-Jan-18 17:01:10.783631 Attempt 2 of 3 | Healthcheck status: "unhealthy"
2026-Jan-18 17:01:10.792682 New container is unhealthy.
2026-Jan-18 17:01:10.799762 ----------------------------------------
2026-Jan-18 17:01:10.806810 Container logs:
2026-Jan-18 17:01:11.181710 [CMD]: docker logs -n 100 zsg08co8ocgcgoo4o8okgccw-165738101001
2026-Jan-18 17:01:11.181710 === SimulaVoto - Sistema Eleitoral Brasileiro ===
2026-Jan-18 17:01:11.181710 Environment: production
2026-Jan-18 17:01:11.181710 Port: 5000
2026-Jan-18 17:01:11.181710 NODE_OPTIONS: --dns-result-order=ipv4first
2026-Jan-18 17:01:11.181710 Database migrations should be run manually via init-db.sql
2026-Jan-18 17:01:11.181710 See DEPLOY.md for instructions
2026-Jan-18 17:01:11.181710 Starting application...
2026-Jan-18 17:01:11.181710 
2026-Jan-18 17:01:11.181710 > rest-express@1.0.0 start
2026-Jan-18 17:01:11.181710 > NODE_ENV=production node dist/index.cjs
2026-Jan-18 17:01:11.185740 Database pool initialized with IPv4 resolution
2026-Jan-18 17:01:11.191433 `);Lu.write(vO.format.apply(vO,e))}}Object.defineProperty(qn.exports,"isWin",{get:function(){return Nd},set:function(t){Nd=t}});qn.exports.warnTo=function(t){var e=Lu;return Lu=t,e};qn.exports.getFileName=function(t){var e=t||process.env,r=e.PGPASSFILE||(Nd?yO.join(e.APPDATA||"./","postgresql","pgpass.conf"):yO.join(e.HOME||"./",".pgpass"));return r};qn.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Nd?!0:(e=e||"<unkn>",dJ(t.mode)?t.mode&(cJ|uJ)?(sv('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(sv('WARNING: password file "%s" is not a plain file',e),!1))};var mJ=qn.exports.match=function(t,e){return vo.slice(0,-1).reduce(function(r,n,i){return i==1&&Number(t[n]||oJ)===Number(e[n])?r&&!0:r&&(e[n]==="*"||e[n]===t[n])},!0)};qn.exports.getPassword=function(t,e,r){var n,i=e.pipe(sJ());function a(u){var c=hJ(u);c&&gJ(c)&&mJ(t,c)&&(n=c[fJ],i.end())}var s=function(){e.destroy(),r(n)},o=function(u){e.destroy(),sv("WARNING: error on reading file: %s",u),r(void 0)};e.on("error",o),i.on("data",a).on("end",s).on("error",o)};var hJ=qn.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",r="",n=0,i=0,a=0,s={},o=!1,u=function(f,m,l){var p=t.substring(m,l);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(p=p.replace(/\\([:\\])/g,"$1")),s[vo[f]]=p},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),r=t.charAt(c),o=n==av-1,o){u(n,i);break}c>=0&&e==":"&&r!=="\\"&&(u(n,i,c+1),i=c+2,n+=1)}return s=Object.keys(s).length===av?s:null,s},gJ=qn.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},r=0;r<vo.length;r+=1){var n=e[r],i=t[vo[r]]||"",a=n(i);if(!a)return!1}return!0}});var wO=E((bne,ov)=>{"use strict";var vne=require("path"),xO=require("fs"),Od=bO();ov.exports=function(t,e){var r=Od.getFileName();xO.stat(r,function(n,i){if(n||!Od.usePgPass(i,r))return e(void 0);var a=xO.createReadStream(r);Od.getPassword(t,a,e)})};ov.exports.warnTo=Od.warnTo});var AO=E((xne,EO)=>{"use strict";var yJ=require("events").EventEmitter,_O=fo(),cv=UN(),vJ=Ad(),bJ=ky(),SO=tO(),xJ=Mu(),wJ=iv(),_J=Py(),jd=class extends yJ{constructor(e){super(),this.connectionParameters=new bJ(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let r=e||{};this._Promise=r.Promise||global.Promise,this._types=new vJ(r.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!r.enableChannelBinding,this.connection=r.connection||new wJ({stream:r.stream,ssl:this.connectionParameters.ssl,keepAlive:r.keepAlive||!1,keepAliveInitialDelayMillis:r.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=r.binary||xJ.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=r.connectionTimeoutMillis||0}_errorAllQueries(e){let r=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(r(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(r),this.queryQueue.length=0}_connect(e){let r=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let i=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(i)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){r.ssl?n.requestSsl():n.startup(r.getStartupConf())}),n.on("sslconnect",function(){n.startup(r.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let i=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(i),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(i):this._handleErrorEvent(i):this._connectionError||this._handleErrorEvent(i)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((r,n)=>{this._connect(i=>{i?n(i):r()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let r=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){r.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{r.emit("error",n)});else if(this.password!==null)e();else try{wO()(this.connectionParameters,i=>{i!==void 0&&(this.connectionParameters.password=this.password=i),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let r=await _J.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(r)}catch(r){this.emit("error",r)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=cv.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(r){this.connection.emit("error",r)}})}async _handleAuthSASLContinue(e){try{await cv.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(r){this.connection.emit("error",r)}}_handleAuthSASLFinal(e){try{cv.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(r){this.connection.emit("error",r)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:r}=this;this.activeQuery=null,this.readyForQuery=!0,r&&r.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let r=this.activeQuery;if(!r){this._handleErrorEvent(e);return}this.activeQuery=null,r.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let r=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(r);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,r={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(r.application_name=n),e.replication&&(r.replication=""+e.replication),e.statement_timeout&&(r.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(r.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(r.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(r.options=e.options),r}cancel(e,r){if(e.activeQuery===r){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(r)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(r),1)}setTypeParser(e,r,n){return this._types.setTypeParser(e,r,n)}getTypeParser(e,r){return this._types.getTypeParser(e,r)}escapeIdentifier(e){return _O.escapeIdentifier(e)}escapeLiteral(e){return _O.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,r,n){let i,a,s,o,u;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,a=i=e,typeof r=="function"&&(i.callback=i.callback||r)):(s=e.query_timeout||this.connectionParameters.query_timeout,i=new SO(e,r,n),i.callback||(a=new this._Promise((c,f)=>{i.callback=(m,l)=>m?f(m):c(l)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(u=i.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{i.handleError(c,this.connection)}),u(c),i.callback=()=>{};let f=this.queryQueue.indexOf(i);f>-1&&this.queryQueue.splice(f,1),this._pulseQueryQueue()},s),i.callback=(c,f)=>{clearTimeout(o),u(c,f)}),this.binary&&!i.binary&&(i.binary=!0),i._result&&!i._result._types&&(i._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"),this.connection)}),a):(this.queryQueue.push(i),this._pulseQueryQueue(),a):(process.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),a)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(r=>{this.connection.once("end",r)})}};jd.Query=SO;EO.exports=jd});var IO=E((wne,TO)=>{"use strict";var SJ=require("events").EventEmitter,CO=function(){},PO=(t,e)=>{let r=t.findIndex(e);return r===-1?void 0:t.splice(r,1)[0]},uv=class{constructor(e,r,n){this.client=e,this.idleListener=r,this.timeoutId=n}},bo=class{constructor(e){this.callback=e}};function EJ(){throw new Error("Release called on client which has already been released to the pool.")}function $d(t,e){if(e)return{callback:e,result:void 0};let r,n,i=function(s,o){s?r(s):n(o)},a=new t(function(s,o){n=s,r=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:i,result:a}}function AJ(t,e){return function r(n){n.client=e,e.removeListener("error",r),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var lv=class extends SJ{constructor(e,r){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||pv().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let r=this._idle.pop();clearTimeout(r.timeoutId);let n=r.client;n.ref&&n.ref();let i=r.idleListener;return this._acquireClient(n,e,i,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,r){let n=PO(this._idle,a=>a.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(a=>a!==e);let i=this;e.end(()=>{i.emit("remove",e),typeof r=="function"&&r()})}connect(e){if(this.ending){let i=new Error("Cannot use a pool after calling end on the pool");return e?e(i):this.Promise.reject(i)}let r=$d(this.Promise,e),n=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new bo(r.callback)),n;let i=(o,u,c)=>{clearTimeout(s),r.callback(o,u,c)},a=new bo(i),s=setTimeout(()=>{PO(this._pendingQueue,o=>o.callback===i),a.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(a),n}return this.newClient(new bo(r.callback)),n}newClient(e){let r=new this.Client(this.options);this._clients.push(r);let n=AJ(this,r);this.log("checking client timeout");let i,a=!1;this.options.connectionTimeoutMillis&&(i=setTimeout(()=>{this.log("ending client due to timeout"),a=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(s=>{if(i&&clearTimeout(i),r.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==r),a&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,CO);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(c=>c.client===r)!==-1&&this._acquireClient(r,new bo((c,f,m)=>m()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),r.once("end",()=>clearTimeout(o))}return this._acquireClient(r,e,n,!0)}})}_acquireClient(e,r,n,i){i&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),r.timedOut?i&&this.options.verify?this.options.verify(e,e.release):e.release():i&&this.options.verify?this.options.verify(e,a=>{if(a)return e.release(a),r.callback(a,void 0,CO);r.callback(void 0,e,e.release)}):r.callback(void 0,e,e.release)}_releaseOnce(e,r){let n=!1;return i=>{n&&EJ(),n=!0,this._release(e,r,i)}}_release(e,r,n){if(e.on("error",r),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let a;this.options.idleTimeoutMillis&&this._isAboveMin()&&(a=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&a.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new uv(e,r,a)),this._pulseQueue()}query(e,r,n){if(typeof e=="function"){let a=$d(this.Promise,e);return setImmediate(function(){return a.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),a.result}typeof r=="function"&&(n=r,r=void 0);let i=$d(this.Promise,n);return n=i.callback,this.connect((a,s)=>{if(a)return n(a);let o=!1,u=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",u),this.log("dispatching query");try{s.query(e,r,(c,f)=>{if(this.log("query dispatched"),s.removeListener("error",u),!o)return o=!0,s.release(c),c?n(c):n(void 0,f)})}catch(c){return s.release(c),n(c)}}),i.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let r=$d(this.Promise,e);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,r)=>e+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}};TO.exports=lv});var NO=E((_ne,RO)=>{"use strict";var kO=require("events").EventEmitter,CJ=require("util"),dv=fo(),xo=RO.exports=function(t,e,r){kO.call(this),t=dv.normalizeQueryConfig(t,e,r),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};CJ.inherits(xo,kO);var PJ={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};xo.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let r in e){let n=PJ[r]||r;t[n]=e[r]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};xo.prototype.then=function(t,e){return this._getPromise().then(t,e)};xo.prototype.catch=function(t){return this._getPromise().catch(t)};xo.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};xo.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let r=function(n,i,a){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(a.length>1?i.forEach((s,o)=>{s.forEach(u=>{e.emit("row",u,a[o])})}):i.forEach(function(s){e.emit("row",s,a)})),e.state="end",e.emit("end",a),e.callback&&e.callback(null,a)};if(process.domain&&(r=process.domain.bind(r)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(dv.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let i=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return r(i)}return t.native.execute(this.name,n,r)}return t.native.prepare(this.name,this.text,n.length,function(i){return i?r(i):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,r))})}else if(this.values){if(!Array.isArray(this.values)){let i=new Error("Query values must be an array");return r(i)}let n=this.values.map(dv.prepareValue);t.native.query(this.text,n,r)}else this.queryMode==="extended"?t.native.query(this.text,[],r):t.native.query(this.text,r)}});var DO=E((Sne,FO)=>{"use strict";var OO;try{OO=require("pg-native")}catch(t){throw t}var TJ=Ad(),jO=require("events").EventEmitter,IJ=require("util"),kJ=ky(),$O=NO(),_r=FO.exports=function(t){jO.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new TJ(t.types),this.native=new OO({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new kJ(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};_r.Query=$O;IJ.inherits(_r,jO);_r.prototype._errorAllQueries=function(t){let e=r=>{process.nextTick(()=>{r.native=this.native,r.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};_r.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(r,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),r)return t(r);e.native.connect(n,function(i){if(i)return e.native.end(),t(i);e._connected=!0,e.native.on("error",function(a){e._queryable=!1,e._errorAllQueries(a),e.emit("error",a)}),e.native.on("notification",function(a){e.emit("notification",{channel:a.relname,payload:a.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};_r.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,r)=>{this._connect(n=>{n?r(n):e()})})};_r.prototype.query=function(t,e,r){let n,i,a,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")a=t.query_timeout||this.connectionParameters.query_timeout,i=n=t,typeof e=="function"&&(t.callback=e);else if(a=t.query_timeout||this.connectionParameters.query_timeout,n=new $O(t,e,r),!n.callback){let u,c;i=new this._Promise((f,m)=>{u=f,c=m}).catch(f=>{throw Error.captureStackTrace(f),f}),n.callback=(f,m)=>f?c(f):u(m)}return a&&(o=n.callback,s=setTimeout(()=>{let u=new Error("Query read timeout");process.nextTick(()=>{n.handleError(u,this.connection)}),o(u),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},a),n.callback=(u,c)=>{clearTimeout(s),o(u,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),i):(this._queryQueue.push(n),this._pulseQueryQueue(),i):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),i)};_r.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let r;return t||(r=new this._Promise(function(n,i){t=a=>a?i(a):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),r};_r.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};_r.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let r=this;e.once("_done",function(){r._pulseQueryQueue()})};_r.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};_r.prototype.ref=function(){};_r.prototype.unref=function(){};_r.prototype.setTypeParser=function(t,e,r){return this._types.setTypeParser(t,e,r)};_r.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var fv=E((Ene,MO)=>{"use strict";MO.exports=DO()});var pv=E((Cne,Bu)=>{"use strict";var RJ=AO(),NJ=Mu(),OJ=iv(),jJ=Ny(),$J=fo(),FJ=IO(),DJ=Ad(),{DatabaseError:MJ}=tv(),{escapeIdentifier:qJ,escapeLiteral:LJ}=fo(),BJ=t=>class extends FJ{constructor(r){super(r,t)}},mv=function(t){this.defaults=NJ,this.Client=t,this.Query=this.Client.Query,this.Pool=BJ(this.Client),this._pools=[],this.Connection=OJ,this.types=Du(),this.DatabaseError=MJ,this.TypeOverrides=DJ,this.escapeIdentifier=qJ,this.escapeLiteral=LJ,this.Result=jJ,this.utils=$J};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Bu.exports=new mv(fv()):(Bu.exports=new mv(RJ),Object.defineProperty(Bu.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new mv(fv())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Bu.exports,"native",{value:t}),t}}))});var kr,Pne,Tne,Ine,kne,Rne,Nne,One,jne,$ne,Fne,Dne,Ci,Fd=S(()=>{kr=er(pv(),1),Pne=kr.default.Client,Tne=kr.default.Pool,Ine=kr.default.Connection,kne=kr.default.types,Rne=kr.default.Query,Nne=kr.default.DatabaseError,One=kr.default.escapeIdentifier,jne=kr.default.escapeLiteral,$ne=kr.default.Result,Fne=kr.default.TypeOverrides,Dne=kr.default.defaults,Ci=kr.default});function F(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,_))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(_ in r&&r[_]===e[_])return!0;r=Object.getPrototypeOf(r)}return!1}var _,qne,H=S(()=>{_=Symbol.for("drizzle:entityKind"),qne=Symbol.for("drizzle:hasOwnEntityKind")});var hv,Dd,Md,qd=S(()=>{H();hv=class{static[_]="ConsoleLogWriter";write(e){console.log(e)}},Dd=class{static[_]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new hv}logQuery(e,r){let n=r.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),i=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${i}`)}},Md=class{static[_]="NoopLogger";logQuery(){}}});var nr,Ln=S(()=>{H();nr=class{static[_]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}then(e,r){return this.execute().then(e,r)}}});var De,yn=S(()=>{H();De=class{constructor(e,r){this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}static[_]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}});var Ld,gv=S(()=>{H();Ld=class{static[_]="ColumnBuilder";config;constructor(e,r,n){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}});var tn,Bd=S(()=>{tn=Symbol.for("drizzle:Name")});var Ud,yv,vv=S(()=>{H();Bd();Ud=class{static[_]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,r){this.reference=()=>{let{name:n,columns:i,foreignColumns:a}=e();return{name:n,columns:i,foreignTable:a[0].table,foreignColumns:a}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new yv(e,this)}},yv=class{constructor(e,r){this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}static[_]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:r,foreignColumns:n}=this.reference(),i=r.map(o=>o.name),a=n.map(o=>o.name),s=[this.table[tn],...i,n[0].table[tn],...a];return e??`${s.join("_")}_fk`}}});function Vd(t,...e){return t(...e)}var bv=S(()=>{});function _v(t,e){return`${t[tn]}_${e.join("_")}_unique`}var xv,qO,wv,Sv=S(()=>{H();Bd();xv=class{constructor(e,r){this.name=r,this.columns=e}static[_]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new wv(e,this.columns,this.nullsNotDistinctConfig,this.name)}},qO=class{static[_]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new xv(e,this.name)}},wv=class{constructor(e,r,n,i){this.table=e,this.columns=r,this.name=i??_v(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=n}static[_]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}});function LO(t,e,r){for(let n=e;n<t.length;n++){let i=t[n];if(i==="\\"){n++;continue}if(i==='"')return[t.slice(e,n).replace(/\\/g,""),n+1];if(!r&&(i===","||i==="}"))return[t.slice(e,n).replace(/\\/g,""),n]}return[t.slice(e).replace(/\\/g,""),t.length]}function BO(t,e=0){let r=[],n=e,i=!1;for(;n<t.length;){let a=t[n];if(a===","){(i||n===e)&&r.push(""),i=!0,n++;continue}if(i=!1,a==="\\"){n+=2;continue}if(a==='"'){let[u,c]=LO(t,n+1,!0);r.push(u),n=c;continue}if(a==="}")return[r,n+1];if(a==="{"){let[u,c]=BO(t,n+1);r.push(u),n=c;continue}let[s,o]=LO(t,n,!1);r.push(s),n=o}return[r,n]}function UO(t){let[e]=BO(t,1);return e}function Ev(t){return`{${t.map(e=>Array.isArray(e)?Ev(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Av=S(()=>{});var re,z,Cv,wo,Pv,Tv,Pe=S(()=>{gv();yn();H();vv();bv();Sv();Av();re=class extends Ld{foreignKeyConfigs=[];static[_]="PgColumnBuilder";array(e){return new Pv(this.config.name,this,e)}references(e,r={}){return this.foreignKeyConfigs.push({ref:e,actions:r}),this}unique(e,r){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=r?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,r){return this.foreignKeyConfigs.map(({ref:n,actions:i})=>Vd((a,s)=>{let o=new Ud(()=>{let u=a();return{columns:[e],foreignColumns:[u]}});return s.onUpdate&&o.onUpdate(s.onUpdate),s.onDelete&&o.onDelete(s.onDelete),o.build(r)},n,i))}buildExtraConfigColumn(e){return new Cv(e,this.config)}},z=class extends De{constructor(e,r){r.uniqueName||(r.uniqueName=_v(e,[r.name])),super(e,r),this.table=e}static[_]="PgColumn"},Cv=class extends z{static[_]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},wo=class{static[_]="IndexedColumn";constructor(e,r,n,i){this.name=e,this.keyAsName=r,this.type=n,this.indexConfig=i}name;keyAsName;type;indexConfig},Pv=class extends re{static[_]="PgArrayBuilder";constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){let r=this.config.baseBuilder.build(e);return new Tv(e,this.config,r)}},Tv=class t extends z{constructor(e,r,n,i){super(e,r),this.baseColumn=n,this.range=i,this.size=r.size}size;static[_]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=UO(e)),e.map(r=>this.baseColumn.mapFromDriverValue(r))}mapToDriverValue(e,r=!1){let n=e.map(i=>i===null?null:F(this.baseColumn,t)?this.baseColumn.mapToDriverValue(i,!0):this.baseColumn.mapToDriverValue(i));return r?n:Ev(n)}}});function VO(t){return!!t&&typeof t=="function"&&Iv in t&&t[Iv]===!0}function zO(t,e,r){let n=Object.assign(i=>new kv(i??"",n),{enumName:t,enumValues:e,schema:r,[Iv]:!0});return n}var Iv,kv,Rv,zd=S(()=>{H();Pe();Iv=Symbol.for("drizzle:isPgEnum");kv=class extends re{static[_]="PgEnumColumnBuilder";constructor(e,r){super(e,"string","PgEnumColumn"),this.config.enum=r}build(e){return new Rv(e,this.config)}},Rv=class extends z{static[_]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,r){super(e,r),this.enum=r.enum}getSQLType(){return this.enum.enumName}}});var Tt,_o,vn=S(()=>{H();Tt=class{static[_]="Subquery";constructor(e,r,n,i=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:i}}},_o=class extends Tt{static[_]="WithSubquery"}});var HO,QO=S(()=>{HO="0.39.3"});var Nv,Ov,tt,Bn=S(()=>{bv();QO();tt={startActiveSpan(t,e){return Nv?(Ov||(Ov=Nv.trace.getTracer("drizzle-orm",HO)),Vd((r,n)=>n.startActiveSpan(t,i=>{try{return e(i)}catch(a){throw i.setStatus({code:r.SpanStatusCode.ERROR,message:a instanceof Error?a.message:"Unknown error"}),a}finally{i.end()}}),Nv,Ov)):e()}}});var rt,Un=S(()=>{rt=Symbol.for("drizzle:ViewBaseConfig")});function Fv(t){return typeof t=="object"&&t!==null&&GO in t}function Sr(t){return t[tn]}function Da(t){return`${t[Hd]??"public"}.${t[tn]}`}var Hd,Qd,WO,jv,$v,Uu,KO,GO,K,Er=S(()=>{H();Bd();Hd=Symbol.for("drizzle:Schema"),Qd=Symbol.for("drizzle:Columns"),WO=Symbol.for("drizzle:ExtraConfigColumns"),jv=Symbol.for("drizzle:OriginalName"),$v=Symbol.for("drizzle:BaseName"),Uu=Symbol.for("drizzle:IsAlias"),KO=Symbol.for("drizzle:ExtraConfigBuilder"),GO=Symbol.for("drizzle:IsDrizzleTable"),K=class{static[_]="Table";static Symbol={Name:tn,Schema:Hd,OriginalName:jv,Columns:Qd,ExtraConfigColumns:WO,BaseName:$v,IsAlias:Uu,ExtraConfigBuilder:KO};[tn];[jv];[Hd];[Qd];[WO];[$v];[Uu]=!1;[GO]=!0;[KO]=void 0;constructor(e,r,n){this[tn]=this[jv]=e,this[Hd]=r,this[$v]=n}}});function Dv(t){return t!=null&&typeof t.getSQL=="function"}function UJ(t){let e={sql:"",params:[]};for(let r of t)e.sql+=r.sql,e.params.push(...r.params),r.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...r.typings));return e}function YO(t){return typeof t=="object"&&t!==null&&"mapToDriverValue"in t&&typeof t.mapToDriverValue=="function"}function y(t,...e){let r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new It(t[0]));for(let[n,i]of e.entries())r.push(i,new It(t[n+1]));return new G(r)}function Mv(t,e){return t.map(r=>{if(F(r,Vn)){if(!(r.name in e))throw new Error(`No value for placeholder "${r.name}" was provided`);return e[r.name]}if(F(r,Ar)&&F(r.value,Vn)){if(!(r.value.name in e))throw new Error(`No value for placeholder "${r.value.name}" was provided`);return r.encoder.mapToDriverValue(e[r.value.name])}return r})}function tj(t){return typeof t=="object"&&t!==null&&ej in t}var JO,It,G,Vu,XO,ZO,Nie,Ar,Vn,ej,mr,kt=S(()=>{H();zd();vn();Bn();Un();yn();Er();JO=class{static[_]="FakePrimitiveParam"};It=class{static[_]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new G([this])}},G=class t{constructor(e){this.queryChunks=e}static[_]="SQL";decoder=XO;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return tt.startActiveSpan("drizzle.buildSQL",r=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return r?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){let n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:i,escapeName:a,escapeParam:s,prepareTyping:o,inlineParams:u,paramStartIndex:c}=n;return UJ(e.map(f=>{if(F(f,It))return{sql:f.value.join(""),params:[]};if(F(f,Vu))return{sql:a(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let m=[new It("(")];for(let[l,p]of f.entries())m.push(p),l<f.length-1&&m.push(new It(", "));return m.push(new It(")")),this.buildQueryFromSourceParams(m,n)}if(F(f,t))return this.buildQueryFromSourceParams(f.queryChunks,{...n,inlineParams:u||f.shouldInlineParams});if(F(f,K)){let m=f[K.Symbol.Schema],l=f[K.Symbol.Name];return{sql:m===void 0||f[Uu]?a(l):a(m)+"."+a(l),params:[]}}if(F(f,De)){let m=i.getColumnCasing(f);if(r.invokeSource==="indexes")return{sql:a(m),params:[]};let l=f.table[K.Symbol.Schema];return{sql:f.table[Uu]||l===void 0?a(f.table[K.Symbol.Name])+"."+a(m):a(l)+"."+a(f.table[K.Symbol.Name])+"."+a(m),params:[]}}if(F(f,mr)){let m=f[rt].schema,l=f[rt].name;return{sql:m===void 0||f[rt].isAlias?a(l):a(m)+"."+a(l),params:[]}}if(F(f,Ar)){if(F(f.value,Vn))return{sql:s(c.value++,f),params:[f],typings:["none"]};let m=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(F(m,t))return this.buildQueryFromSourceParams([m],n);if(u)return{sql:this.mapInlineParam(m,n),params:[]};let l=["none"];return o&&(l=[o(f.encoder)]),{sql:s(c.value++,m),params:[m],typings:l}}return F(f,Vn)?{sql:s(c.value++,f),params:[f],typings:["none"]}:F(f,t.Aliased)&&f.fieldAlias!==void 0?{sql:a(f.fieldAlias),params:[]}:F(f,Tt)?f._.isWith?{sql:a(f._.alias),params:[]}:this.buildQueryFromSourceParams([new It("("),f._.sql,new It(") "),new Vu(f._.alias)],n):VO(f)?f.schema?{sql:a(f.schema)+"."+a(f.enumName),params:[]}:{sql:a(f.enumName),params:[]}:Dv(f)?f.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([f.getSQL()],n):this.buildQueryFromSourceParams([new It("("),f.getSQL(),new It(")")],n):u?{sql:this.mapInlineParam(f,n),params:[]}:{sql:s(c.value++,f),params:[f],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){let n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new t.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Vu=class{constructor(e){this.value=e}static[_]="Name";brand;getSQL(){return new G([this])}};XO={mapFromDriverValue:t=>t},ZO={mapToDriverValue:t=>t},Nie={...XO,...ZO},Ar=class{constructor(e,r=ZO){this.value=e,this.encoder=r}static[_]="Param";brand;getSQL(){return new G([this])}};(t=>{function e(){return new G([])}t.empty=e;function r(u){return new G(u)}t.fromList=r;function n(u){return new G([new It(u)])}t.raw=n;function i(u,c){let f=[];for(let[m,l]of u.entries())m>0&&c!==void 0&&f.push(c),f.push(l);return new G(f)}t.join=i;function a(u){return new Vu(u)}t.identifier=a;function s(u){return new Vn(u)}t.placeholder=s;function o(u,c){return new Ar(u,c)}t.param=o})(y||(y={}));(t=>{class e{constructor(n,i){this.sql=n,this.fieldAlias=i}static[_]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}t.Aliased=e})(G||(G={}));Vn=class{constructor(e){this.name=e}static[_]="Placeholder";getSQL(){return new G([this])}};ej=Symbol.for("drizzle:IsDrizzleView"),mr=class{static[_]="View";[rt];[ej]=!0;constructor({name:e,schema:r,selectedFields:n,query:i}){this[rt]={name:e,originalName:e,schema:r,selectedFields:n,query:i,isExisting:!i,isAlias:!1}}getSQL(){return new G([this])}};De.prototype.getSQL=function(){return new G([this])};K.prototype.getSQL=function(){return new G([this])};Tt.prototype.getSQL=function(){return new G([this])}});function zu(t,e){return new Proxy(t,new So(e,!1))}function bn(t,e){return new Proxy(t,new Ma(new Proxy(t.table,new So(e,!1))))}function qv(t,e){return new G.Aliased(Hu(t.sql,e),t.fieldAlias)}function Hu(t,e){return y.join(t.queryChunks.map(r=>F(r,De)?bn(r,e):F(r,G)?Hu(r,e):F(r,G.Aliased)?qv(r,e):r))}var Ma,So,rj,Wd=S(()=>{yn();H();kt();Er();Un();Ma=class{constructor(e){this.table=e}static[_]="ColumnAliasProxyHandler";get(e,r){return r==="table"?this.table:e[r]}},So=class{constructor(e,r){this.alias=e,this.replaceOriginalName=r}static[_]="TableAliasProxyHandler";get(e,r){if(r===K.Symbol.IsAlias)return!0;if(r===K.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===K.Symbol.OriginalName)return this.alias;if(r===rt)return{...e[rt],name:this.alias,isAlias:!0};if(r===K.Symbol.Columns){let i=e[K.Symbol.Columns];if(!i)return i;let a={};return Object.keys(i).map(s=>{a[s]=new Proxy(i[s],new Ma(new Proxy(e,this)))}),a}let n=e[r];return F(n,De)?new Proxy(n,new Ma(new Proxy(e,this))):n}},rj=class{constructor(e){this.alias=e}static[_]="RelationTableAliasProxyHandler";get(e,r){return r==="sourceTable"?zu(e.sourceTable,this.alias):e[r]}}});var Ge,Pi=S(()=>{Wd();yn();H();kt();vn();Un();Ge=class t{static[_]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,r){if(r==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(r===rt)return{...e[rt],selectedFields:new Proxy(e[rt].selectedFields,this)};if(typeof r=="symbol")return e[r];let i=(F(e,Tt)?e._.selectedFields:F(e,mr)?e[rt].selectedFields:e)[r];if(F(i,G.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!i.isSelectionField)return i.sql;let a=i.clone();return a.isSelectionField=!0,a}if(F(i,G)){if(this.config.sqlBehavior==="sql")return i;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return F(i,De)?this.config.alias?new Proxy(i,new Ma(new Proxy(i.table,new So(this.config.alias,this.config.replaceOriginalName??!1)))):i:typeof i!="object"||i===null?i:new Proxy(i,new t(this.config))}}});function nj(t,e,r){let n={},i=t.reduce((a,{path:s,field:o},u)=>{let c;F(o,De)?c=o:F(o,G)?c=o.decoder:c=o.sql.decoder;let f=a;for(let[m,l]of s.entries())if(m<s.length-1)l in f||(f[l]={}),f=f[l];else{let p=e[u],d=f[l]=p===null?null:c.mapFromDriverValue(p);if(r&&F(o,De)&&s.length===2){let h=s[0];h in n?typeof n[h]=="string"&&n[h]!==Sr(o.table)&&(n[h]=!1):n[h]=d===null?Sr(o.table):!1}}return a},{});if(r&&Object.keys(n).length>0)for(let[a,s]of Object.entries(n))typeof s=="string"&&!r[s]&&(i[a]=null);return i}function Qr(t,e){return Object.entries(t).reduce((r,[n,i])=>{if(typeof n!="string")return r;let a=e?[...e,n]:[n];return F(i,De)||F(i,G)||F(i,G.Aliased)?r.push({path:a,field:i}):F(i,K)?r.push(...Qr(i[K.Symbol.Columns],a)):r.push(...Qr(i,a)),r},[])}function Qu(t,e){let r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let[i,a]of r.entries())if(a!==n[i])return!1;return!0}function Kd(t,e){let r=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,i])=>F(i,G)||F(i,De)?[n,i]:[n,new Ar(i,t[K.Symbol.Columns][n])]);if(r.length===0)throw new Error("No values to set");return Object.fromEntries(r)}function ij(t,e){for(let r of e)for(let n of Object.getOwnPropertyNames(r.prototype))n!=="constructor"&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(r.prototype,n)||Object.create(null))}function qa(t){return t[K.Symbol.Columns]}function aj(t){return t[rt].selectedFields}function zn(t){return F(t,Tt)?t._.alias:F(t,mr)?t[rt].name:F(t,G)?void 0:t[K.Symbol.IsAlias]?t[K.Symbol.Name]:t[K.Symbol.BaseName]}function ke(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}function sj(t){if(typeof t!="object"||t===null||t.constructor.name!=="Object")return!1;if("logger"in t){let e=typeof t.logger;return!(e!=="boolean"&&(e!=="object"||typeof t.logger.logQuery!="function")&&e!=="undefined")}if("schema"in t){let e=typeof t.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in t){let e=typeof t.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in t)return!(t.mode!=="default"||t.mode!=="planetscale"||t.mode!==void 0);if("connection"in t){let e=typeof t.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in t){let e=typeof t.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(t).length===0}var Je=S(()=>{yn();H();kt();vn();Er();Un()});var Wu,oj=S(()=>{H();Ln();Pi();Er();Bn();Je();Wu=class extends nr{constructor(e,r,n,i){super(),this.session=r,this.dialect=n,this.config={table:e,withList:i}}static[_]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[K.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Qr(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return tt.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>tt.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Ge({alias:Sr(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}});function VJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(r=>r.toLowerCase()).join("_")}function zJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((r,n,i)=>{let a=i===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return r+a},"")}function HJ(t){return t}var Gd,cj=S(()=>{H();Er();Gd=class{static[_]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?VJ:e==="camelCase"?zJ:HJ}getColumnCasing(e){if(!e.keyAsName)return e.name;let r=e.table[K.Symbol.Schema]??"public",n=e.table[K.Symbol.OriginalName],i=`${r}.${n}.${e.name}`;return this.cache[i]||this.cacheTable(e.table),this.cache[i]}cacheTable(e){let r=e[K.Symbol.Schema]??"public",n=e[K.Symbol.OriginalName],i=`${r}.${n}`;if(!this.cachedTables[i]){for(let a of Object.values(e[K.Symbol.Columns])){let s=`${i}.${a.name}`;this.cache[s]=this.convert(a.name)}this.cachedTables[i]=!0}}clearCache(){this.cache={},this.cachedTables={}}}});var Ku,Jd,Yd=S(()=>{H();Ku=class extends Error{static[_]="DrizzleError";constructor({message:e,cause:r}){super(e),this.name="DrizzleError",this.cause=r}},Jd=class extends Ku{static[_]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}});var Hn,Gu=S(()=>{H();Pe();Hn=class extends re{static[_]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}});function Ju(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Lv(r):new Uv(r)}var Lv,Bv,Uv,Vv,zv=S(()=>{H();Je();Pe();Gu();Lv=class extends Hn{static[_]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Bv(e,this.config)}},Bv=class extends z{static[_]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Uv=class extends Hn{static[_]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Vv(e,this.config)}},Vv=class extends z{static[_]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}});function uj(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Hv(r):new Wv(r)}var Hv,Qv,Wv,Kv,Gv=S(()=>{H();Je();Pe();Hv=class extends re{static[_]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Qv(e,this.config)}},Qv=class extends z{static[_]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Wv=class extends re{static[_]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Kv(e,this.config)}},Kv=class extends z{static[_]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}});function Ti(t){return new Jv(t??"")}var Jv,Yv,Xv=S(()=>{H();Pe();Jv=class extends re{static[_]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Yv(e,this.config)}},Yv=class extends z{static[_]="PgBoolean";getSQLType(){return"boolean"}}});function lj(t,e={}){let{name:r,config:n}=ke(t,e);return new Zv(r,n)}var Zv,eb,tb=S(()=>{H();Je();Pe();Zv=class extends re{static[_]="PgCharBuilder";constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new eb(e,this.config)}},eb=class extends z{static[_]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}});function pj(t){return new rb(t??"")}var rb,nb,ib=S(()=>{H();Pe();rb=class extends re{static[_]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new nb(e,this.config)}},nb=class extends z{static[_]="PgCidr";getSQLType(){return"cidr"}}});function dj(t){return(e,r)=>{let{name:n,config:i}=ke(e,r);return new ab(n,i,t)}}var ab,sb,ob=S(()=>{H();Je();Pe();ab=class extends re{static[_]="PgCustomColumnBuilder";constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new sb(e,this.config)}},sb=class extends z{static[_]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,r){super(e,r),this.sqlName=r.customTypeParams.dataType(r.fieldConfig),this.mapTo=r.customTypeParams.toDriver,this.mapFrom=r.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}});var xn,Xd=S(()=>{H();kt();Pe();xn=class extends re{static[_]="PgDateColumnBaseBuilder";defaultNow(){return this.default(y`now()`)}}});function fj(t,e){let{name:r,config:n}=ke(t,e);return n?.mode==="date"?new cb(r):new ub(r)}var cb,Yu,ub,Xu,lb=S(()=>{H();Je();Pe();Xd();cb=class extends xn{static[_]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Yu(e,this.config)}},Yu=class extends z{static[_]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},ub=class extends xn{static[_]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Xu(e,this.config)}},Xu=class extends z{static[_]="PgDateString";getSQLType(){return"date"}}});function mj(t){return new pb(t??"")}var pb,db,fb=S(()=>{H();Pe();pb=class extends re{static[_]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new db(e,this.config)}},db=class extends z{static[_]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}});function hj(t){return new mb(t??"")}var mb,hb,gb=S(()=>{H();Pe();mb=class extends re{static[_]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new hb(e,this.config)}},hb=class extends z{static[_]="PgInet";getSQLType(){return"inet"}}});function Z(t){return new yb(t??"")}var yb,vb,bb=S(()=>{H();Pe();Gu();yb=class extends Hn{static[_]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new vb(e,this.config)}},vb=class extends z{static[_]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}});function gj(t,e={}){let{name:r,config:n}=ke(t,e);return new xb(r,n)}var xb,wb,_b=S(()=>{H();Je();Pe();xb=class extends re{static[_]="PgIntervalBuilder";constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new wb(e,this.config)}},wb=class extends z{static[_]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",r=this.precision?`(${this.precision})`:"";return`interval${e}${r}`}}});function yj(t){return new Sb(t??"")}var Sb,Zu,Eb=S(()=>{H();Pe();Sb=class extends re{static[_]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Zu(e,this.config)}},Zu=class extends z{static[_]="PgJson";constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function Qe(t){return new Ab(t??"")}var Ab,el,Cb=S(()=>{H();Pe();Ab=class extends re{static[_]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new el(e,this.config)}},el=class extends z{static[_]="PgJsonb";constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function vj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Pb(r):new Ib(r)}var Pb,Tb,Ib,kb,Rb=S(()=>{H();Je();Pe();Pb=class extends re{static[_]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Tb(e,this.config)}},Tb=class extends z{static[_]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(i)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Ib=class extends re{static[_]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new kb(e,this.config)}},kb=class extends z{static[_]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(i)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}});function bj(t){return new Nb(t??"")}var Nb,Ob,jb=S(()=>{H();Pe();Nb=class extends re{static[_]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new Ob(e,this.config)}},Ob=class extends z{static[_]="PgMacaddr";getSQLType(){return"macaddr"}}});function xj(t){return new $b(t??"")}var $b,Fb,Db=S(()=>{H();Pe();$b=class extends re{static[_]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Fb(e,this.config)}},Fb=class extends z{static[_]="PgMacaddr8";getSQLType(){return"macaddr8"}}});function qb(t,e){let{name:r,config:n}=ke(t,e);return new Mb(r,n?.precision,n?.scale)}var Mb,tl,Kt,Lb=S(()=>{H();Je();Pe();Mb=class extends re{static[_]="PgNumericBuilder";constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new tl(e,this.config)}},tl=class extends z{static[_]="PgNumeric";precision;scale;constructor(e,r){super(e,r),this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Kt=qb});function wj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Bb(r):new Vb(r)}var Bb,Ub,Vb,zb,Hb=S(()=>{H();Je();Pe();Bb=class extends re{static[_]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Ub(e,this.config)}},Ub=class extends z{static[_]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Vb=class extends re{static[_]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new zb(e,this.config)}},zb=class extends z{static[_]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}});function QJ(t){let e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function _j(t,e){let r=new ArrayBuffer(8),n=new DataView(r);for(let i=0;i<8;i++)n.setUint8(i,t[e+i]);return n.getFloat64(0,!0)}function Qb(t){let e=QJ(t),r=0,n=e[r];r+=1;let i=new DataView(e.buffer),a=i.getUint32(r,n===1);r+=4;let s;if(a&536870912&&(s=i.getUint32(r,n===1),r+=4),(a&65535)===1){let o=_j(e,r);r+=8;let u=_j(e,r);return r+=8,[o,u]}throw new Error("Unsupported geometry type")}var Sj=S(()=>{});function Ej(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Wb(r):new Gb(r)}var Wb,Kb,Gb,Jb,Yb=S(()=>{H();Je();Pe();Sj();Wb=class extends re{static[_]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new Kb(e,this.config)}},Kb=class extends z{static[_]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Qb(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},Gb=class extends re{static[_]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new Jb(e,this.config)}},Jb=class extends z{static[_]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let r=Qb(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}});function Aj(t){return new Xb(t??"")}var Xb,Zb,ex=S(()=>{H();Pe();Xb=class extends re{static[_]="PgRealBuilder";constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new Zb(e,this.config)}},Zb=class extends z{static[_]="PgReal";constructor(e,r){super(e,r)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}});function Ye(t){return new tx(t??"")}var tx,rx,nx=S(()=>{H();Pe();tx=class extends re{static[_]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new rx(e,this.config)}},rx=class extends z{static[_]="PgSerial";getSQLType(){return"serial"}}});function Cj(t){return new ix(t??"")}var ix,ax,sx=S(()=>{H();Pe();Gu();ix=class extends Hn{static[_]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new ax(e,this.config)}},ax=class extends z{static[_]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}});function Pj(t){return new ox(t??"")}var ox,cx,ux=S(()=>{H();Pe();ox=class extends re{static[_]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new cx(e,this.config)}},cx=class extends z{static[_]="PgSmallSerial";getSQLType(){return"smallserial"}}});function $(t,e={}){let{name:r,config:n}=ke(t,e);return new lx(r,n)}var lx,px,dx=S(()=>{H();Je();Pe();lx=class extends re{static[_]="PgTextBuilder";constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new px(e,this.config)}},px=class extends z{static[_]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}});function Tj(t,e={}){let{name:r,config:n}=ke(t,e);return new fx(r,n.withTimezone??!1,n.precision)}var fx,rl,mx=S(()=>{H();Je();Pe();Xd();fx=class extends xn{constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}static[_]="PgTimeBuilder";build(e){return new rl(e,this.config)}},rl=class extends z{static[_]="PgTime";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function we(t,e={}){let{name:r,config:n}=ke(t,e);return n?.mode==="string"?new gx(r,n.withTimezone??!1,n.precision):new hx(r,n?.withTimezone??!1,n?.precision)}var hx,nl,gx,il,yx=S(()=>{H();Je();Pe();Xd();hx=class extends xn{static[_]="PgTimestampBuilder";constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new nl(e,this.config)}},nl=class extends z{static[_]="PgTimestamp";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},gx=class extends xn{static[_]="PgTimestampStringBuilder";constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new il(e,this.config)}},il=class extends z{static[_]="PgTimestampString";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function Ij(t){return new vx(t??"")}var vx,al,bx=S(()=>{H();kt();Pe();vx=class extends re{static[_]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(y`gen_random_uuid()`)}build(e){return new al(e,this.config)}},al=class extends z{static[_]="PgUUID";getSQLType(){return"uuid"}}});function Gt(t,e={}){let{name:r,config:n}=ke(t,e);return new xx(r,n)}var xx,wx,_x=S(()=>{H();Je();Pe();xx=class extends re{static[_]="PgVarcharBuilder";constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new wx(e,this.config)}},wx=class extends z{static[_]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}});function kj(t,e){let{name:r,config:n}=ke(t,e);return new Sx(r,n)}var Sx,Ex,Ax=S(()=>{H();Je();Pe();Sx=class extends re{static[_]="PgBinaryVectorBuilder";constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new Ex(e,this.config)}},Ex=class extends z{static[_]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}});function Rj(t,e){let{name:r,config:n}=ke(t,e);return new Cx(r,n)}var Cx,Px,Tx=S(()=>{H();Je();Pe();Cx=class extends re{static[_]="PgHalfVectorBuilder";constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){returIPv4 resolution failed,
2026-Jan-18 17:01:11.197475 === SimulaVoto - Sistema Eleitoral Brasileiro ===
2026-Jan-18 17:01:11.197475 Environment: production
2026-Jan-18 17:01:11.197475 Port: 5000
2026-Jan-18 17:01:11.197475 NODE_OPTIONS: --dns-result-order=ipv4first
2026-Jan-18 17:01:11.197475 Database migrations should be run manually via init-db.sql
2026-Jan-18 17:01:11.197475 See DEPLOY.md for instructions
2026-Jan-18 17:01:11.197475 Starting application...
2026-Jan-18 17:01:11.197475 
2026-Jan-18 17:01:11.197475 > rest-express@1.0.0 start
2026-Jan-18 17:01:11.197475 > NODE_ENV=production node dist/index.cjs
2026-Jan-18 17:01:11.197475 
2026-Jan-18 17:01:11.197475 Database pool initialized with IPv4 resolution
2026-Jan-18 17:01:11.197475 === SimulaVoto - Sistema Eleitoral Brasileiro ===
2026-Jan-18 17:01:11.197475 Environment: production
2026-Jan-18 17:01:11.197475 Port: 5000
2026-Jan-18 17:01:11.197475 NODE_OPTIONS: --dns-result-order=ipv4first
2026-Jan-18 17:01:11.197475 Database migrations should be run manually via init-db.sql
2026-Jan-18 17:01:11.197475 See DEPLOY.md for instructions
2026-Jan-18 17:01:11.197475 Starting application...
2026-Jan-18 17:01:11.197475 
2026-Jan-18 17:01:11.197475 > rest-express@1.0.0 start
2026-Jan-18 17:01:11.197475 > NODE_ENV=production node dist/index.cjs
2026-Jan-18 17:01:11.197475 
2026-Jan-18 17:01:11.197475 Database pool initialized with IPv4 resolution
2026-Jan-18 17:01:11.197475 === SimulaVoto - Sistema Eleitoral Brasileiro ===
2026-Jan-18 17:01:11.197475 Environment: production
2026-Jan-18 17:01:11.197475 Port: 5000
2026-Jan-18 17:01:11.197475 NODE_OPTIONS: --dns-result-order=ipv4first
2026-Jan-18 17:01:11.197475 Database migrations should be run manually via init-db.sql
2026-Jan-18 17:01:11.197475 See DEPLOY.md for instructions
2026-Jan-18 17:01:11.197475 Starting application...
2026-Jan-18 17:01:11.197475 
2026-Jan-18 17:01:11.197475 > rest-express@1.0.0 start
2026-Jan-18 17:01:11.197475 > NODE_ENV=production node dist/index.cjs
2026-Jan-18 17:01:11.197475 
2026-Jan-18 17:01:11.197475 Database pool initialized with IPv4 resolution
2026-Jan-18 17:01:11.213393 using original URL: Error: getaddrinfo ENOTFOUND db.epbxctcwmtsuxdgxkgdz.supabase.co
2026-Jan-18 17:01:11.213393 at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:111:26) {
2026-Jan-18 17:01:11.213393 errno: -3007,
2026-Jan-18 17:01:11.213393 code: 'ENOTFOUND',
2026-Jan-18 17:01:11.213393 syscall: 'getaddrinfo',
2026-Jan-18 17:01:11.213393 hostname: 'db.epbxctcwmtsuxdgxkgdz.supabase.co'
2026-Jan-18 17:01:11.213393 }
2026-Jan-18 17:01:11.213393 /app/dist/index.cjs:67
2026-Jan-18 17:01:11.213393 `);Lu.write(vO.format.apply(vO,e))}}Object.defineProperty(qn.exports,"isWin",{get:function(){return Nd},set:function(t){Nd=t}});qn.exports.warnTo=function(t){var e=Lu;return Lu=t,e};qn.exports.getFileName=function(t){var e=t||process.env,r=e.PGPASSFILE||(Nd?yO.join(e.APPDATA||"./","postgresql","pgpass.conf"):yO.join(e.HOME||"./",".pgpass"));return r};qn.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Nd?!0:(e=e||"<unkn>",dJ(t.mode)?t.mode&(cJ|uJ)?(sv('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(sv('WARNING: password file "%s" is not a plain file',e),!1))};var mJ=qn.exports.match=function(t,e){return vo.slice(0,-1).reduce(function(r,n,i){return i==1&&Number(t[n]||oJ)===Number(e[n])?r&&!0:r&&(e[n]==="*"||e[n]===t[n])},!0)};qn.exports.getPassword=function(t,e,r){var n,i=e.pipe(sJ());function a(u){var c=hJ(u);c&&gJ(c)&&mJ(t,c)&&(n=c[fJ],i.end())}var s=function(){e.destroy(),r(n)},o=function(u){e.destroy(),sv("WARNING: error on reading file: %s",u),r(void 0)};e.on("error",o),i.on("data",a).on("end",s).on("error",o)};var hJ=qn.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",r="",n=0,i=0,a=0,s={},o=!1,u=function(f,m,l){var p=t.substring(m,l);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(p=p.replace(/\\([:\\])/g,"$1")),s[vo[f]]=p},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),r=t.charAt(c),o=n==av-1,o){u(n,i);break}c>=0&&e==":"&&r!=="\\"&&(u(n,i,c+1),i=c+2,n+=1)}return s=Object.keys(s).length===av?s:null,s},gJ=qn.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},r=0;r<vo.length;r+=1){var n=e[r],i=t[vo[r]]||"",a=n(i);if(!a)return!1}return!0}});var wO=E((bne,ov)=>{"use strict";var vne=require("path"),xO=require("fs"),Od=bO();ov.exports=function(t,e){var r=Od.getFileName();xO.stat(r,function(n,i){if(n||!Od.usePgPass(i,r))return e(void 0);var a=xO.createReadStream(r);Od.getPassword(t,a,e)})};ov.exports.warnTo=Od.warnTo});var AO=E((xne,EO)=>{"use strict";var yJ=require("events").EventEmitter,_O=fo(),cv=UN(),vJ=Ad(),bJ=ky(),SO=tO(),xJ=Mu(),wJ=iv(),_J=Py(),jd=class extends yJ{constructor(e){super(),this.connectionParameters=new bJ(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let r=e||{};this._Promise=r.Promise||global.Promise,this._types=new vJ(r.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!r.enableChannelBinding,this.connection=r.connection||new wJ({stream:r.stream,ssl:this.connectionParameters.ssl,keepAlive:r.keepAlive||!1,keepAliveInitialDelayMillis:r.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=r.binary||xJ.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=r.connectionTimeoutMillis||0}_errorAllQueries(e){let r=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(r(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(r),this.queryQueue.length=0}_connect(e){let r=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let i=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(i)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){r.ssl?n.requestSsl():n.startup(r.getStartupConf())}),n.on("sslconnect",function(){n.startup(r.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let i=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(i),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(i):this._handleErrorEvent(i):this._connectionError||this._handleErrorEvent(i)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((r,n)=>{this._connect(i=>{i?n(i):r()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let r=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){r.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{r.emit("error",n)});else if(this.password!==null)e();else try{wO()(this.connectionParameters,i=>{i!==void 0&&(this.connectionParameters.password=this.password=i),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let r=await _J.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(r)}catch(r){this.emit("error",r)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=cv.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(r){this.connection.emit("error",r)}})}async _handleAuthSASLContinue(e){try{await cv.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(r){this.connection.emit("error",r)}}_handleAuthSASLFinal(e){try{cv.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(r){this.connection.emit("error",r)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:r}=this;this.activeQuery=null,this.readyForQuery=!0,r&&r.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let r=this.activeQuery;if(!r){this._handleErrorEvent(e);return}this.activeQuery=null,r.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let r=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(r);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,r={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(r.application_name=n),e.replication&&(r.replication=""+e.replication),e.statement_timeout&&(r.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(r.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(r.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(r.options=e.options),r}cancel(e,r){if(e.activeQuery===r){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(r)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(r),1)}setTypeParser(e,r,n){return this._types.setTypeParser(e,r,n)}getTypeParser(e,r){return this._types.getTypeParser(e,r)}escapeIdentifier(e){return _O.escapeIdentifier(e)}escapeLiteral(e){return _O.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,r,n){let i,a,s,o,u;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,a=i=e,typeof r=="function"&&(i.callback=i.callback||r)):(s=e.query_timeout||this.connectionParameters.query_timeout,i=new SO(e,r,n),i.callback||(a=new this._Promise((c,f)=>{i.callback=(m,l)=>m?f(m):c(l)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(u=i.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{i.handleError(c,this.connection)}),u(c),i.callback=()=>{};let f=this.queryQueue.indexOf(i);f>-1&&this.queryQueue.splice(f,1),this._pulseQueryQueue()},s),i.callback=(c,f)=>{clearTimeout(o),u(c,f)}),this.binary&&!i.binary&&(i.binary=!0),i._result&&!i._result._types&&(i._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"),this.connection)}),a):(this.queryQueue.push(i),this._pulseQueryQueue(),a):(process.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),a)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(r=>{this.connection.once("end",r)})}};jd.Query=SO;EO.exports=jd});var IO=E((wne,TO)=>{"use strict";var SJ=require("events").EventEmitter,CO=function(){},PO=(t,e)=>{let r=t.findIndex(e);return r===-1?void 0:t.splice(r,1)[0]},uv=class{constructor(e,r,n){this.client=e,this.idleListener=r,this.timeoutId=n}},bo=class{constructor(e){this.callback=e}};function EJ(){throw new Error("Release called on client which has already been released to the pool.")}function $d(t,e){if(e)return{callback:e,result:void 0};let r,n,i=function(s,o){s?r(s):n(o)},a=new t(function(s,o){n=s,r=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:i,result:a}}function AJ(t,e){return function r(n){n.client=e,e.removeListener("error",r),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var lv=class extends SJ{constructor(e,r){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||pv().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let r=this._idle.pop();clearTimeout(r.timeoutId);let n=r.client;n.ref&&n.ref();let i=r.idleListener;return this._acquireClient(n,e,i,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,r){let n=PO(this._idle,a=>a.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(a=>a!==e);let i=this;e.end(()=>{i.emit("remove",e),typeof r=="function"&&r()})}connect(e){if(this.ending){let i=new Error("Cannot use a pool after calling end on the pool");return e?e(i):this.Promise.reject(i)}let r=$d(this.Promise,e),n=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new bo(r.callback)),n;let i=(o,u,c)=>{clearTimeout(s),r.callback(o,u,c)},a=new bo(i),s=setTimeout(()=>{PO(this._pendingQueue,o=>o.callback===i),a.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(a),n}return this.newClient(new bo(r.callback)),n}newClient(e){let r=new this.Client(this.options);this._clients.push(r);let n=AJ(this,r);this.log("checking client timeout");let i,a=!1;this.options.connectionTimeoutMillis&&(i=setTimeout(()=>{this.log("ending client due to timeout"),a=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(s=>{if(i&&clearTimeout(i),r.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==r),a&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,CO);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(c=>c.client===r)!==-1&&this._acquireClient(r,new bo((c,f,m)=>m()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),r.once("end",()=>clearTimeout(o))}return this._acquireClient(r,e,n,!0)}})}_acquireClient(e,r,n,i){i&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),r.timedOut?i&&this.options.verify?this.options.verify(e,e.release):e.release():i&&this.options.verify?this.options.verify(e,a=>{if(a)return e.release(a),r.callback(a,void 0,CO);r.callback(void 0,e,e.release)}):r.callback(void 0,e,e.release)}_releaseOnce(e,r){let n=!1;return i=>{n&&EJ(),n=!0,this._release(e,r,i)}}_release(e,r,n){if(e.on("error",r),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let a;this.options.idleTimeoutMillis&&this._isAboveMin()&&(a=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&a.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new uv(e,r,a)),this._pulseQueue()}query(e,r,n){if(typeof e=="function"){let a=$d(this.Promise,e);return setImmediate(function(){return a.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),a.result}typeof r=="function"&&(n=r,r=void 0);let i=$d(this.Promise,n);return n=i.callback,this.connect((a,s)=>{if(a)return n(a);let o=!1,u=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",u),this.log("dispatching query");try{s.query(e,r,(c,f)=>{if(this.log("query dispatched"),s.removeListener("error",u),!o)return o=!0,s.release(c),c?n(c):n(void 0,f)})}catch(c){return s.release(c),n(c)}}),i.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let r=$d(this.Promise,e);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,r)=>e+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}};TO.exports=lv});var NO=E((_ne,RO)=>{"use strict";var kO=require("events").EventEmitter,CJ=require("util"),dv=fo(),xo=RO.exports=function(t,e,r){kO.call(this),t=dv.normalizeQueryConfig(t,e,r),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};CJ.inherits(xo,kO);var PJ={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};xo.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let r in e){let n=PJ[r]||r;t[n]=e[r]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};xo.prototype.then=function(t,e){return this._getPromise().then(t,e)};xo.prototype.catch=function(t){return this._getPromise().catch(t)};xo.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};xo.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let r=function(n,i,a){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(a.length>1?i.forEach((s,o)=>{s.forEach(u=>{e.emit("row",u,a[o])})}):i.forEach(function(s){e.emit("row",s,a)})),e.state="end",e.emit("end",a),e.callback&&e.callback(null,a)};if(process.domain&&(r=process.domain.bind(r)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(dv.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let i=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return r(i)}return t.native.execute(this.name,n,r)}return t.native.prepare(this.name,this.text,n.length,function(i){return i?r(i):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,r))})}else if(this.values){if(!Array.isArray(this.values)){let i=new Error("Query values must be an array");return r(i)}let n=this.values.map(dv.prepareValue);t.native.query(this.text,n,r)}else this.queryMode==="extended"?t.native.query(this.text,[],r):t.native.query(this.text,r)}});var DO=E((Sne,FO)=>{"use strict";var OO;try{OO=require("pg-native")}catch(t){throw t}var TJ=Ad(),jO=require("events").EventEmitter,IJ=require("util"),kJ=ky(),$O=NO(),_r=FO.exports=function(t){jO.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new TJ(t.types),this.native=new OO({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new kJ(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};_r.Query=$O;IJ.inherits(_r,jO);_r.prototype._errorAllQueries=function(t){let e=r=>{process.nextTick(()=>{r.native=this.native,r.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};_r.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(r,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),r)return t(r);e.native.connect(n,function(i){if(i)return e.native.end(),t(i);e._connected=!0,e.native.on("error",function(a){e._queryable=!1,e._errorAllQueries(a),e.emit("error",a)}),e.native.on("notification",function(a){e.emit("notification",{channel:a.relname,payload:a.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};_r.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,r)=>{this._connect(n=>{n?r(n):e()})})};_r.prototype.query=function(t,e,r){let n,i,a,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")a=t.query_timeout||this.connectionParameters.query_timeout,i=n=t,typeof e=="function"&&(t.callback=e);else if(a=t.query_timeout||this.connectionParameters.query_timeout,n=new $O(t,e,r),!n.callback){let u,c;i=new this._Promise((f,m)=>{u=f,c=m}).catch(f=>{throw Error.captureStackTrace(f),f}),n.callback=(f,m)=>f?c(f):u(m)}return a&&(o=n.callback,s=setTimeout(()=>{let u=new Error("Query read timeout");process.nextTick(()=>{n.handleError(u,this.connection)}),o(u),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},a),n.callback=(u,c)=>{clearTimeout(s),o(u,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),i):(this._queryQueue.push(n),this._pulseQueryQueue(),i):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),i)};_r.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let r;return t||(r=new this._Promise(function(n,i){t=a=>a?i(a):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),r};_r.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};_r.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let r=this;e.once("_done",function(){r._pulseQueryQueue()})};_r.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};_r.prototype.ref=function(){};_r.prototype.unref=function(){};_r.prototype.setTypeParser=function(t,e,r){return this._types.setTypeParser(t,e,r)};_r.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var fv=E((Ene,MO)=>{"use strict";MO.exports=DO()});var pv=E((Cne,Bu)=>{"use strict";var RJ=AO(),NJ=Mu(),OJ=iv(),jJ=Ny(),$J=fo(),FJ=IO(),DJ=Ad(),{DatabaseError:MJ}=tv(),{escapeIdentifier:qJ,escapeLiteral:LJ}=fo(),BJ=t=>class extends FJ{constructor(r){super(r,t)}},mv=function(t){this.defaults=NJ,this.Client=t,this.Query=this.Client.Query,this.Pool=BJ(this.Client),this._pools=[],this.Connection=OJ,this.types=Du(),this.DatabaseError=MJ,this.TypeOverrides=DJ,this.escapeIdentifier=qJ,this.escapeLiteral=LJ,this.Result=jJ,this.utils=$J};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Bu.exports=new mv(fv()):(Bu.exports=new mv(RJ),Object.defineProperty(Bu.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new mv(fv())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Bu.exports,"native",{value:t}),t}}))});var kr,Pne,Tne,Ine,kne,Rne,Nne,One,jne,$ne,Fne,Dne,Ci,Fd=S(()=>{kr=er(pv(),1),Pne=kr.default.Client,Tne=kr.default.Pool,Ine=kr.default.Connection,kne=kr.default.types,Rne=kr.default.Query,Nne=kr.default.DatabaseError,One=kr.default.escapeIdentifier,jne=kr.default.escapeLiteral,$ne=kr.default.Result,Fne=kr.default.TypeOverrides,Dne=kr.default.defaults,Ci=kr.default});function F(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,_))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(_ in r&&r[_]===e[_])return!0;r=Object.getPrototypeOf(r)}return!1}var _,qne,H=S(()=>{_=Symbol.for("drizzle:entityKind"),qne=Symbol.for("drizzle:hasOwnEntityKind")});var hv,Dd,Md,qd=S(()=>{H();hv=class{static[_]="ConsoleLogWriter";write(e){console.log(e)}},Dd=class{static[_]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new hv}logQuery(e,r){let n=r.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),i=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${i}`)}},Md=class{static[_]="NoopLogger";logQuery(){}}});var nr,Ln=S(()=>{H();nr=class{static[_]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}then(e,r){return this.execute().then(e,r)}}});var De,yn=S(()=>{H();De=class{constructor(e,r){this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}static[_]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}});var Ld,gv=S(()=>{H();Ld=class{static[_]="ColumnBuilder";config;constructor(e,r,n){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}});var tn,Bd=S(()=>{tn=Symbol.for("drizzle:Name")});var Ud,yv,vv=S(()=>{H();Bd();Ud=class{static[_]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,r){this.reference=()=>{let{name:n,columns:i,foreignColumns:a}=e();return{name:n,columns:i,foreignTable:a[0].table,foreignColumns:a}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new yv(e,this)}},yv=class{constructor(e,r){this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}static[_]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:r,foreignColumns:n}=this.reference(),i=r.map(o=>o.name),a=n.map(o=>o.name),s=[this.table[tn],...i,n[0].table[tn],...a];return e??`${s.join("_")}_fk`}}});function Vd(t,...e){return t(...e)}var bv=S(()=>{});function _v(t,e){return`${t[tn]}_${e.join("_")}_unique`}var xv,qO,wv,Sv=S(()=>{H();Bd();xv=class{constructor(e,r){this.name=r,this.columns=e}static[_]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new wv(e,this.columns,this.nullsNotDistinctConfig,this.name)}},qO=class{static[_]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new xv(e,this.name)}},wv=class{constructor(e,r,n,i){this.table=e,this.columns=r,this.name=i??_v(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=n}static[_]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}});function LO(t,e,r){for(let n=e;n<t.length;n++){let i=t[n];if(i==="\\"){n++;continue}if(i==='"')return[t.slice(e,n).replace(/\\/g,""),n+1];if(!r&&(i===","||i==="}"))return[t.slice(e,n).replace(/\\/g,""),n]}return[t.slice(e).replace(/\\/g,""),t.length]}function BO(t,e=0){let r=[],n=e,i=!1;for(;n<t.length;){let a=t[n];if(a===","){(i||n===e)&&r.push(""),i=!0,n++;continue}if(i=!1,a==="\\"){n+=2;continue}if(a==='"'){let[u,c]=LO(t,n+1,!0);r.push(u),n=c;continue}if(a==="}")return[r,n+1];if(a==="{"){let[u,c]=BO(t,n+1);r.push(u),n=c;continue}let[s,o]=LO(t,n,!1);r.push(s),n=o}return[r,n]}function UO(t){let[e]=BO(t,1);return e}function Ev(t){return`{${t.map(e=>Array.isArray(e)?Ev(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Av=S(()=>{});var re,z,Cv,wo,Pv,Tv,Pe=S(()=>{gv();yn();H();vv();bv();Sv();Av();re=class extends Ld{foreignKeyConfigs=[];static[_]="PgColumnBuilder";array(e){return new Pv(this.config.name,this,e)}references(e,r={}){return this.foreignKeyConfigs.push({ref:e,actions:r}),this}unique(e,r){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=r?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,r){return this.foreignKeyConfigs.map(({ref:n,actions:i})=>Vd((a,s)=>{let o=new Ud(()=>{let u=a();return{columns:[e],foreignColumns:[u]}});return s.onUpdate&&o.onUpdate(s.onUpdate),s.onDelete&&o.onDelete(s.onDelete),o.build(r)},n,i))}buildExtraConfigColumn(e){return new Cv(e,this.config)}},z=class extends De{constructor(e,r){r.uniqueName||(r.uniqueName=_v(e,[r.name])),super(e,r),this.table=e}static[_]="PgColumn"},Cv=class extends z{static[_]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},wo=class{static[_]="IndexedColumn";constructor(e,r,n,i){this.name=e,this.keyAsName=r,this.type=n,this.indexConfig=i}name;keyAsName;type;indexConfig},Pv=class extends re{static[_]="PgArrayBuilder";constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){let r=this.config.baseBuilder.build(e);return new Tv(e,this.config,r)}},Tv=class t extends z{constructor(e,r,n,i){super(e,r),this.baseColumn=n,this.range=i,this.size=r.size}size;static[_]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=UO(e)),e.map(r=>this.baseColumn.mapFromDriverValue(r))}mapToDriverValue(e,r=!1){let n=e.map(i=>i===null?null:F(this.baseColumn,t)?this.baseColumn.mapToDriverValue(i,!0):this.baseColumn.mapToDriverValue(i));return r?n:Ev(n)}}});function VO(t){return!!t&&typeof t=="function"&&Iv in t&&t[Iv]===!0}function zO(t,e,r){let n=Object.assign(i=>new kv(i??"",n),{enumName:t,enumValues:e,schema:r,[Iv]:!0});return n}var Iv,kv,Rv,zd=S(()=>{H();Pe();Iv=Symbol.for("drizzle:isPgEnum");kv=class extends re{static[_]="PgEnumColumnBuilder";constructor(e,r){super(e,"string","PgEnumColumn"),this.config.enum=r}build(e){return new Rv(e,this.config)}},Rv=class extends z{static[_]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,r){super(e,r),this.enum=r.enum}getSQLType(){return this.enum.enumName}}});var Tt,_o,vn=S(()=>{H();Tt=class{static[_]="Subquery";constructor(e,r,n,i=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:i}}},_o=class extends Tt{static[_]="WithSubquery"}});var HO,QO=S(()=>{HO="0.39.3"});var Nv,Ov,tt,Bn=S(()=>{bv();QO();tt={startActiveSpan(t,e){return Nv?(Ov||(Ov=Nv.trace.getTracer("drizzle-orm",HO)),Vd((r,n)=>n.startActiveSpan(t,i=>{try{return e(i)}catch(a){throw i.setStatus({code:r.SpanStatusCode.ERROR,message:a instanceof Error?a.message:"Unknown error"}),a}finally{i.end()}}),Nv,Ov)):e()}}});var rt,Un=S(()=>{rt=Symbol.for("drizzle:ViewBaseConfig")});function Fv(t){return typeof t=="object"&&t!==null&&GO in t}function Sr(t){return t[tn]}function Da(t){return`${t[Hd]??"public"}.${t[tn]}`}var Hd,Qd,WO,jv,$v,Uu,KO,GO,K,Er=S(()=>{H();Bd();Hd=Symbol.for("drizzle:Schema"),Qd=Symbol.for("drizzle:Columns"),WO=Symbol.for("drizzle:ExtraConfigColumns"),jv=Symbol.for("drizzle:OriginalName"),$v=Symbol.for("drizzle:BaseName"),Uu=Symbol.for("drizzle:IsAlias"),KO=Symbol.for("drizzle:ExtraConfigBuilder"),GO=Symbol.for("drizzle:IsDrizzleTable"),K=class{static[_]="Table";static Symbol={Name:tn,Schema:Hd,OriginalName:jv,Columns:Qd,ExtraConfigColumns:WO,BaseName:$v,IsAlias:Uu,ExtraConfigBuilder:KO};[tn];[jv];[Hd];[Qd];[WO];[$v];[Uu]=!1;[GO]=!0;[KO]=void 0;constructor(e,r,n){this[tn]=this[jv]=e,this[Hd]=r,this[$v]=n}}});function Dv(t){return t!=null&&typeof t.getSQL=="function"}function UJ(t){let e={sql:"",params:[]};for(let r of t)e.sql+=r.sql,e.params.push(...r.params),r.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...r.typings));return e}function YO(t){return typeof t=="object"&&t!==null&&"mapToDriverValue"in t&&typeof t.mapToDriverValue=="function"}function y(t,...e){let r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new It(t[0]));for(let[n,i]of e.entries())r.push(i,new It(t[n+1]));return new G(r)}function Mv(t,e){return t.map(r=>{if(F(r,Vn)){if(!(r.name in e))throw new Error(`No value for placeholder "${r.name}" was provided`);return e[r.name]}if(F(r,Ar)&&F(r.value,Vn)){if(!(r.value.name in e))throw new Error(`No value for placeholder "${r.value.name}" was provided`);return r.encoder.mapToDriverValue(e[r.value.name])}return r})}function tj(t){return typeof t=="object"&&t!==null&&ej in t}var JO,It,G,Vu,XO,ZO,Nie,Ar,Vn,ej,mr,kt=S(()=>{H();zd();vn();Bn();Un();yn();Er();JO=class{static[_]="FakePrimitiveParam"};It=class{static[_]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new G([this])}},G=class t{constructor(e){this.queryChunks=e}static[_]="SQL";decoder=XO;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return tt.startActiveSpan("drizzle.buildSQL",r=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return r?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){let n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:i,escapeName:a,escapeParam:s,prepareTyping:o,inlineParams:u,paramStartIndex:c}=n;return UJ(e.map(f=>{if(F(f,It))return{sql:f.value.join(""),params:[]};if(F(f,Vu))return{sql:a(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let m=[new It("(")];for(let[l,p]of f.entries())m.push(p),l<f.length-1&&m.push(new It(", "));return m.push(new It(")")),this.buildQueryFromSourceParams(m,n)}if(F(f,t))return this.buildQueryFromSourceParams(f.queryChunks,{...n,inlineParams:u||f.shouldInlineParams});if(F(f,K)){let m=f[K.Symbol.Schema],l=f[K.Symbol.Name];return{sql:m===void 0||f[Uu]?a(l):a(m)+"."+a(l),params:[]}}if(F(f,De)){let m=i.getColumnCasing(f);if(r.invokeSource==="indexes")return{sql:a(m),params:[]};let l=f.table[K.Symbol.Schema];return{sql:f.table[Uu]||l===void 0?a(f.table[K.Symbol.Name])+"."+a(m):a(l)+"."+a(f.table[K.Symbol.Name])+"."+a(m),params:[]}}if(F(f,mr)){let m=f[rt].schema,l=f[rt].name;return{sql:m===void 0||f[rt].isAlias?a(l):a(m)+"."+a(l),params:[]}}if(F(f,Ar)){if(F(f.value,Vn))return{sql:s(c.value++,f),params:[f],typings:["none"]};let m=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(F(m,t))return this.buildQueryFromSourceParams([m],n);if(u)return{sql:this.mapInlineParam(m,n),params:[]};let l=["none"];return o&&(l=[o(f.encoder)]),{sql:s(c.value++,m),params:[m],typings:l}}return F(f,Vn)?{sql:s(c.value++,f),params:[f],typings:["none"]}:F(f,t.Aliased)&&f.fieldAlias!==void 0?{sql:a(f.fieldAlias),params:[]}:F(f,Tt)?f._.isWith?{sql:a(f._.alias),params:[]}:this.buildQueryFromSourceParams([new It("("),f._.sql,new It(") "),new Vu(f._.alias)],n):VO(f)?f.schema?{sql:a(f.schema)+"."+a(f.enumName),params:[]}:{sql:a(f.enumName),params:[]}:Dv(f)?f.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([f.getSQL()],n):this.buildQueryFromSourceParams([new It("("),f.getSQL(),new It(")")],n):u?{sql:this.mapInlineParam(f,n),params:[]}:{sql:s(c.value++,f),params:[f],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){let n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new t.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Vu=class{constructor(e){this.value=e}static[_]="Name";brand;getSQL(){return new G([this])}};XO={mapFromDriverValue:t=>t},ZO={mapToDriverValue:t=>t},Nie={...XO,...ZO},Ar=class{constructor(e,r=ZO){this.value=e,this.encoder=r}static[_]="Param";brand;getSQL(){return new G([this])}};(t=>{function e(){return new G([])}t.empty=e;function r(u){return new G(u)}t.fromList=r;function n(u){return new G([new It(u)])}t.raw=n;function i(u,c){let f=[];for(let[m,l]of u.entries())m>0&&c!==void 0&&f.push(c),f.push(l);return new G(f)}t.join=i;function a(u){return new Vu(u)}t.identifier=a;function s(u){return new Vn(u)}t.placeholder=s;function o(u,c){return new Ar(u,c)}t.param=o})(y||(y={}));(t=>{class e{constructor(n,i){this.sql=n,this.fieldAlias=i}static[_]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}t.Aliased=e})(G||(G={}));Vn=class{constructor(e){this.name=e}static[_]="Placeholder";getSQL(){return new G([this])}};ej=Symbol.for("drizzle:IsDrizzleView"),mr=class{static[_]="View";[rt];[ej]=!0;constructor({name:e,schema:r,selectedFields:n,query:i}){this[rt]={name:e,originalName:e,schema:r,selectedFields:n,query:i,isExisting:!i,isAlias:!1}}getSQL(){return new G([this])}};De.prototype.getSQL=function(){return new G([this])};K.prototype.getSQL=function(){return new G([this])};Tt.prototype.getSQL=function(){return new G([this])}});function zu(t,e){return new Proxy(t,new So(e,!1))}function bn(t,e){return new Proxy(t,new Ma(new Proxy(t.table,new So(e,!1))))}function qv(t,e){return new G.Aliased(Hu(t.sql,e),t.fieldAlias)}function Hu(t,e){return y.join(t.queryChunks.map(r=>F(r,De)?bn(r,e):F(r,G)?Hu(r,e):F(r,G.Aliased)?qv(r,e):r))}var Ma,So,rj,Wd=S(()=>{yn();H();kt();Er();Un();Ma=class{constructor(e){this.table=e}static[_]="ColumnAliasProxyHandler";get(e,r){return r==="table"?this.table:e[r]}},So=class{constructor(e,r){this.alias=e,this.replaceOriginalName=r}static[_]="TableAliasProxyHandler";get(e,r){if(r===K.Symbol.IsAlias)return!0;if(r===K.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===K.Symbol.OriginalName)return this.alias;if(r===rt)return{...e[rt],name:this.alias,isAlias:!0};if(r===K.Symbol.Columns){let i=e[K.Symbol.Columns];if(!i)return i;let a={};return Object.keys(i).map(s=>{a[s]=new Proxy(i[s],new Ma(new Proxy(e,this)))}),a}let n=e[r];return F(n,De)?new Proxy(n,new Ma(new Proxy(e,this))):n}},rj=class{constructor(e){this.alias=e}static[_]="RelationTableAliasProxyHandler";get(e,r){return r==="sourceTable"?zu(e.sourceTable,this.alias):e[r]}}});var Ge,Pi=S(()=>{Wd();yn();H();kt();vn();Un();Ge=class t{static[_]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,r){if(r==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(r===rt)return{...e[rt],selectedFields:new Proxy(e[rt].selectedFields,this)};if(typeof r=="symbol")return e[r];let i=(F(e,Tt)?e._.selectedFields:F(e,mr)?e[rt].selectedFields:e)[r];if(F(i,G.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!i.isSelectionField)return i.sql;let a=i.clone();return a.isSelectionField=!0,a}if(F(i,G)){if(this.config.sqlBehavior==="sql")return i;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return F(i,De)?this.config.alias?new Proxy(i,new Ma(new Proxy(i.table,new So(this.config.alias,this.config.replaceOriginalName??!1)))):i:typeof i!="object"||i===null?i:new Proxy(i,new t(this.config))}}});function nj(t,e,r){let n={},i=t.reduce((a,{path:s,field:o},u)=>{let c;F(o,De)?c=o:F(o,G)?c=o.decoder:c=o.sql.decoder;let f=a;for(let[m,l]of s.entries())if(m<s.length-1)l in f||(f[l]={}),f=f[l];else{let p=e[u],d=f[l]=p===null?null:c.mapFromDriverValue(p);if(r&&F(o,De)&&s.length===2){let h=s[0];h in n?typeof n[h]=="string"&&n[h]!==Sr(o.table)&&(n[h]=!1):n[h]=d===null?Sr(o.table):!1}}return a},{});if(r&&Object.keys(n).length>0)for(let[a,s]of Object.entries(n))typeof s=="string"&&!r[s]&&(i[a]=null);return i}function Qr(t,e){return Object.entries(t).reduce((r,[n,i])=>{if(typeof n!="string")return r;let a=e?[...e,n]:[n];return F(i,De)||F(i,G)||F(i,G.Aliased)?r.push({path:a,field:i}):F(i,K)?r.push(...Qr(i[K.Symbol.Columns],a)):r.push(...Qr(i,a)),r},[])}function Qu(t,e){let r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let[i,a]of r.entries())if(a!==n[i])return!1;return!0}function Kd(t,e){let r=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,i])=>F(i,G)||F(i,De)?[n,i]:[n,new Ar(i,t[K.Symbol.Columns][n])]);if(r.length===0)throw new Error("No values to set");return Object.fromEntries(r)}function ij(t,e){for(let r of e)for(let n of Object.getOwnPropertyNames(r.prototype))n!=="constructor"&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(r.prototype,n)||Object.create(null))}function qa(t){return t[K.Symbol.Columns]}function aj(t){return t[rt].selectedFields}function zn(t){return F(t,Tt)?t._.alias:F(t,mr)?t[rt].name:F(t,G)?void 0:t[K.Symbol.IsAlias]?t[K.Symbol.Name]:t[K.Symbol.BaseName]}function ke(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}function sj(t){if(typeof t!="object"||t===null||t.constructor.name!=="Object")return!1;if("logger"in t){let e=typeof t.logger;return!(e!=="boolean"&&(e!=="object"||typeof t.logger.logQuery!="function")&&e!=="undefined")}if("schema"in t){let e=typeof t.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in t){let e=typeof t.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in t)return!(t.mode!=="default"||t.mode!=="planetscale"||t.mode!==void 0);if("connection"in t){let e=typeof t.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in t){let e=typeof t.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(t).length===0}var Je=S(()=>{yn();H();kt();vn();Er();Un()});var Wu,oj=S(()=>{H();Ln();Pi();Er();Bn();Je();Wu=class extends nr{constructor(e,r,n,i){super(),this.session=r,this.dialect=n,this.config={table:e,withList:i}}static[_]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[K.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Qr(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return tt.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>tt.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Ge({alias:Sr(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}});function VJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(r=>r.toLowerCase()).join("_")}function zJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((r,n,i)=>{let a=i===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return r+a},"")}function HJ(t){return t}var Gd,cj=S(()=>{H();Er();Gd=class{static[_]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?VJ:e==="camelCase"?zJ:HJ}getColumnCasing(e){if(!e.keyAsName)return e.name;let r=e.table[K.Symbol.Schema]??"public",n=e.table[K.Symbol.OriginalName],i=`${r}.${n}.${e.name}`;return this.cache[i]||this.cacheTable(e.table),this.cache[i]}cacheTable(e){let r=e[K.Symbol.Schema]??"public",n=e[K.Symbol.OriginalName],i=`${r}.${n}`;if(!this.cachedTables[i]){for(let a of Object.values(e[K.Symbol.Columns])){let s=`${i}.${a.name}`;this.cache[s]=this.convert(a.name)}this.cachedTables[i]=!0}}clearCache(){this.cache={},this.cachedTables={}}}});var Ku,Jd,Yd=S(()=>{H();Ku=class extends Error{static[_]="DrizzleError";constructor({message:e,cause:r}){super(e),this.name="DrizzleError",this.cause=r}},Jd=class extends Ku{static[_]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}});var Hn,Gu=S(()=>{H();Pe();Hn=class extends re{static[_]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}});function Ju(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Lv(r):new Uv(r)}var Lv,Bv,Uv,Vv,zv=S(()=>{H();Je();Pe();Gu();Lv=class extends Hn{static[_]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Bv(e,this.config)}},Bv=class extends z{static[_]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Uv=class extends Hn{static[_]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Vv(e,this.config)}},Vv=class extends z{static[_]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}});function uj(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Hv(r):new Wv(r)}var Hv,Qv,Wv,Kv,Gv=S(()=>{H();Je();Pe();Hv=class extends re{static[_]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Qv(e,this.config)}},Qv=class extends z{static[_]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Wv=class extends re{static[_]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Kv(e,this.config)}},Kv=class extends z{static[_]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}});function Ti(t){return new Jv(t??"")}var Jv,Yv,Xv=S(()=>{H();Pe();Jv=class extends re{static[_]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Yv(e,this.config)}},Yv=class extends z{static[_]="PgBoolean";getSQLType(){return"boolean"}}});function lj(t,e={}){let{name:r,config:n}=ke(t,e);return new Zv(r,n)}var Zv,eb,tb=S(()=>{H();Je();Pe();Zv=class extends re{static[_]="PgCharBuilder";constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new eb(e,this.config)}},eb=class extends z{static[_]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}});function pj(t){return new rb(t??"")}var rb,nb,ib=S(()=>{H();Pe();rb=class extends re{static[_]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new nb(e,this.config)}},nb=class extends z{static[_]="PgCidr";getSQLType(){return"cidr"}}});function dj(t){return(e,r)=>{let{name:n,config:i}=ke(e,r);return new ab(n,i,t)}}var ab,sb,ob=S(()=>{H();Je();Pe();ab=class extends re{static[_]="PgCustomColumnBuilder";constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new sb(e,this.config)}},sb=class extends z{static[_]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,r){super(e,r),this.sqlName=r.customTypeParams.dataType(r.fieldConfig),this.mapTo=r.customTypeParams.toDriver,this.mapFrom=r.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}});var xn,Xd=S(()=>{H();kt();Pe();xn=class extends re{static[_]="PgDateColumnBaseBuilder";defaultNow(){return this.default(y`now()`)}}});function fj(t,e){let{name:r,config:n}=ke(t,e);return n?.mode==="date"?new cb(r):new ub(r)}var cb,Yu,ub,Xu,lb=S(()=>{H();Je();Pe();Xd();cb=class extends xn{static[_]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Yu(e,this.config)}},Yu=class extends z{static[_]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},ub=class extends xn{static[_]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Xu(e,this.config)}},Xu=class extends z{static[_]="PgDateString";getSQLType(){return"date"}}});function mj(t){return new pb(t??"")}var pb,db,fb=S(()=>{H();Pe();pb=class extends re{static[_]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new db(e,this.config)}},db=class extends z{static[_]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}});function hj(t){return new mb(t??"")}var mb,hb,gb=S(()=>{H();Pe();mb=class extends re{static[_]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new hb(e,this.config)}},hb=class extends z{static[_]="PgInet";getSQLType(){return"inet"}}});function Z(t){return new yb(t??"")}var yb,vb,bb=S(()=>{H();Pe();Gu();yb=class extends Hn{static[_]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new vb(e,this.config)}},vb=class extends z{static[_]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}});function gj(t,e={}){let{name:r,config:n}=ke(t,e);return new xb(r,n)}var xb,wb,_b=S(()=>{H();Je();Pe();xb=class extends re{static[_]="PgIntervalBuilder";constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new wb(e,this.config)}},wb=class extends z{static[_]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",r=this.precision?`(${this.precision})`:"";return`interval${e}${r}`}}});function yj(t){return new Sb(t??"")}var Sb,Zu,Eb=S(()=>{H();Pe();Sb=class extends re{static[_]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Zu(e,this.config)}},Zu=class extends z{static[_]="PgJson";constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function Qe(t){return new Ab(t??"")}var Ab,el,Cb=S(()=>{H();Pe();Ab=class extends re{static[_]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new el(e,this.config)}},el=class extends z{static[_]="PgJsonb";constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function vj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Pb(r):new Ib(r)}var Pb,Tb,Ib,kb,Rb=S(()=>{H();Je();Pe();Pb=class extends re{static[_]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Tb(e,this.config)}},Tb=class extends z{static[_]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(i)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Ib=class extends re{static[_]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new kb(e,this.config)}},kb=class extends z{static[_]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(i)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}});function bj(t){return new Nb(t??"")}var Nb,Ob,jb=S(()=>{H();Pe();Nb=class extends re{static[_]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new Ob(e,this.config)}},Ob=class extends z{static[_]="PgMacaddr";getSQLType(){return"macaddr"}}});function xj(t){return new $b(t??"")}var $b,Fb,Db=S(()=>{H();Pe();$b=class extends re{static[_]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Fb(e,this.config)}},Fb=class extends z{static[_]="PgMacaddr8";getSQLType(){return"macaddr8"}}});function qb(t,e){let{name:r,config:n}=ke(t,e);return new Mb(r,n?.precision,n?.scale)}var Mb,tl,Kt,Lb=S(()=>{H();Je();Pe();Mb=class extends re{static[_]="PgNumericBuilder";constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new tl(e,this.config)}},tl=class extends z{static[_]="PgNumeric";precision;scale;constructor(e,r){super(e,r),this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Kt=qb});function wj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Bb(r):new Vb(r)}var Bb,Ub,Vb,zb,Hb=S(()=>{H();Je();Pe();Bb=class extends re{static[_]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Ub(e,this.config)}},Ub=class extends z{static[_]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Vb=class extends re{static[_]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new zb(e,this.config)}},zb=class extends z{static[_]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}});function QJ(t){let e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function _j(t,e){let r=new ArrayBuffer(8),n=new DataView(r);for(let i=0;i<8;i++)n.setUint8(i,t[e+i]);return n.getFloat64(0,!0)}function Qb(t){let e=QJ(t),r=0,n=e[r];r+=1;let i=new DataView(e.buffer),a=i.getUint32(r,n===1);r+=4;let s;if(a&536870912&&(s=i.getUint32(r,n===1),r+=4),(a&65535)===1){let o=_j(e,r);r+=8;let u=_j(e,r);return r+=8,[o,u]}throw new Error("Unsupported geometry type")}var Sj=S(()=>{});function Ej(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Wb(r):new Gb(r)}var Wb,Kb,Gb,Jb,Yb=S(()=>{H();Je();Pe();Sj();Wb=class extends re{static[_]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new Kb(e,this.config)}},Kb=class extends z{static[_]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Qb(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},Gb=class extends re{static[_]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new Jb(e,this.config)}},Jb=class extends z{static[_]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let r=Qb(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}});function Aj(t){return new Xb(t??"")}var Xb,Zb,ex=S(()=>{H();Pe();Xb=class extends re{static[_]="PgRealBuilder";constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new Zb(e,this.config)}},Zb=class extends z{static[_]="PgReal";constructor(e,r){super(e,r)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}});function Ye(t){return new tx(t??"")}var tx,rx,nx=S(()=>{H();Pe();tx=class extends re{static[_]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new rx(e,this.config)}},rx=class extends z{static[_]="PgSerial";getSQLType(){return"serial"}}});function Cj(t){return new ix(t??"")}var ix,ax,sx=S(()=>{H();Pe();Gu();ix=class extends Hn{static[_]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new ax(e,this.config)}},ax=class extends z{static[_]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}});function Pj(t){return new ox(t??"")}var ox,cx,ux=S(()=>{H();Pe();ox=class extends re{static[_]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new cx(e,this.config)}},cx=class extends z{static[_]="PgSmallSerial";getSQLType(){return"smallserial"}}});function $(t,e={}){let{name:r,config:n}=ke(t,e);return new lx(r,n)}var lx,px,dx=S(()=>{H();Je();Pe();lx=class extends re{static[_]="PgTextBuilder";constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new px(e,this.config)}},px=class extends z{static[_]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}});function Tj(t,e={}){let{name:r,config:n}=ke(t,e);return new fx(r,n.withTimezone??!1,n.precision)}var fx,rl,mx=S(()=>{H();Je();Pe();Xd();fx=class extends xn{constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}static[_]="PgTimeBuilder";build(e){return new rl(e,this.config)}},rl=class extends z{static[_]="PgTime";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function we(t,e={}){let{name:r,config:n}=ke(t,e);return n?.mode==="string"?new gx(r,n.withTimezone??!1,n.precision):new hx(r,n?.withTimezone??!1,n?.precision)}var hx,nl,gx,il,yx=S(()=>{H();Je();Pe();Xd();hx=class extends xn{static[_]="PgTimestampBuilder";constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new nl(e,this.config)}},nl=class extends z{static[_]="PgTimestamp";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},gx=class extends xn{static[_]="PgTimestampStringBuilder";constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new il(e,this.config)}},il=class extends z{static[_]="PgTimestampString";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function Ij(t){return new vx(t??"")}var vx,al,bx=S(()=>{H();kt();Pe();vx=class extends re{static[_]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(y`gen_random_uuid()`)}build(e){return new al(e,this.config)}},al=class extends z{static[_]="PgUUID";getSQLType(){return"uuid"}}});function Gt(t,e={}){let{name:r,config:n}=ke(t,e);return new xx(r,n)}var xx,wx,_x=S(()=>{H();Je();Pe();xx=class extends re{static[_]="PgVarcharBuilder";constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new wx(e,this.config)}},wx=class extends z{static[_]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}});function kj(t,e){let{name:r,config:n}=ke(t,e);return new Sx(r,n)}var Sx,Ex,Ax=S(()=>{H();Je();Pe();Sx=class extends re{static[_]="PgBinaryVectorBuilder";constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new Ex(e,this.config)}},Ex=class extends z{static[_]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}});function Rj(t,e){let{name:r,config:n}=ke(t,e);return new Cx(r,n)}var Cx,Px,Tx=S(()=>{H();Je();Pe();Cx=class extends re{static[_]="PgHalfVectorBuilder";constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){returIPv4 resolution failed, using original URL: Error: getaddrinfo ENOTFOUND db.epbxctcwmtsuxdgxkgdz.supabase.co
2026-Jan-18 17:01:11.213393 at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:111:26) {
2026-Jan-18 17:01:11.213393 errno: -3007,
2026-Jan-18 17:01:11.213393 code: 'ENOTFOUND',
2026-Jan-18 17:01:11.213393 syscall: 'getaddrinfo',
2026-Jan-18 17:01:11.213393 hostname: 'db.epbxctcwmtsuxdgxkgdz.supabase.co'
2026-Jan-18 17:01:11.213393 }
2026-Jan-18 17:01:11.213393 /app/dist/index.cjs:67
2026-Jan-18 17:01:11.213393 `);Lu.write(vO.format.apply(vO,e))}}Object.defineProperty(qn.exports,"isWin",{get:function(){return Nd},set:function(t){Nd=t}});qn.exports.warnTo=function(t){var e=Lu;return Lu=t,e};qn.exports.getFileName=function(t){var e=t||process.env,r=e.PGPASSFILE||(Nd?yO.join(e.APPDATA||"./","postgresql","pgpass.conf"):yO.join(e.HOME||"./",".pgpass"));return r};qn.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Nd?!0:(e=e||"<unkn>",dJ(t.mode)?t.mode&(cJ|uJ)?(sv('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(sv('WARNING: password file "%s" is not a plain file',e),!1))};var mJ=qn.exports.match=function(t,e){return vo.slice(0,-1).reduce(function(r,n,i){return i==1&&Number(t[n]||oJ)===Number(e[n])?r&&!0:r&&(e[n]==="*"||e[n]===t[n])},!0)};qn.exports.getPassword=function(t,e,r){var n,i=e.pipe(sJ());function a(u){var c=hJ(u);c&&gJ(c)&&mJ(t,c)&&(n=c[fJ],i.end())}var s=function(){e.destroy(),r(n)},o=function(u){e.destroy(),sv("WARNING: error on reading file: %s",u),r(void 0)};e.on("error",o),i.on("data",a).on("end",s).on("error",o)};var hJ=qn.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",r="",n=0,i=0,a=0,s={},o=!1,u=function(f,m,l){var p=t.substring(m,l);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(p=p.replace(/\\([:\\])/g,"$1")),s[vo[f]]=p},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),r=t.charAt(c),o=n==av-1,o){u(n,i);break}c>=0&&e==":"&&r!=="\\"&&(u(n,i,c+1),i=c+2,n+=1)}return s=Object.keys(s).length===av?s:null,s},gJ=qn.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},r=0;r<vo.length;r+=1){var n=e[r],i=t[vo[r]]||"",a=n(i);if(!a)return!1}return!0}});var wO=E((bne,ov)=>{"use strict";var vne=require("path"),xO=require("fs"),Od=bO();ov.exports=function(t,e){var r=Od.getFileName();xO.stat(r,function(n,i){if(n||!Od.usePgPass(i,r))return e(void 0);var a=xO.createReadStream(r);Od.getPassword(t,a,e)})};ov.exports.warnTo=Od.warnTo});var AO=E((xne,EO)=>{"use strict";var yJ=require("events").EventEmitter,_O=fo(),cv=UN(),vJ=Ad(),bJ=ky(),SO=tO(),xJ=Mu(),wJ=iv(),_J=Py(),jd=class extends yJ{constructor(e){super(),this.connectionParameters=new bJ(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let r=e||{};this._Promise=r.Promise||global.Promise,this._types=new vJ(r.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!r.enableChannelBinding,this.connection=r.connection||new wJ({stream:r.stream,ssl:this.connectionParameters.ssl,keepAlive:r.keepAlive||!1,keepAliveInitialDelayMillis:r.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=r.binary||xJ.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=r.connectionTimeoutMillis||0}_errorAllQueries(e){let r=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(r(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(r),this.queryQueue.length=0}_connect(e){let r=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let i=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(i)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){r.ssl?n.requestSsl():n.startup(r.getStartupConf())}),n.on("sslconnect",function(){n.startup(r.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let i=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(i),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(i):this._handleErrorEvent(i):this._connectionError||this._handleErrorEvent(i)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((r,n)=>{this._connect(i=>{i?n(i):r()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let r=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){r.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{r.emit("error",n)});else if(this.password!==null)e();else try{wO()(this.connectionParameters,i=>{i!==void 0&&(this.connectionParameters.password=this.password=i),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let r=await _J.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(r)}catch(r){this.emit("error",r)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=cv.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(r){this.connection.emit("error",r)}})}async _handleAuthSASLContinue(e){try{await cv.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(r){this.connection.emit("error",r)}}_handleAuthSASLFinal(e){try{cv.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(r){this.connection.emit("error",r)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:r}=this;this.activeQuery=null,this.readyForQuery=!0,r&&r.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let r=this.activeQuery;if(!r){this._handleErrorEvent(e);return}this.activeQuery=null,r.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let r=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(r);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,r={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(r.application_name=n),e.replication&&(r.replication=""+e.replication),e.statement_timeout&&(r.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(r.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(r.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(r.options=e.options),r}cancel(e,r){if(e.activeQuery===r){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(r)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(r),1)}setTypeParser(e,r,n){return this._types.setTypeParser(e,r,n)}getTypeParser(e,r){return this._types.getTypeParser(e,r)}escapeIdentifier(e){return _O.escapeIdentifier(e)}escapeLiteral(e){return _O.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,r,n){let i,a,s,o,u;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,a=i=e,typeof r=="function"&&(i.callback=i.callback||r)):(s=e.query_timeout||this.connectionParameters.query_timeout,i=new SO(e,r,n),i.callback||(a=new this._Promise((c,f)=>{i.callback=(m,l)=>m?f(m):c(l)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(u=i.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{i.handleError(c,this.connection)}),u(c),i.callback=()=>{};let f=this.queryQueue.indexOf(i);f>-1&&this.queryQueue.splice(f,1),this._pulseQueryQueue()},s),i.callback=(c,f)=>{clearTimeout(o),u(c,f)}),this.binary&&!i.binary&&(i.binary=!0),i._result&&!i._result._types&&(i._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"),this.connection)}),a):(this.queryQueue.push(i),this._pulseQueryQueue(),a):(process.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),a)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(r=>{this.connection.once("end",r)})}};jd.Query=SO;EO.exports=jd});var IO=E((wne,TO)=>{"use strict";var SJ=require("events").EventEmitter,CO=function(){},PO=(t,e)=>{let r=t.findIndex(e);return r===-1?void 0:t.splice(r,1)[0]},uv=class{constructor(e,r,n){this.client=e,this.idleListener=r,this.timeoutId=n}},bo=class{constructor(e){this.callback=e}};function EJ(){throw new Error("Release called on client which has already been released to the pool.")}function $d(t,e){if(e)return{callback:e,result:void 0};let r,n,i=function(s,o){s?r(s):n(o)},a=new t(function(s,o){n=s,r=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:i,result:a}}function AJ(t,e){return function r(n){n.client=e,e.removeListener("error",r),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var lv=class extends SJ{constructor(e,r){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||pv().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let r=this._idle.pop();clearTimeout(r.timeoutId);let n=r.client;n.ref&&n.ref();let i=r.idleListener;return this._acquireClient(n,e,i,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,r){let n=PO(this._idle,a=>a.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(a=>a!==e);let i=this;e.end(()=>{i.emit("remove",e),typeof r=="function"&&r()})}connect(e){if(this.ending){let i=new Error("Cannot use a pool after calling end on the pool");return e?e(i):this.Promise.reject(i)}let r=$d(this.Promise,e),n=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new bo(r.callback)),n;let i=(o,u,c)=>{clearTimeout(s),r.callback(o,u,c)},a=new bo(i),s=setTimeout(()=>{PO(this._pendingQueue,o=>o.callback===i),a.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(a),n}return this.newClient(new bo(r.callback)),n}newClient(e){let r=new this.Client(this.options);this._clients.push(r);let n=AJ(this,r);this.log("checking client timeout");let i,a=!1;this.options.connectionTimeoutMillis&&(i=setTimeout(()=>{this.log("ending client due to timeout"),a=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(s=>{if(i&&clearTimeout(i),r.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==r),a&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,CO);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(c=>c.client===r)!==-1&&this._acquireClient(r,new bo((c,f,m)=>m()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),r.once("end",()=>clearTimeout(o))}return this._acquireClient(r,e,n,!0)}})}_acquireClient(e,r,n,i){i&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),r.timedOut?i&&this.options.verify?this.options.verify(e,e.release):e.release():i&&this.options.verify?this.options.verify(e,a=>{if(a)return e.release(a),r.callback(a,void 0,CO);r.callback(void 0,e,e.release)}):r.callback(void 0,e,e.release)}_releaseOnce(e,r){let n=!1;return i=>{n&&EJ(),n=!0,this._release(e,r,i)}}_release(e,r,n){if(e.on("error",r),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let a;this.options.idleTimeoutMillis&&this._isAboveMin()&&(a=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&a.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new uv(e,r,a)),this._pulseQueue()}query(e,r,n){if(typeof e=="function"){let a=$d(this.Promise,e);return setImmediate(function(){return a.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),a.result}typeof r=="function"&&(n=r,r=void 0);let i=$d(this.Promise,n);return n=i.callback,this.connect((a,s)=>{if(a)return n(a);let o=!1,u=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",u),this.log("dispatching query");try{s.query(e,r,(c,f)=>{if(this.log("query dispatched"),s.removeListener("error",u),!o)return o=!0,s.release(c),c?n(c):n(void 0,f)})}catch(c){return s.release(c),n(c)}}),i.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let r=$d(this.Promise,e);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,r)=>e+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}};TO.exports=lv});var NO=E((_ne,RO)=>{"use strict";var kO=require("events").EventEmitter,CJ=require("util"),dv=fo(),xo=RO.exports=function(t,e,r){kO.call(this),t=dv.normalizeQueryConfig(t,e,r),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};CJ.inherits(xo,kO);var PJ={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};xo.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let r in e){let n=PJ[r]||r;t[n]=e[r]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};xo.prototype.then=function(t,e){return this._getPromise().then(t,e)};xo.prototype.catch=function(t){return this._getPromise().catch(t)};xo.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};xo.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let r=function(n,i,a){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(a.length>1?i.forEach((s,o)=>{s.forEach(u=>{e.emit("row",u,a[o])})}):i.forEach(function(s){e.emit("row",s,a)})),e.state="end",e.emit("end",a),e.callback&&e.callback(null,a)};if(process.domain&&(r=process.domain.bind(r)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(dv.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let i=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return r(i)}return t.native.execute(this.name,n,r)}return t.native.prepare(this.name,this.text,n.length,function(i){return i?r(i):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,r))})}else if(this.values){if(!Array.isArray(this.values)){let i=new Error("Query values must be an array");return r(i)}let n=this.values.map(dv.prepareValue);t.native.query(this.text,n,r)}else this.queryMode==="extended"?t.native.query(this.text,[],r):t.native.query(this.text,r)}});var DO=E((Sne,FO)=>{"use strict";var OO;try{OO=require("pg-native")}catch(t){throw t}var TJ=Ad(),jO=require("events").EventEmitter,IJ=require("util"),kJ=ky(),$O=NO(),_r=FO.exports=function(t){jO.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new TJ(t.types),this.native=new OO({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new kJ(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};_r.Query=$O;IJ.inherits(_r,jO);_r.prototype._errorAllQueries=function(t){let e=r=>{process.nextTick(()=>{r.native=this.native,r.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};_r.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(r,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),r)return t(r);e.native.connect(n,function(i){if(i)return e.native.end(),t(i);e._connected=!0,e.native.on("error",function(a){e._queryable=!1,e._errorAllQueries(a),e.emit("error",a)}),e.native.on("notification",function(a){e.emit("notification",{channel:a.relname,payload:a.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};_r.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,r)=>{this._connect(n=>{n?r(n):e()})})};_r.prototype.query=function(t,e,r){let n,i,a,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")a=t.query_timeout||this.connectionParameters.query_timeout,i=n=t,typeof e=="function"&&(t.callback=e);else if(a=t.query_timeout||this.connectionParameters.query_timeout,n=new $O(t,e,r),!n.callback){let u,c;i=new this._Promise((f,m)=>{u=f,c=m}).catch(f=>{throw Error.captureStackTrace(f),f}),n.callback=(f,m)=>f?c(f):u(m)}return a&&(o=n.callback,s=setTimeout(()=>{let u=new Error("Query read timeout");process.nextTick(()=>{n.handleError(u,this.connection)}),o(u),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},a),n.callback=(u,c)=>{clearTimeout(s),o(u,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),i):(this._queryQueue.push(n),this._pulseQueryQueue(),i):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),i)};_r.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let r;return t||(r=new this._Promise(function(n,i){t=a=>a?i(a):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),r};_r.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};_r.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let r=this;e.once("_done",function(){r._pulseQueryQueue()})};_r.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};_r.prototype.ref=function(){};_r.prototype.unref=function(){};_r.prototype.setTypeParser=function(t,e,r){return this._types.setTypeParser(t,e,r)};_r.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var fv=E((Ene,MO)=>{"use strict";MO.exports=DO()});var pv=E((Cne,Bu)=>{"use strict";var RJ=AO(),NJ=Mu(),OJ=iv(),jJ=Ny(),$J=fo(),FJ=IO(),DJ=Ad(),{DatabaseError:MJ}=tv(),{escapeIdentifier:qJ,escapeLiteral:LJ}=fo(),BJ=t=>class extends FJ{constructor(r){super(r,t)}},mv=function(t){this.defaults=NJ,this.Client=t,this.Query=this.Client.Query,this.Pool=BJ(this.Client),this._pools=[],this.Connection=OJ,this.types=Du(),this.DatabaseError=MJ,this.TypeOverrides=DJ,this.escapeIdentifier=qJ,this.escapeLiteral=LJ,this.Result=jJ,this.utils=$J};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Bu.exports=new mv(fv()):(Bu.exports=new mv(RJ),Object.defineProperty(Bu.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new mv(fv())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Bu.exports,"native",{value:t}),t}}))});var kr,Pne,Tne,Ine,kne,Rne,Nne,One,jne,$ne,Fne,Dne,Ci,Fd=S(()=>{kr=er(pv(),1),Pne=kr.default.Client,Tne=kr.default.Pool,Ine=kr.default.Connection,kne=kr.default.types,Rne=kr.default.Query,Nne=kr.default.DatabaseError,One=kr.default.escapeIdentifier,jne=kr.default.escapeLiteral,$ne=kr.default.Result,Fne=kr.default.TypeOverrides,Dne=kr.default.defaults,Ci=kr.default});function F(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,_))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(_ in r&&r[_]===e[_])return!0;r=Object.getPrototypeOf(r)}return!1}var _,qne,H=S(()=>{_=Symbol.for("drizzle:entityKind"),qne=Symbol.for("drizzle:hasOwnEntityKind")});var hv,Dd,Md,qd=S(()=>{H();hv=class{static[_]="ConsoleLogWriter";write(e){console.log(e)}},Dd=class{static[_]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new hv}logQuery(e,r){let n=r.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),i=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${i}`)}},Md=class{static[_]="NoopLogger";logQuery(){}}});var nr,Ln=S(()=>{H();nr=class{static[_]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}then(e,r){return this.execute().then(e,r)}}});var De,yn=S(()=>{H();De=class{constructor(e,r){this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}static[_]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}});var Ld,gv=S(()=>{H();Ld=class{static[_]="ColumnBuilder";config;constructor(e,r,n){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}});var tn,Bd=S(()=>{tn=Symbol.for("drizzle:Name")});var Ud,yv,vv=S(()=>{H();Bd();Ud=class{static[_]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,r){this.reference=()=>{let{name:n,columns:i,foreignColumns:a}=e();return{name:n,columns:i,foreignTable:a[0].table,foreignColumns:a}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new yv(e,this)}},yv=class{constructor(e,r){this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}static[_]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:r,foreignColumns:n}=this.reference(),i=r.map(o=>o.name),a=n.map(o=>o.name),s=[this.table[tn],...i,n[0].table[tn],...a];return e??`${s.join("_")}_fk`}}});function Vd(t,...e){return t(...e)}var bv=S(()=>{});function _v(t,e){return`${t[tn]}_${e.join("_")}_unique`}var xv,qO,wv,Sv=S(()=>{H();Bd();xv=class{constructor(e,r){this.name=r,this.columns=e}static[_]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new wv(e,this.columns,this.nullsNotDistinctConfig,this.name)}},qO=class{static[_]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new xv(e,this.name)}},wv=class{constructor(e,r,n,i){this.table=e,this.columns=r,this.name=i??_v(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=n}static[_]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}});function LO(t,e,r){for(let n=e;n<t.length;n++){let i=t[n];if(i==="\\"){n++;continue}if(i==='"')return[t.slice(e,n).replace(/\\/g,""),n+1];if(!r&&(i===","||i==="}"))return[t.slice(e,n).replace(/\\/g,""),n]}return[t.slice(e).replace(/\\/g,""),t.length]}function BO(t,e=0){let r=[],n=e,i=!1;for(;n<t.length;){let a=t[n];if(a===","){(i||n===e)&&r.push(""),i=!0,n++;continue}if(i=!1,a==="\\"){n+=2;continue}if(a==='"'){let[u,c]=LO(t,n+1,!0);r.push(u),n=c;continue}if(a==="}")return[r,n+1];if(a==="{"){let[u,c]=BO(t,n+1);r.push(u),n=c;continue}let[s,o]=LO(t,n,!1);r.push(s),n=o}return[r,n]}function UO(t){let[e]=BO(t,1);return e}function Ev(t){return`{${t.map(e=>Array.isArray(e)?Ev(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Av=S(()=>{});var re,z,Cv,wo,Pv,Tv,Pe=S(()=>{gv();yn();H();vv();bv();Sv();Av();re=class extends Ld{foreignKeyConfigs=[];static[_]="PgColumnBuilder";array(e){return new Pv(this.config.name,this,e)}references(e,r={}){return this.foreignKeyConfigs.push({ref:e,actions:r}),this}unique(e,r){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=r?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,r){return this.foreignKeyConfigs.map(({ref:n,actions:i})=>Vd((a,s)=>{let o=new Ud(()=>{let u=a();return{columns:[e],foreignColumns:[u]}});return s.onUpdate&&o.onUpdate(s.onUpdate),s.onDelete&&o.onDelete(s.onDelete),o.build(r)},n,i))}buildExtraConfigColumn(e){return new Cv(e,this.config)}},z=class extends De{constructor(e,r){r.uniqueName||(r.uniqueName=_v(e,[r.name])),super(e,r),this.table=e}static[_]="PgColumn"},Cv=class extends z{static[_]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},wo=class{static[_]="IndexedColumn";constructor(e,r,n,i){this.name=e,this.keyAsName=r,this.type=n,this.indexConfig=i}name;keyAsName;type;indexConfig},Pv=class extends re{static[_]="PgArrayBuilder";constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){let r=this.config.baseBuilder.build(e);return new Tv(e,this.config,r)}},Tv=class t extends z{constructor(e,r,n,i){super(e,r),this.baseColumn=n,this.range=i,this.size=r.size}size;static[_]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=UO(e)),e.map(r=>this.baseColumn.mapFromDriverValue(r))}mapToDriverValue(e,r=!1){let n=e.map(i=>i===null?null:F(this.baseColumn,t)?this.baseColumn.mapToDriverValue(i,!0):this.baseColumn.mapToDriverValue(i));return r?n:Ev(n)}}});function VO(t){return!!t&&typeof t=="function"&&Iv in t&&t[Iv]===!0}function zO(t,e,r){let n=Object.assign(i=>new kv(i??"",n),{enumName:t,enumValues:e,schema:r,[Iv]:!0});return n}var Iv,kv,Rv,zd=S(()=>{H();Pe();Iv=Symbol.for("drizzle:isPgEnum");kv=class extends re{static[_]="PgEnumColumnBuilder";constructor(e,r){super(e,"string","PgEnumColumn"),this.config.enum=r}build(e){return new Rv(e,this.config)}},Rv=class extends z{static[_]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,r){super(e,r),this.enum=r.enum}getSQLType(){return this.enum.enumName}}});var Tt,_o,vn=S(()=>{H();Tt=class{static[_]="Subquery";constructor(e,r,n,i=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:i}}},_o=class extends Tt{static[_]="WithSubquery"}});var HO,QO=S(()=>{HO="0.39.3"});var Nv,Ov,tt,Bn=S(()=>{bv();QO();tt={startActiveSpan(t,e){return Nv?(Ov||(Ov=Nv.trace.getTracer("drizzle-orm",HO)),Vd((r,n)=>n.startActiveSpan(t,i=>{try{return e(i)}catch(a){throw i.setStatus({code:r.SpanStatusCode.ERROR,message:a instanceof Error?a.message:"Unknown error"}),a}finally{i.end()}}),Nv,Ov)):e()}}});var rt,Un=S(()=>{rt=Symbol.for("drizzle:ViewBaseConfig")});function Fv(t){return typeof t=="object"&&t!==null&&GO in t}function Sr(t){return t[tn]}function Da(t){return`${t[Hd]??"public"}.${t[tn]}`}var Hd,Qd,WO,jv,$v,Uu,KO,GO,K,Er=S(()=>{H();Bd();Hd=Symbol.for("drizzle:Schema"),Qd=Symbol.for("drizzle:Columns"),WO=Symbol.for("drizzle:ExtraConfigColumns"),jv=Symbol.for("drizzle:OriginalName"),$v=Symbol.for("drizzle:BaseName"),Uu=Symbol.for("drizzle:IsAlias"),KO=Symbol.for("drizzle:ExtraConfigBuilder"),GO=Symbol.for("drizzle:IsDrizzleTable"),K=class{static[_]="Table";static Symbol={Name:tn,Schema:Hd,OriginalName:jv,Columns:Qd,ExtraConfigColumns:WO,BaseName:$v,IsAlias:Uu,ExtraConfigBuilder:KO};[tn];[jv];[Hd];[Qd];[WO];[$v];[Uu]=!1;[GO]=!0;[KO]=void 0;constructor(e,r,n){this[tn]=this[jv]=e,this[Hd]=r,this[$v]=n}}});function Dv(t){return t!=null&&typeof t.getSQL=="function"}function UJ(t){let e={sql:"",params:[]};for(let r of t)e.sql+=r.sql,e.params.push(...r.params),r.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...r.typings));return e}function YO(t){return typeof t=="object"&&t!==null&&"mapToDriverValue"in t&&typeof t.mapToDriverValue=="function"}function y(t,...e){let r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new It(t[0]));for(let[n,i]of e.entries())r.push(i,new It(t[n+1]));return new G(r)}function Mv(t,e){return t.map(r=>{if(F(r,Vn)){if(!(r.name in e))throw new Error(`No value for placeholder "${r.name}" was provided`);return e[r.name]}if(F(r,Ar)&&F(r.value,Vn)){if(!(r.value.name in e))throw new Error(`No value for placeholder "${r.value.name}" was provided`);return r.encoder.mapToDriverValue(e[r.value.name])}return r})}function tj(t){return typeof t=="object"&&t!==null&&ej in t}var JO,It,G,Vu,XO,ZO,Nie,Ar,Vn,ej,mr,kt=S(()=>{H();zd();vn();Bn();Un();yn();Er();JO=class{static[_]="FakePrimitiveParam"};It=class{static[_]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new G([this])}},G=class t{constructor(e){this.queryChunks=e}static[_]="SQL";decoder=XO;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return tt.startActiveSpan("drizzle.buildSQL",r=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return r?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){let n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:i,escapeName:a,escapeParam:s,prepareTyping:o,inlineParams:u,paramStartIndex:c}=n;return UJ(e.map(f=>{if(F(f,It))return{sql:f.value.join(""),params:[]};if(F(f,Vu))return{sql:a(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let m=[new It("(")];for(let[l,p]of f.entries())m.push(p),l<f.length-1&&m.push(new It(", "));return m.push(new It(")")),this.buildQueryFromSourceParams(m,n)}if(F(f,t))return this.buildQueryFromSourceParams(f.queryChunks,{...n,inlineParams:u||f.shouldInlineParams});if(F(f,K)){let m=f[K.Symbol.Schema],l=f[K.Symbol.Name];return{sql:m===void 0||f[Uu]?a(l):a(m)+"."+a(l),params:[]}}if(F(f,De)){let m=i.getColumnCasing(f);if(r.invokeSource==="indexes")return{sql:a(m),params:[]};let l=f.table[K.Symbol.Schema];return{sql:f.table[Uu]||l===void 0?a(f.table[K.Symbol.Name])+"."+a(m):a(l)+"."+a(f.table[K.Symbol.Name])+"."+a(m),params:[]}}if(F(f,mr)){let m=f[rt].schema,l=f[rt].name;return{sql:m===void 0||f[rt].isAlias?a(l):a(m)+"."+a(l),params:[]}}if(F(f,Ar)){if(F(f.value,Vn))return{sql:s(c.value++,f),params:[f],typings:["none"]};let m=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(F(m,t))return this.buildQueryFromSourceParams([m],n);if(u)return{sql:this.mapInlineParam(m,n),params:[]};let l=["none"];return o&&(l=[o(f.encoder)]),{sql:s(c.value++,m),params:[m],typings:l}}return F(f,Vn)?{sql:s(c.value++,f),params:[f],typings:["none"]}:F(f,t.Aliased)&&f.fieldAlias!==void 0?{sql:a(f.fieldAlias),params:[]}:F(f,Tt)?f._.isWith?{sql:a(f._.alias),params:[]}:this.buildQueryFromSourceParams([new It("("),f._.sql,new It(") "),new Vu(f._.alias)],n):VO(f)?f.schema?{sql:a(f.schema)+"."+a(f.enumName),params:[]}:{sql:a(f.enumName),params:[]}:Dv(f)?f.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([f.getSQL()],n):this.buildQueryFromSourceParams([new It("("),f.getSQL(),new It(")")],n):u?{sql:this.mapInlineParam(f,n),params:[]}:{sql:s(c.value++,f),params:[f],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){let n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new t.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Vu=class{constructor(e){this.value=e}static[_]="Name";brand;getSQL(){return new G([this])}};XO={mapFromDriverValue:t=>t},ZO={mapToDriverValue:t=>t},Nie={...XO,...ZO},Ar=class{constructor(e,r=ZO){this.value=e,this.encoder=r}static[_]="Param";brand;getSQL(){return new G([this])}};(t=>{function e(){return new G([])}t.empty=e;function r(u){return new G(u)}t.fromList=r;function n(u){return new G([new It(u)])}t.raw=n;function i(u,c){let f=[];for(let[m,l]of u.entries())m>0&&c!==void 0&&f.push(c),f.push(l);return new G(f)}t.join=i;function a(u){return new Vu(u)}t.identifier=a;function s(u){return new Vn(u)}t.placeholder=s;function o(u,c){return new Ar(u,c)}t.param=o})(y||(y={}));(t=>{class e{constructor(n,i){this.sql=n,this.fieldAlias=i}static[_]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}t.Aliased=e})(G||(G={}));Vn=class{constructor(e){this.name=e}static[_]="Placeholder";getSQL(){return new G([this])}};ej=Symbol.for("drizzle:IsDrizzleView"),mr=class{static[_]="View";[rt];[ej]=!0;constructor({name:e,schema:r,selectedFields:n,query:i}){this[rt]={name:e,originalName:e,schema:r,selectedFields:n,query:i,isExisting:!i,isAlias:!1}}getSQL(){return new G([this])}};De.prototype.getSQL=function(){return new G([this])};K.prototype.getSQL=function(){return new G([this])};Tt.prototype.getSQL=function(){return new G([this])}});function zu(t,e){return new Proxy(t,new So(e,!1))}function bn(t,e){return new Proxy(t,new Ma(new Proxy(t.table,new So(e,!1))))}function qv(t,e){return new G.Aliased(Hu(t.sql,e),t.fieldAlias)}function Hu(t,e){return y.join(t.queryChunks.map(r=>F(r,De)?bn(r,e):F(r,G)?Hu(r,e):F(r,G.Aliased)?qv(r,e):r))}var Ma,So,rj,Wd=S(()=>{yn();H();kt();Er();Un();Ma=class{constructor(e){this.table=e}static[_]="ColumnAliasProxyHandler";get(e,r){return r==="table"?this.table:e[r]}},So=class{constructor(e,r){this.alias=e,this.replaceOriginalName=r}static[_]="TableAliasProxyHandler";get(e,r){if(r===K.Symbol.IsAlias)return!0;if(r===K.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===K.Symbol.OriginalName)return this.alias;if(r===rt)return{...e[rt],name:this.alias,isAlias:!0};if(r===K.Symbol.Columns){let i=e[K.Symbol.Columns];if(!i)return i;let a={};return Object.keys(i).map(s=>{a[s]=new Proxy(i[s],new Ma(new Proxy(e,this)))}),a}let n=e[r];return F(n,De)?new Proxy(n,new Ma(new Proxy(e,this))):n}},rj=class{constructor(e){this.alias=e}static[_]="RelationTableAliasProxyHandler";get(e,r){return r==="sourceTable"?zu(e.sourceTable,this.alias):e[r]}}});var Ge,Pi=S(()=>{Wd();yn();H();kt();vn();Un();Ge=class t{static[_]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,r){if(r==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(r===rt)return{...e[rt],selectedFields:new Proxy(e[rt].selectedFields,this)};if(typeof r=="symbol")return e[r];let i=(F(e,Tt)?e._.selectedFields:F(e,mr)?e[rt].selectedFields:e)[r];if(F(i,G.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!i.isSelectionField)return i.sql;let a=i.clone();return a.isSelectionField=!0,a}if(F(i,G)){if(this.config.sqlBehavior==="sql")return i;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return F(i,De)?this.config.alias?new Proxy(i,new Ma(new Proxy(i.table,new So(this.config.alias,this.config.replaceOriginalName??!1)))):i:typeof i!="object"||i===null?i:new Proxy(i,new t(this.config))}}});function nj(t,e,r){let n={},i=t.reduce((a,{path:s,field:o},u)=>{let c;F(o,De)?c=o:F(o,G)?c=o.decoder:c=o.sql.decoder;let f=a;for(let[m,l]of s.entries())if(m<s.length-1)l in f||(f[l]={}),f=f[l];else{let p=e[u],d=f[l]=p===null?null:c.mapFromDriverValue(p);if(r&&F(o,De)&&s.length===2){let h=s[0];h in n?typeof n[h]=="string"&&n[h]!==Sr(o.table)&&(n[h]=!1):n[h]=d===null?Sr(o.table):!1}}return a},{});if(r&&Object.keys(n).length>0)for(let[a,s]of Object.entries(n))typeof s=="string"&&!r[s]&&(i[a]=null);return i}function Qr(t,e){return Object.entries(t).reduce((r,[n,i])=>{if(typeof n!="string")return r;let a=e?[...e,n]:[n];return F(i,De)||F(i,G)||F(i,G.Aliased)?r.push({path:a,field:i}):F(i,K)?r.push(...Qr(i[K.Symbol.Columns],a)):r.push(...Qr(i,a)),r},[])}function Qu(t,e){let r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let[i,a]of r.entries())if(a!==n[i])return!1;return!0}function Kd(t,e){let r=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,i])=>F(i,G)||F(i,De)?[n,i]:[n,new Ar(i,t[K.Symbol.Columns][n])]);if(r.length===0)throw new Error("No values to set");return Object.fromEntries(r)}function ij(t,e){for(let r of e)for(let n of Object.getOwnPropertyNames(r.prototype))n!=="constructor"&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(r.prototype,n)||Object.create(null))}function qa(t){return t[K.Symbol.Columns]}function aj(t){return t[rt].selectedFields}function zn(t){return F(t,Tt)?t._.alias:F(t,mr)?t[rt].name:F(t,G)?void 0:t[K.Symbol.IsAlias]?t[K.Symbol.Name]:t[K.Symbol.BaseName]}function ke(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}function sj(t){if(typeof t!="object"||t===null||t.constructor.name!=="Object")return!1;if("logger"in t){let e=typeof t.logger;return!(e!=="boolean"&&(e!=="object"||typeof t.logger.logQuery!="function")&&e!=="undefined")}if("schema"in t){let e=typeof t.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in t){let e=typeof t.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in t)return!(t.mode!=="default"||t.mode!=="planetscale"||t.mode!==void 0);if("connection"in t){let e=typeof t.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in t){let e=typeof t.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(t).length===0}var Je=S(()=>{yn();H();kt();vn();Er();Un()});var Wu,oj=S(()=>{H();Ln();Pi();Er();Bn();Je();Wu=class extends nr{constructor(e,r,n,i){super(),this.session=r,this.dialect=n,this.config={table:e,withList:i}}static[_]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[K.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Qr(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return tt.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>tt.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Ge({alias:Sr(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}});function VJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(r=>r.toLowerCase()).join("_")}function zJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((r,n,i)=>{let a=i===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return r+a},"")}function HJ(t){return t}var Gd,cj=S(()=>{H();Er();Gd=class{static[_]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?VJ:e==="camelCase"?zJ:HJ}getColumnCasing(e){if(!e.keyAsName)return e.name;let r=e.table[K.Symbol.Schema]??"public",n=e.table[K.Symbol.OriginalName],i=`${r}.${n}.${e.name}`;return this.cache[i]||this.cacheTable(e.table),this.cache[i]}cacheTable(e){let r=e[K.Symbol.Schema]??"public",n=e[K.Symbol.OriginalName],i=`${r}.${n}`;if(!this.cachedTables[i]){for(let a of Object.values(e[K.Symbol.Columns])){let s=`${i}.${a.name}`;this.cache[s]=this.convert(a.name)}this.cachedTables[i]=!0}}clearCache(){this.cache={},this.cachedTables={}}}});var Ku,Jd,Yd=S(()=>{H();Ku=class extends Error{static[_]="DrizzleError";constructor({message:e,cause:r}){super(e),this.name="DrizzleError",this.cause=r}},Jd=class extends Ku{static[_]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}});var Hn,Gu=S(()=>{H();Pe();Hn=class extends re{static[_]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}});function Ju(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Lv(r):new Uv(r)}var Lv,Bv,Uv,Vv,zv=S(()=>{H();Je();Pe();Gu();Lv=class extends Hn{static[_]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Bv(e,this.config)}},Bv=class extends z{static[_]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Uv=class extends Hn{static[_]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Vv(e,this.config)}},Vv=class extends z{static[_]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}});function uj(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Hv(r):new Wv(r)}var Hv,Qv,Wv,Kv,Gv=S(()=>{H();Je();Pe();Hv=class extends re{static[_]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Qv(e,this.config)}},Qv=class extends z{static[_]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Wv=class extends re{static[_]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Kv(e,this.config)}},Kv=class extends z{static[_]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}});function Ti(t){return new Jv(t??"")}var Jv,Yv,Xv=S(()=>{H();Pe();Jv=class extends re{static[_]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Yv(e,this.config)}},Yv=class extends z{static[_]="PgBoolean";getSQLType(){return"boolean"}}});function lj(t,e={}){let{name:r,config:n}=ke(t,e);return new Zv(r,n)}var Zv,eb,tb=S(()=>{H();Je();Pe();Zv=class extends re{static[_]="PgCharBuilder";constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new eb(e,this.config)}},eb=class extends z{static[_]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}});function pj(t){return new rb(t??"")}var rb,nb,ib=S(()=>{H();Pe();rb=class extends re{static[_]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new nb(e,this.config)}},nb=class extends z{static[_]="PgCidr";getSQLType(){return"cidr"}}});function dj(t){return(e,r)=>{let{name:n,config:i}=ke(e,r);return new ab(n,i,t)}}var ab,sb,ob=S(()=>{H();Je();Pe();ab=class extends re{static[_]="PgCustomColumnBuilder";constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new sb(e,this.config)}},sb=class extends z{static[_]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,r){super(e,r),this.sqlName=r.customTypeParams.dataType(r.fieldConfig),this.mapTo=r.customTypeParams.toDriver,this.mapFrom=r.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}});var xn,Xd=S(()=>{H();kt();Pe();xn=class extends re{static[_]="PgDateColumnBaseBuilder";defaultNow(){return this.default(y`now()`)}}});function fj(t,e){let{name:r,config:n}=ke(t,e);return n?.mode==="date"?new cb(r):new ub(r)}var cb,Yu,ub,Xu,lb=S(()=>{H();Je();Pe();Xd();cb=class extends xn{static[_]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Yu(e,this.config)}},Yu=class extends z{static[_]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},ub=class extends xn{static[_]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Xu(e,this.config)}},Xu=class extends z{static[_]="PgDateString";getSQLType(){return"date"}}});function mj(t){return new pb(t??"")}var pb,db,fb=S(()=>{H();Pe();pb=class extends re{static[_]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new db(e,this.config)}},db=class extends z{static[_]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}});function hj(t){return new mb(t??"")}var mb,hb,gb=S(()=>{H();Pe();mb=class extends re{static[_]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new hb(e,this.config)}},hb=class extends z{static[_]="PgInet";getSQLType(){return"inet"}}});function Z(t){return new yb(t??"")}var yb,vb,bb=S(()=>{H();Pe();Gu();yb=class extends Hn{static[_]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new vb(e,this.config)}},vb=class extends z{static[_]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}});function gj(t,e={}){let{name:r,config:n}=ke(t,e);return new xb(r,n)}var xb,wb,_b=S(()=>{H();Je();Pe();xb=class extends re{static[_]="PgIntervalBuilder";constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new wb(e,this.config)}},wb=class extends z{static[_]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",r=this.precision?`(${this.precision})`:"";return`interval${e}${r}`}}});function yj(t){return new Sb(t??"")}var Sb,Zu,Eb=S(()=>{H();Pe();Sb=class extends re{static[_]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Zu(e,this.config)}},Zu=class extends z{static[_]="PgJson";constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function Qe(t){return new Ab(t??"")}var Ab,el,Cb=S(()=>{H();Pe();Ab=class extends re{static[_]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new el(e,this.config)}},el=class extends z{static[_]="PgJsonb";constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function vj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Pb(r):new Ib(r)}var Pb,Tb,Ib,kb,Rb=S(()=>{H();Je();Pe();Pb=class extends re{static[_]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Tb(e,this.config)}},Tb=class extends z{static[_]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(i)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Ib=class extends re{static[_]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new kb(e,this.config)}},kb=class extends z{static[_]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(i)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}});function bj(t){return new Nb(t??"")}var Nb,Ob,jb=S(()=>{H();Pe();Nb=class extends re{static[_]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new Ob(e,this.config)}},Ob=class extends z{static[_]="PgMacaddr";getSQLType(){return"macaddr"}}});function xj(t){return new $b(t??"")}var $b,Fb,Db=S(()=>{H();Pe();$b=class extends re{static[_]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Fb(e,this.config)}},Fb=class extends z{static[_]="PgMacaddr8";getSQLType(){return"macaddr8"}}});function qb(t,e){let{name:r,config:n}=ke(t,e);return new Mb(r,n?.precision,n?.scale)}var Mb,tl,Kt,Lb=S(()=>{H();Je();Pe();Mb=class extends re{static[_]="PgNumericBuilder";constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new tl(e,this.config)}},tl=class extends z{static[_]="PgNumeric";precision;scale;constructor(e,r){super(e,r),this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Kt=qb});function wj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Bb(r):new Vb(r)}var Bb,Ub,Vb,zb,Hb=S(()=>{H();Je();Pe();Bb=class extends re{static[_]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Ub(e,this.config)}},Ub=class extends z{static[_]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Vb=class extends re{static[_]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new zb(e,this.config)}},zb=class extends z{static[_]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}});function QJ(t){let e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function _j(t,e){let r=new ArrayBuffer(8),n=new DataView(r);for(let i=0;i<8;i++)n.setUint8(i,t[e+i]);return n.getFloat64(0,!0)}function Qb(t){let e=QJ(t),r=0,n=e[r];r+=1;let i=new DataView(e.buffer),a=i.getUint32(r,n===1);r+=4;let s;if(a&536870912&&(s=i.getUint32(r,n===1),r+=4),(a&65535)===1){let o=_j(e,r);r+=8;let u=_j(e,r);return r+=8,[o,u]}throw new Error("Unsupported geometry type")}var Sj=S(()=>{});function Ej(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Wb(r):new Gb(r)}var Wb,Kb,Gb,Jb,Yb=S(()=>{H();Je();Pe();Sj();Wb=class extends re{static[_]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new Kb(e,this.config)}},Kb=class extends z{static[_]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Qb(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},Gb=class extends re{static[_]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new Jb(e,this.config)}},Jb=class extends z{static[_]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let r=Qb(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}});function Aj(t){return new Xb(t??"")}var Xb,Zb,ex=S(()=>{H();Pe();Xb=class extends re{static[_]="PgRealBuilder";constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new Zb(e,this.config)}},Zb=class extends z{static[_]="PgReal";constructor(e,r){super(e,r)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}});function Ye(t){return new tx(t??"")}var tx,rx,nx=S(()=>{H();Pe();tx=class extends re{static[_]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new rx(e,this.config)}},rx=class extends z{static[_]="PgSerial";getSQLType(){return"serial"}}});function Cj(t){return new ix(t??"")}var ix,ax,sx=S(()=>{H();Pe();Gu();ix=class extends Hn{static[_]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new ax(e,this.config)}},ax=class extends z{static[_]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}});function Pj(t){return new ox(t??"")}var ox,cx,ux=S(()=>{H();Pe();ox=class extends re{static[_]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new cx(e,this.config)}},cx=class extends z{static[_]="PgSmallSerial";getSQLType(){return"smallserial"}}});function $(t,e={}){let{name:r,config:n}=ke(t,e);return new lx(r,n)}var lx,px,dx=S(()=>{H();Je();Pe();lx=class extends re{static[_]="PgTextBuilder";constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new px(e,this.config)}},px=class extends z{static[_]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}});function Tj(t,e={}){let{name:r,config:n}=ke(t,e);return new fx(r,n.withTimezone??!1,n.precision)}var fx,rl,mx=S(()=>{H();Je();Pe();Xd();fx=class extends xn{constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}static[_]="PgTimeBuilder";build(e){return new rl(e,this.config)}},rl=class extends z{static[_]="PgTime";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function we(t,e={}){let{name:r,config:n}=ke(t,e);return n?.mode==="string"?new gx(r,n.withTimezone??!1,n.precision):new hx(r,n?.withTimezone??!1,n?.precision)}var hx,nl,gx,il,yx=S(()=>{H();Je();Pe();Xd();hx=class extends xn{static[_]="PgTimestampBuilder";constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new nl(e,this.config)}},nl=class extends z{static[_]="PgTimestamp";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},gx=class extends xn{static[_]="PgTimestampStringBuilder";constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new il(e,this.config)}},il=class extends z{static[_]="PgTimestampString";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function Ij(t){return new vx(t??"")}var vx,al,bx=S(()=>{H();kt();Pe();vx=class extends re{static[_]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(y`gen_random_uuid()`)}build(e){return new al(e,this.config)}},al=class extends z{static[_]="PgUUID";getSQLType(){return"uuid"}}});function Gt(t,e={}){let{name:r,config:n}=ke(t,e);return new xx(r,n)}var xx,wx,_x=S(()=>{H();Je();Pe();xx=class extends re{static[_]="PgVarcharBuilder";constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new wx(e,this.config)}},wx=class extends z{static[_]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}});function kj(t,e){let{name:r,config:n}=ke(t,e);return new Sx(r,n)}var Sx,Ex,Ax=S(()=>{H();Je();Pe();Sx=class extends re{static[_]="PgBinaryVectorBuilder";constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new Ex(e,this.config)}},Ex=class extends z{static[_]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}});function Rj(t,e){let{name:r,config:n}=ke(t,e);return new Cx(r,n)}var Cx,Px,Tx=S(()=>{H();Je();Pe();Cx=class extends re{static[_]="PgHalfVectorBuilder";constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){returIPv4 resolution failed, using original URL: Error: getaddrinfo ENOTFOUND db.epbxctcwmtsuxdgxkgdz.supabase.co
2026-Jan-18 17:01:11.213393 at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:111:26) {
2026-Jan-18 17:01:11.213393 errno: -3007,
2026-Jan-18 17:01:11.213393 code: 'ENOTFOUND',
2026-Jan-18 17:01:11.213393 syscall: 'getaddrinfo',
2026-Jan-18 17:01:11.213393 hostname: 'db.epbxctcwmtsuxdgxkgdz.supabase.co'
2026-Jan-18 17:01:11.213393 }
2026-Jan-18 17:01:11.213393 /app/dist/index.cjs:67
2026-Jan-18 17:01:11.213393 `);Lu.write(vO.format.apply(vO,e))}}Object.defineProperty(qn.exports,"isWin",{get:function(){return Nd},set:function(t){Nd=t}});qn.exports.warnTo=function(t){var e=Lu;return Lu=t,e};qn.exports.getFileName=function(t){var e=t||process.env,r=e.PGPASSFILE||(Nd?yO.join(e.APPDATA||"./","postgresql","pgpass.conf"):yO.join(e.HOME||"./",".pgpass"));return r};qn.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Nd?!0:(e=e||"<unkn>",dJ(t.mode)?t.mode&(cJ|uJ)?(sv('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(sv('WARNING: password file "%s" is not a plain file',e),!1))};var mJ=qn.exports.match=function(t,e){return vo.slice(0,-1).reduce(function(r,n,i){return i==1&&Number(t[n]||oJ)===Number(e[n])?r&&!0:r&&(e[n]==="*"||e[n]===t[n])},!0)};qn.exports.getPassword=function(t,e,r){var n,i=e.pipe(sJ());function a(u){var c=hJ(u);c&&gJ(c)&&mJ(t,c)&&(n=c[fJ],i.end())}var s=function(){e.destroy(),r(n)},o=function(u){e.destroy(),sv("WARNING: error on reading file: %s",u),r(void 0)};e.on("error",o),i.on("data",a).on("end",s).on("error",o)};var hJ=qn.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",r="",n=0,i=0,a=0,s={},o=!1,u=function(f,m,l){var p=t.substring(m,l);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(p=p.replace(/\\([:\\])/g,"$1")),s[vo[f]]=p},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),r=t.charAt(c),o=n==av-1,o){u(n,i);break}c>=0&&e==":"&&r!=="\\"&&(u(n,i,c+1),i=c+2,n+=1)}return s=Object.keys(s).length===av?s:null,s},gJ=qn.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},r=0;r<vo.length;r+=1){var n=e[r],i=t[vo[r]]||"",a=n(i);if(!a)return!1}return!0}});var wO=E((bne,ov)=>{"use strict";var vne=require("path"),xO=require("fs"),Od=bO();ov.exports=function(t,e){var r=Od.getFileName();xO.stat(r,function(n,i){if(n||!Od.usePgPass(i,r))return e(void 0);var a=xO.createReadStream(r);Od.getPassword(t,a,e)})};ov.exports.warnTo=Od.warnTo});var AO=E((xne,EO)=>{"use strict";var yJ=require("events").EventEmitter,_O=fo(),cv=UN(),vJ=Ad(),bJ=ky(),SO=tO(),xJ=Mu(),wJ=iv(),_J=Py(),jd=class extends yJ{constructor(e){super(),this.connectionParameters=new bJ(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let r=e||{};this._Promise=r.Promise||global.Promise,this._types=new vJ(r.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!r.enableChannelBinding,this.connection=r.connection||new wJ({stream:r.stream,ssl:this.connectionParameters.ssl,keepAlive:r.keepAlive||!1,keepAliveInitialDelayMillis:r.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=r.binary||xJ.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=r.connectionTimeoutMillis||0}_errorAllQueries(e){let r=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(r(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(r),this.queryQueue.length=0}_connect(e){let r=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let i=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(i)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){r.ssl?n.requestSsl():n.startup(r.getStartupConf())}),n.on("sslconnect",function(){n.startup(r.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let i=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(i),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(i):this._handleErrorEvent(i):this._connectionError||this._handleErrorEvent(i)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((r,n)=>{this._connect(i=>{i?n(i):r()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let r=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){r.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{r.emit("error",n)});else if(this.password!==null)e();else try{wO()(this.connectionParameters,i=>{i!==void 0&&(this.connectionParameters.password=this.password=i),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let r=await _J.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(r)}catch(r){this.emit("error",r)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=cv.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(r){this.connection.emit("error",r)}})}async _handleAuthSASLContinue(e){try{await cv.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(r){this.connection.emit("error",r)}}_handleAuthSASLFinal(e){try{cv.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(r){this.connection.emit("error",r)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:r}=this;this.activeQuery=null,this.readyForQuery=!0,r&&r.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let r=this.activeQuery;if(!r){this._handleErrorEvent(e);return}this.activeQuery=null,r.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let r=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(r);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,r={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(r.application_name=n),e.replication&&(r.replication=""+e.replication),e.statement_timeout&&(r.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(r.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(r.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(r.options=e.options),r}cancel(e,r){if(e.activeQuery===r){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(r)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(r),1)}setTypeParser(e,r,n){return this._types.setTypeParser(e,r,n)}getTypeParser(e,r){return this._types.getTypeParser(e,r)}escapeIdentifier(e){return _O.escapeIdentifier(e)}escapeLiteral(e){return _O.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,r,n){let i,a,s,o,u;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,a=i=e,typeof r=="function"&&(i.callback=i.callback||r)):(s=e.query_timeout||this.connectionParameters.query_timeout,i=new SO(e,r,n),i.callback||(a=new this._Promise((c,f)=>{i.callback=(m,l)=>m?f(m):c(l)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(u=i.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{i.handleError(c,this.connection)}),u(c),i.callback=()=>{};let f=this.queryQueue.indexOf(i);f>-1&&this.queryQueue.splice(f,1),this._pulseQueryQueue()},s),i.callback=(c,f)=>{clearTimeout(o),u(c,f)}),this.binary&&!i.binary&&(i.binary=!0),i._result&&!i._result._types&&(i._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"),this.connection)}),a):(this.queryQueue.push(i),this._pulseQueryQueue(),a):(process.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),a)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(r=>{this.connection.once("end",r)})}};jd.Query=SO;EO.exports=jd});var IO=E((wne,TO)=>{"use strict";var SJ=require("events").EventEmitter,CO=function(){},PO=(t,e)=>{let r=t.findIndex(e);return r===-1?void 0:t.splice(r,1)[0]},uv=class{constructor(e,r,n){this.client=e,this.idleListener=r,this.timeoutId=n}},bo=class{constructor(e){this.callback=e}};function EJ(){throw new Error("Release called on client which has already been released to the pool.")}function $d(t,e){if(e)return{callback:e,result:void 0};let r,n,i=function(s,o){s?r(s):n(o)},a=new t(function(s,o){n=s,r=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:i,result:a}}function AJ(t,e){return function r(n){n.client=e,e.removeListener("error",r),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var lv=class extends SJ{constructor(e,r){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||pv().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let r=this._idle.pop();clearTimeout(r.timeoutId);let n=r.client;n.ref&&n.ref();let i=r.idleListener;return this._acquireClient(n,e,i,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,r){let n=PO(this._idle,a=>a.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(a=>a!==e);let i=this;e.end(()=>{i.emit("remove",e),typeof r=="function"&&r()})}connect(e){if(this.ending){let i=new Error("Cannot use a pool after calling end on the pool");return e?e(i):this.Promise.reject(i)}let r=$d(this.Promise,e),n=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new bo(r.callback)),n;let i=(o,u,c)=>{clearTimeout(s),r.callback(o,u,c)},a=new bo(i),s=setTimeout(()=>{PO(this._pendingQueue,o=>o.callback===i),a.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(a),n}return this.newClient(new bo(r.callback)),n}newClient(e){let r=new this.Client(this.options);this._clients.push(r);let n=AJ(this,r);this.log("checking client timeout");let i,a=!1;this.options.connectionTimeoutMillis&&(i=setTimeout(()=>{this.log("ending client due to timeout"),a=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(s=>{if(i&&clearTimeout(i),r.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==r),a&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,CO);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(c=>c.client===r)!==-1&&this._acquireClient(r,new bo((c,f,m)=>m()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),r.once("end",()=>clearTimeout(o))}return this._acquireClient(r,e,n,!0)}})}_acquireClient(e,r,n,i){i&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),r.timedOut?i&&this.options.verify?this.options.verify(e,e.release):e.release():i&&this.options.verify?this.options.verify(e,a=>{if(a)return e.release(a),r.callback(a,void 0,CO);r.callback(void 0,e,e.release)}):r.callback(void 0,e,e.release)}_releaseOnce(e,r){let n=!1;return i=>{n&&EJ(),n=!0,this._release(e,r,i)}}_release(e,r,n){if(e.on("error",r),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let a;this.options.idleTimeoutMillis&&this._isAboveMin()&&(a=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&a.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new uv(e,r,a)),this._pulseQueue()}query(e,r,n){if(typeof e=="function"){let a=$d(this.Promise,e);return setImmediate(function(){return a.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),a.result}typeof r=="function"&&(n=r,r=void 0);let i=$d(this.Promise,n);return n=i.callback,this.connect((a,s)=>{if(a)return n(a);let o=!1,u=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",u),this.log("dispatching query");try{s.query(e,r,(c,f)=>{if(this.log("query dispatched"),s.removeListener("error",u),!o)return o=!0,s.release(c),c?n(c):n(void 0,f)})}catch(c){return s.release(c),n(c)}}),i.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let r=$d(this.Promise,e);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,r)=>e+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}};TO.exports=lv});var NO=E((_ne,RO)=>{"use strict";var kO=require("events").EventEmitter,CJ=require("util"),dv=fo(),xo=RO.exports=function(t,e,r){kO.call(this),t=dv.normalizeQueryConfig(t,e,r),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};CJ.inherits(xo,kO);var PJ={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};xo.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let r in e){let n=PJ[r]||r;t[n]=e[r]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};xo.prototype.then=function(t,e){return this._getPromise().then(t,e)};xo.prototype.catch=function(t){return this._getPromise().catch(t)};xo.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};xo.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let r=function(n,i,a){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(a.length>1?i.forEach((s,o)=>{s.forEach(u=>{e.emit("row",u,a[o])})}):i.forEach(function(s){e.emit("row",s,a)})),e.state="end",e.emit("end",a),e.callback&&e.callback(null,a)};if(process.domain&&(r=process.domain.bind(r)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(dv.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let i=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return r(i)}return t.native.execute(this.name,n,r)}return t.native.prepare(this.name,this.text,n.length,function(i){return i?r(i):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,r))})}else if(this.values){if(!Array.isArray(this.values)){let i=new Error("Query values must be an array");return r(i)}let n=this.values.map(dv.prepareValue);t.native.query(this.text,n,r)}else this.queryMode==="extended"?t.native.query(this.text,[],r):t.native.query(this.text,r)}});var DO=E((Sne,FO)=>{"use strict";var OO;try{OO=require("pg-native")}catch(t){throw t}var TJ=Ad(),jO=require("events").EventEmitter,IJ=require("util"),kJ=ky(),$O=NO(),_r=FO.exports=function(t){jO.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new TJ(t.types),this.native=new OO({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new kJ(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};_r.Query=$O;IJ.inherits(_r,jO);_r.prototype._errorAllQueries=function(t){let e=r=>{process.nextTick(()=>{r.native=this.native,r.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};_r.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(r,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),r)return t(r);e.native.connect(n,function(i){if(i)return e.native.end(),t(i);e._connected=!0,e.native.on("error",function(a){e._queryable=!1,e._errorAllQueries(a),e.emit("error",a)}),e.native.on("notification",function(a){e.emit("notification",{channel:a.relname,payload:a.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};_r.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,r)=>{this._connect(n=>{n?r(n):e()})})};_r.prototype.query=function(t,e,r){let n,i,a,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")a=t.query_timeout||this.connectionParameters.query_timeout,i=n=t,typeof e=="function"&&(t.callback=e);else if(a=t.query_timeout||this.connectionParameters.query_timeout,n=new $O(t,e,r),!n.callback){let u,c;i=new this._Promise((f,m)=>{u=f,c=m}).catch(f=>{throw Error.captureStackTrace(f),f}),n.callback=(f,m)=>f?c(f):u(m)}return a&&(o=n.callback,s=setTimeout(()=>{let u=new Error("Query read timeout");process.nextTick(()=>{n.handleError(u,this.connection)}),o(u),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},a),n.callback=(u,c)=>{clearTimeout(s),o(u,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),i):(this._queryQueue.push(n),this._pulseQueryQueue(),i):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),i)};_r.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let r;return t||(r=new this._Promise(function(n,i){t=a=>a?i(a):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),r};_r.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};_r.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let r=this;e.once("_done",function(){r._pulseQueryQueue()})};_r.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};_r.prototype.ref=function(){};_r.prototype.unref=function(){};_r.prototype.setTypeParser=function(t,e,r){return this._types.setTypeParser(t,e,r)};_r.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var fv=E((Ene,MO)=>{"use strict";MO.exports=DO()});var pv=E((Cne,Bu)=>{"use strict";var RJ=AO(),NJ=Mu(),OJ=iv(),jJ=Ny(),$J=fo(),FJ=IO(),DJ=Ad(),{DatabaseError:MJ}=tv(),{escapeIdentifier:qJ,escapeLiteral:LJ}=fo(),BJ=t=>class extends FJ{constructor(r){super(r,t)}},mv=function(t){this.defaults=NJ,this.Client=t,this.Query=this.Client.Query,this.Pool=BJ(this.Client),this._pools=[],this.Connection=OJ,this.types=Du(),this.DatabaseError=MJ,this.TypeOverrides=DJ,this.escapeIdentifier=qJ,this.escapeLiteral=LJ,this.Result=jJ,this.utils=$J};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Bu.exports=new mv(fv()):(Bu.exports=new mv(RJ),Object.defineProperty(Bu.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new mv(fv())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Bu.exports,"native",{value:t}),t}}))});var kr,Pne,Tne,Ine,kne,Rne,Nne,One,jne,$ne,Fne,Dne,Ci,Fd=S(()=>{kr=er(pv(),1),Pne=kr.default.Client,Tne=kr.default.Pool,Ine=kr.default.Connection,kne=kr.default.types,Rne=kr.default.Query,Nne=kr.default.DatabaseError,One=kr.default.escapeIdentifier,jne=kr.default.escapeLiteral,$ne=kr.default.Result,Fne=kr.default.TypeOverrides,Dne=kr.default.defaults,Ci=kr.default});function F(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,_))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(_ in r&&r[_]===e[_])return!0;r=Object.getPrototypeOf(r)}return!1}var _,qne,H=S(()=>{_=Symbol.for("drizzle:entityKind"),qne=Symbol.for("drizzle:hasOwnEntityKind")});var hv,Dd,Md,qd=S(()=>{H();hv=class{static[_]="ConsoleLogWriter";write(e){console.log(e)}},Dd=class{static[_]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new hv}logQuery(e,r){let n=r.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),i=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${i}`)}},Md=class{static[_]="NoopLogger";logQuery(){}}});var nr,Ln=S(()=>{H();nr=class{static[_]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}then(e,r){return this.execute().then(e,r)}}});var De,yn=S(()=>{H();De=class{constructor(e,r){this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}static[_]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}});var Ld,gv=S(()=>{H();Ld=class{static[_]="ColumnBuilder";config;constructor(e,r,n){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}});var tn,Bd=S(()=>{tn=Symbol.for("drizzle:Name")});var Ud,yv,vv=S(()=>{H();Bd();Ud=class{static[_]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,r){this.reference=()=>{let{name:n,columns:i,foreignColumns:a}=e();return{name:n,columns:i,foreignTable:a[0].table,foreignColumns:a}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new yv(e,this)}},yv=class{constructor(e,r){this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}static[_]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:r,foreignColumns:n}=this.reference(),i=r.map(o=>o.name),a=n.map(o=>o.name),s=[this.table[tn],...i,n[0].table[tn],...a];return e??`${s.join("_")}_fk`}}});function Vd(t,...e){return t(...e)}var bv=S(()=>{});function _v(t,e){return`${t[tn]}_${e.join("_")}_unique`}var xv,qO,wv,Sv=S(()=>{H();Bd();xv=class{constructor(e,r){this.name=r,this.columns=e}static[_]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new wv(e,this.columns,this.nullsNotDistinctConfig,this.name)}},qO=class{static[_]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new xv(e,this.name)}},wv=class{constructor(e,r,n,i){this.table=e,this.columns=r,this.name=i??_v(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=n}static[_]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}});function LO(t,e,r){for(let n=e;n<t.length;n++){let i=t[n];if(i==="\\"){n++;continue}if(i==='"')return[t.slice(e,n).replace(/\\/g,""),n+1];if(!r&&(i===","||i==="}"))return[t.slice(e,n).replace(/\\/g,""),n]}return[t.slice(e).replace(/\\/g,""),t.length]}function BO(t,e=0){let r=[],n=e,i=!1;for(;n<t.length;){let a=t[n];if(a===","){(i||n===e)&&r.push(""),i=!0,n++;continue}if(i=!1,a==="\\"){n+=2;continue}if(a==='"'){let[u,c]=LO(t,n+1,!0);r.push(u),n=c;continue}if(a==="}")return[r,n+1];if(a==="{"){let[u,c]=BO(t,n+1);r.push(u),n=c;continue}let[s,o]=LO(t,n,!1);r.push(s),n=o}return[r,n]}function UO(t){let[e]=BO(t,1);return e}function Ev(t){return`{${t.map(e=>Array.isArray(e)?Ev(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Av=S(()=>{});var re,z,Cv,wo,Pv,Tv,Pe=S(()=>{gv();yn();H();vv();bv();Sv();Av();re=class extends Ld{foreignKeyConfigs=[];static[_]="PgColumnBuilder";array(e){return new Pv(this.config.name,this,e)}references(e,r={}){return this.foreignKeyConfigs.push({ref:e,actions:r}),this}unique(e,r){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=r?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,r){return this.foreignKeyConfigs.map(({ref:n,actions:i})=>Vd((a,s)=>{let o=new Ud(()=>{let u=a();return{columns:[e],foreignColumns:[u]}});return s.onUpdate&&o.onUpdate(s.onUpdate),s.onDelete&&o.onDelete(s.onDelete),o.build(r)},n,i))}buildExtraConfigColumn(e){return new Cv(e,this.config)}},z=class extends De{constructor(e,r){r.uniqueName||(r.uniqueName=_v(e,[r.name])),super(e,r),this.table=e}static[_]="PgColumn"},Cv=class extends z{static[_]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},wo=class{static[_]="IndexedColumn";constructor(e,r,n,i){this.name=e,this.keyAsName=r,this.type=n,this.indexConfig=i}name;keyAsName;type;indexConfig},Pv=class extends re{static[_]="PgArrayBuilder";constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){let r=this.config.baseBuilder.build(e);return new Tv(e,this.config,r)}},Tv=class t extends z{constructor(e,r,n,i){super(e,r),this.baseColumn=n,this.range=i,this.size=r.size}size;static[_]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=UO(e)),e.map(r=>this.baseColumn.mapFromDriverValue(r))}mapToDriverValue(e,r=!1){let n=e.map(i=>i===null?null:F(this.baseColumn,t)?this.baseColumn.mapToDriverValue(i,!0):this.baseColumn.mapToDriverValue(i));return r?n:Ev(n)}}});function VO(t){return!!t&&typeof t=="function"&&Iv in t&&t[Iv]===!0}function zO(t,e,r){let n=Object.assign(i=>new kv(i??"",n),{enumName:t,enumValues:e,schema:r,[Iv]:!0});return n}var Iv,kv,Rv,zd=S(()=>{H();Pe();Iv=Symbol.for("drizzle:isPgEnum");kv=class extends re{static[_]="PgEnumColumnBuilder";constructor(e,r){super(e,"string","PgEnumColumn"),this.config.enum=r}build(e){return new Rv(e,this.config)}},Rv=class extends z{static[_]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,r){super(e,r),this.enum=r.enum}getSQLType(){return this.enum.enumName}}});var Tt,_o,vn=S(()=>{H();Tt=class{static[_]="Subquery";constructor(e,r,n,i=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:i}}},_o=class extends Tt{static[_]="WithSubquery"}});var HO,QO=S(()=>{HO="0.39.3"});var Nv,Ov,tt,Bn=S(()=>{bv();QO();tt={startActiveSpan(t,e){return Nv?(Ov||(Ov=Nv.trace.getTracer("drizzle-orm",HO)),Vd((r,n)=>n.startActiveSpan(t,i=>{try{return e(i)}catch(a){throw i.setStatus({code:r.SpanStatusCode.ERROR,message:a instanceof Error?a.message:"Unknown error"}),a}finally{i.end()}}),Nv,Ov)):e()}}});var rt,Un=S(()=>{rt=Symbol.for("drizzle:ViewBaseConfig")});function Fv(t){return typeof t=="object"&&t!==null&&GO in t}function Sr(t){return t[tn]}function Da(t){return`${t[Hd]??"public"}.${t[tn]}`}var Hd,Qd,WO,jv,$v,Uu,KO,GO,K,Er=S(()=>{H();Bd();Hd=Symbol.for("drizzle:Schema"),Qd=Symbol.for("drizzle:Columns"),WO=Symbol.for("drizzle:ExtraConfigColumns"),jv=Symbol.for("drizzle:OriginalName"),$v=Symbol.for("drizzle:BaseName"),Uu=Symbol.for("drizzle:IsAlias"),KO=Symbol.for("drizzle:ExtraConfigBuilder"),GO=Symbol.for("drizzle:IsDrizzleTable"),K=class{static[_]="Table";static Symbol={Name:tn,Schema:Hd,OriginalName:jv,Columns:Qd,ExtraConfigColumns:WO,BaseName:$v,IsAlias:Uu,ExtraConfigBuilder:KO};[tn];[jv];[Hd];[Qd];[WO];[$v];[Uu]=!1;[GO]=!0;[KO]=void 0;constructor(e,r,n){this[tn]=this[jv]=e,this[Hd]=r,this[$v]=n}}});function Dv(t){return t!=null&&typeof t.getSQL=="function"}function UJ(t){let e={sql:"",params:[]};for(let r of t)e.sql+=r.sql,e.params.push(...r.params),r.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...r.typings));return e}function YO(t){return typeof t=="object"&&t!==null&&"mapToDriverValue"in t&&typeof t.mapToDriverValue=="function"}function y(t,...e){let r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new It(t[0]));for(let[n,i]of e.entries())r.push(i,new It(t[n+1]));return new G(r)}function Mv(t,e){return t.map(r=>{if(F(r,Vn)){if(!(r.name in e))throw new Error(`No value for placeholder "${r.name}" was provided`);return e[r.name]}if(F(r,Ar)&&F(r.value,Vn)){if(!(r.value.name in e))throw new Error(`No value for placeholder "${r.value.name}" was provided`);return r.encoder.mapToDriverValue(e[r.value.name])}return r})}function tj(t){return typeof t=="object"&&t!==null&&ej in t}var JO,It,G,Vu,XO,ZO,Nie,Ar,Vn,ej,mr,kt=S(()=>{H();zd();vn();Bn();Un();yn();Er();JO=class{static[_]="FakePrimitiveParam"};It=class{static[_]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new G([this])}},G=class t{constructor(e){this.queryChunks=e}static[_]="SQL";decoder=XO;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return tt.startActiveSpan("drizzle.buildSQL",r=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return r?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){let n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:i,escapeName:a,escapeParam:s,prepareTyping:o,inlineParams:u,paramStartIndex:c}=n;return UJ(e.map(f=>{if(F(f,It))return{sql:f.value.join(""),params:[]};if(F(f,Vu))return{sql:a(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let m=[new It("(")];for(let[l,p]of f.entries())m.push(p),l<f.length-1&&m.push(new It(", "));return m.push(new It(")")),this.buildQueryFromSourceParams(m,n)}if(F(f,t))return this.buildQueryFromSourceParams(f.queryChunks,{...n,inlineParams:u||f.shouldInlineParams});if(F(f,K)){let m=f[K.Symbol.Schema],l=f[K.Symbol.Name];return{sql:m===void 0||f[Uu]?a(l):a(m)+"."+a(l),params:[]}}if(F(f,De)){let m=i.getColumnCasing(f);if(r.invokeSource==="indexes")return{sql:a(m),params:[]};let l=f.table[K.Symbol.Schema];return{sql:f.table[Uu]||l===void 0?a(f.table[K.Symbol.Name])+"."+a(m):a(l)+"."+a(f.table[K.Symbol.Name])+"."+a(m),params:[]}}if(F(f,mr)){let m=f[rt].schema,l=f[rt].name;return{sql:m===void 0||f[rt].isAlias?a(l):a(m)+"."+a(l),params:[]}}if(F(f,Ar)){if(F(f.value,Vn))return{sql:s(c.value++,f),params:[f],typings:["none"]};let m=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(F(m,t))return this.buildQueryFromSourceParams([m],n);if(u)return{sql:this.mapInlineParam(m,n),params:[]};let l=["none"];return o&&(l=[o(f.encoder)]),{sql:s(c.value++,m),params:[m],typings:l}}return F(f,Vn)?{sql:s(c.value++,f),params:[f],typings:["none"]}:F(f,t.Aliased)&&f.fieldAlias!==void 0?{sql:a(f.fieldAlias),params:[]}:F(f,Tt)?f._.isWith?{sql:a(f._.alias),params:[]}:this.buildQueryFromSourceParams([new It("("),f._.sql,new It(") "),new Vu(f._.alias)],n):VO(f)?f.schema?{sql:a(f.schema)+"."+a(f.enumName),params:[]}:{sql:a(f.enumName),params:[]}:Dv(f)?f.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([f.getSQL()],n):this.buildQueryFromSourceParams([new It("("),f.getSQL(),new It(")")],n):u?{sql:this.mapInlineParam(f,n),params:[]}:{sql:s(c.value++,f),params:[f],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){let n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new t.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Vu=class{constructor(e){this.value=e}static[_]="Name";brand;getSQL(){return new G([this])}};XO={mapFromDriverValue:t=>t},ZO={mapToDriverValue:t=>t},Nie={...XO,...ZO},Ar=class{constructor(e,r=ZO){this.value=e,this.encoder=r}static[_]="Param";brand;getSQL(){return new G([this])}};(t=>{function e(){return new G([])}t.empty=e;function r(u){return new G(u)}t.fromList=r;function n(u){return new G([new It(u)])}t.raw=n;function i(u,c){let f=[];for(let[m,l]of u.entries())m>0&&c!==void 0&&f.push(c),f.push(l);return new G(f)}t.join=i;function a(u){return new Vu(u)}t.identifier=a;function s(u){return new Vn(u)}t.placeholder=s;function o(u,c){return new Ar(u,c)}t.param=o})(y||(y={}));(t=>{class e{constructor(n,i){this.sql=n,this.fieldAlias=i}static[_]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}t.Aliased=e})(G||(G={}));Vn=class{constructor(e){this.name=e}static[_]="Placeholder";getSQL(){return new G([this])}};ej=Symbol.for("drizzle:IsDrizzleView"),mr=class{static[_]="View";[rt];[ej]=!0;constructor({name:e,schema:r,selectedFields:n,query:i}){this[rt]={name:e,originalName:e,schema:r,selectedFields:n,query:i,isExisting:!i,isAlias:!1}}getSQL(){return new G([this])}};De.prototype.getSQL=function(){return new G([this])};K.prototype.getSQL=function(){return new G([this])};Tt.prototype.getSQL=function(){return new G([this])}});function zu(t,e){return new Proxy(t,new So(e,!1))}function bn(t,e){return new Proxy(t,new Ma(new Proxy(t.table,new So(e,!1))))}function qv(t,e){return new G.Aliased(Hu(t.sql,e),t.fieldAlias)}function Hu(t,e){return y.join(t.queryChunks.map(r=>F(r,De)?bn(r,e):F(r,G)?Hu(r,e):F(r,G.Aliased)?qv(r,e):r))}var Ma,So,rj,Wd=S(()=>{yn();H();kt();Er();Un();Ma=class{constructor(e){this.table=e}static[_]="ColumnAliasProxyHandler";get(e,r){return r==="table"?this.table:e[r]}},So=class{constructor(e,r){this.alias=e,this.replaceOriginalName=r}static[_]="TableAliasProxyHandler";get(e,r){if(r===K.Symbol.IsAlias)return!0;if(r===K.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===K.Symbol.OriginalName)return this.alias;if(r===rt)return{...e[rt],name:this.alias,isAlias:!0};if(r===K.Symbol.Columns){let i=e[K.Symbol.Columns];if(!i)return i;let a={};return Object.keys(i).map(s=>{a[s]=new Proxy(i[s],new Ma(new Proxy(e,this)))}),a}let n=e[r];return F(n,De)?new Proxy(n,new Ma(new Proxy(e,this))):n}},rj=class{constructor(e){this.alias=e}static[_]="RelationTableAliasProxyHandler";get(e,r){return r==="sourceTable"?zu(e.sourceTable,this.alias):e[r]}}});var Ge,Pi=S(()=>{Wd();yn();H();kt();vn();Un();Ge=class t{static[_]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,r){if(r==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(r===rt)return{...e[rt],selectedFields:new Proxy(e[rt].selectedFields,this)};if(typeof r=="symbol")return e[r];let i=(F(e,Tt)?e._.selectedFields:F(e,mr)?e[rt].selectedFields:e)[r];if(F(i,G.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!i.isSelectionField)return i.sql;let a=i.clone();return a.isSelectionField=!0,a}if(F(i,G)){if(this.config.sqlBehavior==="sql")return i;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return F(i,De)?this.config.alias?new Proxy(i,new Ma(new Proxy(i.table,new So(this.config.alias,this.config.replaceOriginalName??!1)))):i:typeof i!="object"||i===null?i:new Proxy(i,new t(this.config))}}});function nj(t,e,r){let n={},i=t.reduce((a,{path:s,field:o},u)=>{let c;F(o,De)?c=o:F(o,G)?c=o.decoder:c=o.sql.decoder;let f=a;for(let[m,l]of s.entries())if(m<s.length-1)l in f||(f[l]={}),f=f[l];else{let p=e[u],d=f[l]=p===null?null:c.mapFromDriverValue(p);if(r&&F(o,De)&&s.length===2){let h=s[0];h in n?typeof n[h]=="string"&&n[h]!==Sr(o.table)&&(n[h]=!1):n[h]=d===null?Sr(o.table):!1}}return a},{});if(r&&Object.keys(n).length>0)for(let[a,s]of Object.entries(n))typeof s=="string"&&!r[s]&&(i[a]=null);return i}function Qr(t,e){return Object.entries(t).reduce((r,[n,i])=>{if(typeof n!="string")return r;let a=e?[...e,n]:[n];return F(i,De)||F(i,G)||F(i,G.Aliased)?r.push({path:a,field:i}):F(i,K)?r.push(...Qr(i[K.Symbol.Columns],a)):r.push(...Qr(i,a)),r},[])}function Qu(t,e){let r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let[i,a]of r.entries())if(a!==n[i])return!1;return!0}function Kd(t,e){let r=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,i])=>F(i,G)||F(i,De)?[n,i]:[n,new Ar(i,t[K.Symbol.Columns][n])]);if(r.length===0)throw new Error("No values to set");return Object.fromEntries(r)}function ij(t,e){for(let r of e)for(let n of Object.getOwnPropertyNames(r.prototype))n!=="constructor"&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(r.prototype,n)||Object.create(null))}function qa(t){return t[K.Symbol.Columns]}function aj(t){return t[rt].selectedFields}function zn(t){return F(t,Tt)?t._.alias:F(t,mr)?t[rt].name:F(t,G)?void 0:t[K.Symbol.IsAlias]?t[K.Symbol.Name]:t[K.Symbol.BaseName]}function ke(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}function sj(t){if(typeof t!="object"||t===null||t.constructor.name!=="Object")return!1;if("logger"in t){let e=typeof t.logger;return!(e!=="boolean"&&(e!=="object"||typeof t.logger.logQuery!="function")&&e!=="undefined")}if("schema"in t){let e=typeof t.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in t){let e=typeof t.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in t)return!(t.mode!=="default"||t.mode!=="planetscale"||t.mode!==void 0);if("connection"in t){let e=typeof t.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in t){let e=typeof t.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(t).length===0}var Je=S(()=>{yn();H();kt();vn();Er();Un()});var Wu,oj=S(()=>{H();Ln();Pi();Er();Bn();Je();Wu=class extends nr{constructor(e,r,n,i){super(),this.session=r,this.dialect=n,this.config={table:e,withList:i}}static[_]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[K.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Qr(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return tt.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>tt.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Ge({alias:Sr(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}});function VJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(r=>r.toLowerCase()).join("_")}function zJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((r,n,i)=>{let a=i===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return r+a},"")}function HJ(t){return t}var Gd,cj=S(()=>{H();Er();Gd=class{static[_]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?VJ:e==="camelCase"?zJ:HJ}getColumnCasing(e){if(!e.keyAsName)return e.name;let r=e.table[K.Symbol.Schema]??"public",n=e.table[K.Symbol.OriginalName],i=`${r}.${n}.${e.name}`;return this.cache[i]||this.cacheTable(e.table),this.cache[i]}cacheTable(e){let r=e[K.Symbol.Schema]??"public",n=e[K.Symbol.OriginalName],i=`${r}.${n}`;if(!this.cachedTables[i]){for(let a of Object.values(e[K.Symbol.Columns])){let s=`${i}.${a.name}`;this.cache[s]=this.convert(a.name)}this.cachedTables[i]=!0}}clearCache(){this.cache={},this.cachedTables={}}}});var Ku,Jd,Yd=S(()=>{H();Ku=class extends Error{static[_]="DrizzleError";constructor({message:e,cause:r}){super(e),this.name="DrizzleError",this.cause=r}},Jd=class extends Ku{static[_]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}});var Hn,Gu=S(()=>{H();Pe();Hn=class extends re{static[_]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}});function Ju(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Lv(r):new Uv(r)}var Lv,Bv,Uv,Vv,zv=S(()=>{H();Je();Pe();Gu();Lv=class extends Hn{static[_]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Bv(e,this.config)}},Bv=class extends z{static[_]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Uv=class extends Hn{static[_]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Vv(e,this.config)}},Vv=class extends z{static[_]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}});function uj(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Hv(r):new Wv(r)}var Hv,Qv,Wv,Kv,Gv=S(()=>{H();Je();Pe();Hv=class extends re{static[_]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Qv(e,this.config)}},Qv=class extends z{static[_]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Wv=class extends re{static[_]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Kv(e,this.config)}},Kv=class extends z{static[_]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}});function Ti(t){return new Jv(t??"")}var Jv,Yv,Xv=S(()=>{H();Pe();Jv=class extends re{static[_]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Yv(e,this.config)}},Yv=class extends z{static[_]="PgBoolean";getSQLType(){return"boolean"}}});function lj(t,e={}){let{name:r,config:n}=ke(t,e);return new Zv(r,n)}var Zv,eb,tb=S(()=>{H();Je();Pe();Zv=class extends re{static[_]="PgCharBuilder";constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new eb(e,this.config)}},eb=class extends z{static[_]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}});function pj(t){return new rb(t??"")}var rb,nb,ib=S(()=>{H();Pe();rb=class extends re{static[_]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new nb(e,this.config)}},nb=class extends z{static[_]="PgCidr";getSQLType(){return"cidr"}}});function dj(t){return(e,r)=>{let{name:n,config:i}=ke(e,r);return new ab(n,i,t)}}var ab,sb,ob=S(()=>{H();Je();Pe();ab=class extends re{static[_]="PgCustomColumnBuilder";constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new sb(e,this.config)}},sb=class extends z{static[_]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,r){super(e,r),this.sqlName=r.customTypeParams.dataType(r.fieldConfig),this.mapTo=r.customTypeParams.toDriver,this.mapFrom=r.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}});var xn,Xd=S(()=>{H();kt();Pe();xn=class extends re{static[_]="PgDateColumnBaseBuilder";defaultNow(){return this.default(y`now()`)}}});function fj(t,e){let{name:r,config:n}=ke(t,e);return n?.mode==="date"?new cb(r):new ub(r)}var cb,Yu,ub,Xu,lb=S(()=>{H();Je();Pe();Xd();cb=class extends xn{static[_]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Yu(e,this.config)}},Yu=class extends z{static[_]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},ub=class extends xn{static[_]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Xu(e,this.config)}},Xu=class extends z{static[_]="PgDateString";getSQLType(){return"date"}}});function mj(t){return new pb(t??"")}var pb,db,fb=S(()=>{H();Pe();pb=class extends re{static[_]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new db(e,this.config)}},db=class extends z{static[_]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}});function hj(t){return new mb(t??"")}var mb,hb,gb=S(()=>{H();Pe();mb=class extends re{static[_]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new hb(e,this.config)}},hb=class extends z{static[_]="PgInet";getSQLType(){return"inet"}}});function Z(t){return new yb(t??"")}var yb,vb,bb=S(()=>{H();Pe();Gu();yb=class extends Hn{static[_]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new vb(e,this.config)}},vb=class extends z{static[_]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}});function gj(t,e={}){let{name:r,config:n}=ke(t,e);return new xb(r,n)}var xb,wb,_b=S(()=>{H();Je();Pe();xb=class extends re{static[_]="PgIntervalBuilder";constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new wb(e,this.config)}},wb=class extends z{static[_]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",r=this.precision?`(${this.precision})`:"";return`interval${e}${r}`}}});function yj(t){return new Sb(t??"")}var Sb,Zu,Eb=S(()=>{H();Pe();Sb=class extends re{static[_]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Zu(e,this.config)}},Zu=class extends z{static[_]="PgJson";constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function Qe(t){return new Ab(t??"")}var Ab,el,Cb=S(()=>{H();Pe();Ab=class extends re{static[_]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new el(e,this.config)}},el=class extends z{static[_]="PgJsonb";constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function vj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Pb(r):new Ib(r)}var Pb,Tb,Ib,kb,Rb=S(()=>{H();Je();Pe();Pb=class extends re{static[_]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Tb(e,this.config)}},Tb=class extends z{static[_]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(i)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Ib=class extends re{static[_]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new kb(e,this.config)}},kb=class extends z{static[_]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(i)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}});function bj(t){return new Nb(t??"")}var Nb,Ob,jb=S(()=>{H();Pe();Nb=class extends re{static[_]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new Ob(e,this.config)}},Ob=class extends z{static[_]="PgMacaddr";getSQLType(){return"macaddr"}}});function xj(t){return new $b(t??"")}var $b,Fb,Db=S(()=>{H();Pe();$b=class extends re{static[_]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Fb(e,this.config)}},Fb=class extends z{static[_]="PgMacaddr8";getSQLType(){return"macaddr8"}}});function qb(t,e){let{name:r,config:n}=ke(t,e);return new Mb(r,n?.precision,n?.scale)}var Mb,tl,Kt,Lb=S(()=>{H();Je();Pe();Mb=class extends re{static[_]="PgNumericBuilder";constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new tl(e,this.config)}},tl=class extends z{static[_]="PgNumeric";precision;scale;constructor(e,r){super(e,r),this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Kt=qb});function wj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Bb(r):new Vb(r)}var Bb,Ub,Vb,zb,Hb=S(()=>{H();Je();Pe();Bb=class extends re{static[_]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Ub(e,this.config)}},Ub=class extends z{static[_]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Vb=class extends re{static[_]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new zb(e,this.config)}},zb=class extends z{static[_]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}});function QJ(t){let e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function _j(t,e){let r=new ArrayBuffer(8),n=new DataView(r);for(let i=0;i<8;i++)n.setUint8(i,t[e+i]);return n.getFloat64(0,!0)}function Qb(t){let e=QJ(t),r=0,n=e[r];r+=1;let i=new DataView(e.buffer),a=i.getUint32(r,n===1);r+=4;let s;if(a&536870912&&(s=i.getUint32(r,n===1),r+=4),(a&65535)===1){let o=_j(e,r);r+=8;let u=_j(e,r);return r+=8,[o,u]}throw new Error("Unsupported geometry type")}var Sj=S(()=>{});function Ej(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Wb(r):new Gb(r)}var Wb,Kb,Gb,Jb,Yb=S(()=>{H();Je();Pe();Sj();Wb=class extends re{static[_]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new Kb(e,this.config)}},Kb=class extends z{static[_]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Qb(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},Gb=class extends re{static[_]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new Jb(e,this.config)}},Jb=class extends z{static[_]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let r=Qb(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}});function Aj(t){return new Xb(t??"")}var Xb,Zb,ex=S(()=>{H();Pe();Xb=class extends re{static[_]="PgRealBuilder";constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new Zb(e,this.config)}},Zb=class extends z{static[_]="PgReal";constructor(e,r){super(e,r)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}});function Ye(t){return new tx(t??"")}var tx,rx,nx=S(()=>{H();Pe();tx=class extends re{static[_]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new rx(e,this.config)}},rx=class extends z{static[_]="PgSerial";getSQLType(){return"serial"}}});function Cj(t){return new ix(t??"")}var ix,ax,sx=S(()=>{H();Pe();Gu();ix=class extends Hn{static[_]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new ax(e,this.config)}},ax=class extends z{static[_]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}});function Pj(t){return new ox(t??"")}var ox,cx,ux=S(()=>{H();Pe();ox=class extends re{static[_]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new cx(e,this.config)}},cx=class extends z{static[_]="PgSmallSerial";getSQLType(){return"smallserial"}}});function $(t,e={}){let{name:r,config:n}=ke(t,e);return new lx(r,n)}var lx,px,dx=S(()=>{H();Je();Pe();lx=class extends re{static[_]="PgTextBuilder";constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new px(e,this.config)}},px=class extends z{static[_]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}});function Tj(t,e={}){let{name:r,config:n}=ke(t,e);return new fx(r,n.withTimezone??!1,n.precision)}var fx,rl,mx=S(()=>{H();Je();Pe();Xd();fx=class extends xn{constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}static[_]="PgTimeBuilder";build(e){return new rl(e,this.config)}},rl=class extends z{static[_]="PgTime";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function we(t,e={}){let{name:r,config:n}=ke(t,e);return n?.mode==="string"?new gx(r,n.withTimezone??!1,n.precision):new hx(r,n?.withTimezone??!1,n?.precision)}var hx,nl,gx,il,yx=S(()=>{H();Je();Pe();Xd();hx=class extends xn{static[_]="PgTimestampBuilder";constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new nl(e,this.config)}},nl=class extends z{static[_]="PgTimestamp";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},gx=class extends xn{static[_]="PgTimestampStringBuilder";constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new il(e,this.config)}},il=class extends z{static[_]="PgTimestampString";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function Ij(t){return new vx(t??"")}var vx,al,bx=S(()=>{H();kt();Pe();vx=class extends re{static[_]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(y`gen_random_uuid()`)}build(e){return new al(e,this.config)}},al=class extends z{static[_]="PgUUID";getSQLType(){return"uuid"}}});function Gt(t,e={}){let{name:r,config:n}=ke(t,e);return new xx(r,n)}var xx,wx,_x=S(()=>{H();Je();Pe();xx=class extends re{static[_]="PgVarcharBuilder";constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new wx(e,this.config)}},wx=class extends z{static[_]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}});function kj(t,e){let{name:r,config:n}=ke(t,e);return new Sx(r,n)}var Sx,Ex,Ax=S(()=>{H();Je();Pe();Sx=class extends re{static[_]="PgBinaryVectorBuilder";constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new Ex(e,this.config)}},Ex=class extends z{static[_]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}});function Rj(t,e){let{name:r,config:n}=ke(t,e);return new Cx(r,n)}var Cx,Px,Tx=S(()=>{H();Je();Pe();Cx=class extends re{static[_]="PgHalfVectorBuilder";constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){returIPv4 resolution failed, using original URL: Error: getaddrinfo ENOTFOUND db.epbxctcwmtsuxdgxkgdz.supabase.co
2026-Jan-18 17:01:11.213393 at GetAddrInfoReqWrap.onlookup [as oncomplete] (node:dns:111:26) {
2026-Jan-18 17:01:11.213393 errno: -3007,
2026-Jan-18 17:01:11.213393 code: 'ENOTFOUND',
2026-Jan-18 17:01:11.213393 syscall: 'getaddrinfo',
2026-Jan-18 17:01:11.213393 hostname: 'db.epbxctcwmtsuxdgxkgdz.supabase.co'
2026-Jan-18 17:01:11.213393 }
2026-Jan-18 17:01:11.213393 /app/dist/index.cjs:67
2026-Jan-18 17:01:11.213393 `);Lu.write(vO.format.apply(vO,e))}}Object.defineProperty(qn.exports,"isWin",{get:function(){return Nd},set:function(t){Nd=t}});qn.exports.warnTo=function(t){var e=Lu;return Lu=t,e};qn.exports.getFileName=function(t){var e=t||process.env,r=e.PGPASSFILE||(Nd?yO.join(e.APPDATA||"./","postgresql","pgpass.conf"):yO.join(e.HOME||"./",".pgpass"));return r};qn.exports.usePgPass=function(t,e){return Object.prototype.hasOwnProperty.call(process.env,"PGPASSWORD")?!1:Nd?!0:(e=e||"<unkn>",dJ(t.mode)?t.mode&(cJ|uJ)?(sv('WARNING: password file "%s" has group or world access; permissions should be u=rw (0600) or less',e),!1):!0:(sv('WARNING: password file "%s" is not a plain file',e),!1))};var mJ=qn.exports.match=function(t,e){return vo.slice(0,-1).reduce(function(r,n,i){return i==1&&Number(t[n]||oJ)===Number(e[n])?r&&!0:r&&(e[n]==="*"||e[n]===t[n])},!0)};qn.exports.getPassword=function(t,e,r){var n,i=e.pipe(sJ());function a(u){var c=hJ(u);c&&gJ(c)&&mJ(t,c)&&(n=c[fJ],i.end())}var s=function(){e.destroy(),r(n)},o=function(u){e.destroy(),sv("WARNING: error on reading file: %s",u),r(void 0)};e.on("error",o),i.on("data",a).on("end",s).on("error",o)};var hJ=qn.exports.parseLine=function(t){if(t.length<11||t.match(/^\s+#/))return null;for(var e="",r="",n=0,i=0,a=0,s={},o=!1,u=function(f,m,l){var p=t.substring(m,l);Object.hasOwnProperty.call(process.env,"PGPASS_NO_DEESCAPE")||(p=p.replace(/\\([:\\])/g,"$1")),s[vo[f]]=p},c=0;c<t.length-1;c+=1){if(e=t.charAt(c+1),r=t.charAt(c),o=n==av-1,o){u(n,i);break}c>=0&&e==":"&&r!=="\\"&&(u(n,i,c+1),i=c+2,n+=1)}return s=Object.keys(s).length===av?s:null,s},gJ=qn.exports.isValidEntry=function(t){for(var e={0:function(s){return s.length>0},1:function(s){return s==="*"?!0:(s=Number(s),isFinite(s)&&s>0&&s<9007199254740992&&Math.floor(s)===s)},2:function(s){return s.length>0},3:function(s){return s.length>0},4:function(s){return s.length>0}},r=0;r<vo.length;r+=1){var n=e[r],i=t[vo[r]]||"",a=n(i);if(!a)return!1}return!0}});var wO=E((bne,ov)=>{"use strict";var vne=require("path"),xO=require("fs"),Od=bO();ov.exports=function(t,e){var r=Od.getFileName();xO.stat(r,function(n,i){if(n||!Od.usePgPass(i,r))return e(void 0);var a=xO.createReadStream(r);Od.getPassword(t,a,e)})};ov.exports.warnTo=Od.warnTo});var AO=E((xne,EO)=>{"use strict";var yJ=require("events").EventEmitter,_O=fo(),cv=UN(),vJ=Ad(),bJ=ky(),SO=tO(),xJ=Mu(),wJ=iv(),_J=Py(),jd=class extends yJ{constructor(e){super(),this.connectionParameters=new bJ(e),this.user=this.connectionParameters.user,this.database=this.connectionParameters.database,this.port=this.connectionParameters.port,this.host=this.connectionParameters.host,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:this.connectionParameters.password}),this.replication=this.connectionParameters.replication;let r=e||{};this._Promise=r.Promise||global.Promise,this._types=new vJ(r.types),this._ending=!1,this._ended=!1,this._connecting=!1,this._connected=!1,this._connectionError=!1,this._queryable=!0,this.enableChannelBinding=!!r.enableChannelBinding,this.connection=r.connection||new wJ({stream:r.stream,ssl:this.connectionParameters.ssl,keepAlive:r.keepAlive||!1,keepAliveInitialDelayMillis:r.keepAliveInitialDelayMillis||0,encoding:this.connectionParameters.client_encoding||"utf8"}),this.queryQueue=[],this.binary=r.binary||xJ.binary,this.processID=null,this.secretKey=null,this.ssl=this.connectionParameters.ssl||!1,this.ssl&&this.ssl.key&&Object.defineProperty(this.ssl,"key",{enumerable:!1}),this._connectionTimeoutMillis=r.connectionTimeoutMillis||0}_errorAllQueries(e){let r=n=>{process.nextTick(()=>{n.handleError(e,this.connection)})};this.activeQuery&&(r(this.activeQuery),this.activeQuery=null),this.queryQueue.forEach(r),this.queryQueue.length=0}_connect(e){let r=this,n=this.connection;if(this._connectionCallback=e,this._connecting||this._connected){let i=new Error("Client has already been connected. You cannot reuse a client.");process.nextTick(()=>{e(i)});return}this._connecting=!0,this._connectionTimeoutMillis>0&&(this.connectionTimeoutHandle=setTimeout(()=>{n._ending=!0,n.stream.destroy(new Error("timeout expired"))},this._connectionTimeoutMillis),this.connectionTimeoutHandle.unref&&this.connectionTimeoutHandle.unref()),this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){r.ssl?n.requestSsl():n.startup(r.getStartupConf())}),n.on("sslconnect",function(){n.startup(r.getStartupConf())}),this._attachListeners(n),n.once("end",()=>{let i=this._ending?new Error("Connection terminated"):new Error("Connection terminated unexpectedly");clearTimeout(this.connectionTimeoutHandle),this._errorAllQueries(i),this._ended=!0,this._ending||(this._connecting&&!this._connectionError?this._connectionCallback?this._connectionCallback(i):this._handleErrorEvent(i):this._connectionError||this._handleErrorEvent(i)),process.nextTick(()=>{this.emit("end")})})}connect(e){if(e){this._connect(e);return}return new this._Promise((r,n)=>{this._connect(i=>{i?n(i):r()})})}_attachListeners(e){e.on("authenticationCleartextPassword",this._handleAuthCleartextPassword.bind(this)),e.on("authenticationMD5Password",this._handleAuthMD5Password.bind(this)),e.on("authenticationSASL",this._handleAuthSASL.bind(this)),e.on("authenticationSASLContinue",this._handleAuthSASLContinue.bind(this)),e.on("authenticationSASLFinal",this._handleAuthSASLFinal.bind(this)),e.on("backendKeyData",this._handleBackendKeyData.bind(this)),e.on("error",this._handleErrorEvent.bind(this)),e.on("errorMessage",this._handleErrorMessage.bind(this)),e.on("readyForQuery",this._handleReadyForQuery.bind(this)),e.on("notice",this._handleNotice.bind(this)),e.on("rowDescription",this._handleRowDescription.bind(this)),e.on("dataRow",this._handleDataRow.bind(this)),e.on("portalSuspended",this._handlePortalSuspended.bind(this)),e.on("emptyQuery",this._handleEmptyQuery.bind(this)),e.on("commandComplete",this._handleCommandComplete.bind(this)),e.on("parseComplete",this._handleParseComplete.bind(this)),e.on("copyInResponse",this._handleCopyInResponse.bind(this)),e.on("copyData",this._handleCopyData.bind(this)),e.on("notification",this._handleNotification.bind(this))}_checkPgPass(e){let r=this.connection;if(typeof this.password=="function")this._Promise.resolve().then(()=>this.password()).then(n=>{if(n!==void 0){if(typeof n!="string"){r.emit("error",new TypeError("Password must be a string"));return}this.connectionParameters.password=this.password=n}else this.connectionParameters.password=this.password=null;e()}).catch(n=>{r.emit("error",n)});else if(this.password!==null)e();else try{wO()(this.connectionParameters,i=>{i!==void 0&&(this.connectionParameters.password=this.password=i),e()})}catch(n){this.emit("error",n)}}_handleAuthCleartextPassword(e){this._checkPgPass(()=>{this.connection.password(this.password)})}_handleAuthMD5Password(e){this._checkPgPass(async()=>{try{let r=await _J.postgresMd5PasswordHash(this.user,this.password,e.salt);this.connection.password(r)}catch(r){this.emit("error",r)}})}_handleAuthSASL(e){this._checkPgPass(()=>{try{this.saslSession=cv.startSession(e.mechanisms,this.enableChannelBinding&&this.connection.stream),this.connection.sendSASLInitialResponseMessage(this.saslSession.mechanism,this.saslSession.response)}catch(r){this.connection.emit("error",r)}})}async _handleAuthSASLContinue(e){try{await cv.continueSession(this.saslSession,this.password,e.data,this.enableChannelBinding&&this.connection.stream),this.connection.sendSCRAMClientFinalMessage(this.saslSession.response)}catch(r){this.connection.emit("error",r)}}_handleAuthSASLFinal(e){try{cv.finalizeSession(this.saslSession,e.data),this.saslSession=null}catch(r){this.connection.emit("error",r)}}_handleBackendKeyData(e){this.processID=e.processID,this.secretKey=e.secretKey}_handleReadyForQuery(e){this._connecting&&(this._connecting=!1,this._connected=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback&&(this._connectionCallback(null,this),this._connectionCallback=null),this.emit("connect"));let{activeQuery:r}=this;this.activeQuery=null,this.readyForQuery=!0,r&&r.handleReadyForQuery(this.connection),this._pulseQueryQueue()}_handleErrorWhileConnecting(e){if(!this._connectionError){if(this._connectionError=!0,clearTimeout(this.connectionTimeoutHandle),this._connectionCallback)return this._connectionCallback(e);this.emit("error",e)}}_handleErrorEvent(e){if(this._connecting)return this._handleErrorWhileConnecting(e);this._queryable=!1,this._errorAllQueries(e),this.emit("error",e)}_handleErrorMessage(e){if(this._connecting)return this._handleErrorWhileConnecting(e);let r=this.activeQuery;if(!r){this._handleErrorEvent(e);return}this.activeQuery=null,r.handleError(e,this.connection)}_handleRowDescription(e){this.activeQuery.handleRowDescription(e)}_handleDataRow(e){this.activeQuery.handleDataRow(e)}_handlePortalSuspended(e){this.activeQuery.handlePortalSuspended(this.connection)}_handleEmptyQuery(e){this.activeQuery.handleEmptyQuery(this.connection)}_handleCommandComplete(e){if(this.activeQuery==null){let r=new Error("Received unexpected commandComplete message from backend.");this._handleErrorEvent(r);return}this.activeQuery.handleCommandComplete(e,this.connection)}_handleParseComplete(){if(this.activeQuery==null){let e=new Error("Received unexpected parseComplete message from backend.");this._handleErrorEvent(e);return}this.activeQuery.name&&(this.connection.parsedStatements[this.activeQuery.name]=this.activeQuery.text)}_handleCopyInResponse(e){this.activeQuery.handleCopyInResponse(this.connection)}_handleCopyData(e){this.activeQuery.handleCopyData(e,this.connection)}_handleNotification(e){this.emit("notification",e)}_handleNotice(e){this.emit("notice",e)}getStartupConf(){let e=this.connectionParameters,r={user:e.user,database:e.database},n=e.application_name||e.fallback_application_name;return n&&(r.application_name=n),e.replication&&(r.replication=""+e.replication),e.statement_timeout&&(r.statement_timeout=String(parseInt(e.statement_timeout,10))),e.lock_timeout&&(r.lock_timeout=String(parseInt(e.lock_timeout,10))),e.idle_in_transaction_session_timeout&&(r.idle_in_transaction_session_timeout=String(parseInt(e.idle_in_transaction_session_timeout,10))),e.options&&(r.options=e.options),r}cancel(e,r){if(e.activeQuery===r){let n=this.connection;this.host&&this.host.indexOf("/")===0?n.connect(this.host+"/.s.PGSQL."+this.port):n.connect(this.port,this.host),n.on("connect",function(){n.cancel(e.processID,e.secretKey)})}else e.queryQueue.indexOf(r)!==-1&&e.queryQueue.splice(e.queryQueue.indexOf(r),1)}setTypeParser(e,r,n){return this._types.setTypeParser(e,r,n)}getTypeParser(e,r){return this._types.getTypeParser(e,r)}escapeIdentifier(e){return _O.escapeIdentifier(e)}escapeLiteral(e){return _O.escapeLiteral(e)}_pulseQueryQueue(){if(this.readyForQuery===!0)if(this.activeQuery=this.queryQueue.shift(),this.activeQuery){this.readyForQuery=!1,this.hasExecuted=!0;let e=this.activeQuery.submit(this.connection);e&&process.nextTick(()=>{this.activeQuery.handleError(e,this.connection),this.readyForQuery=!0,this._pulseQueryQueue()})}else this.hasExecuted&&(this.activeQuery=null,this.emit("drain"))}query(e,r,n){let i,a,s,o,u;if(e==null)throw new TypeError("Client was passed a null or undefined query");return typeof e.submit=="function"?(s=e.query_timeout||this.connectionParameters.query_timeout,a=i=e,typeof r=="function"&&(i.callback=i.callback||r)):(s=e.query_timeout||this.connectionParameters.query_timeout,i=new SO(e,r,n),i.callback||(a=new this._Promise((c,f)=>{i.callback=(m,l)=>m?f(m):c(l)}).catch(c=>{throw Error.captureStackTrace(c),c}))),s&&(u=i.callback,o=setTimeout(()=>{let c=new Error("Query read timeout");process.nextTick(()=>{i.handleError(c,this.connection)}),u(c),i.callback=()=>{};let f=this.queryQueue.indexOf(i);f>-1&&this.queryQueue.splice(f,1),this._pulseQueryQueue()},s),i.callback=(c,f)=>{clearTimeout(o),u(c,f)}),this.binary&&!i.binary&&(i.binary=!0),i._result&&!i._result._types&&(i._result._types=this._types),this._queryable?this._ending?(process.nextTick(()=>{i.handleError(new Error("Client was closed and is not queryable"),this.connection)}),a):(this.queryQueue.push(i),this._pulseQueryQueue(),a):(process.nextTick(()=>{i.handleError(new Error("Client has encountered a connection error and is not queryable"),this.connection)}),a)}ref(){this.connection.ref()}unref(){this.connection.unref()}end(e){if(this._ending=!0,!this.connection._connecting||this._ended)if(e)e();else return this._Promise.resolve();if(this.activeQuery||!this._queryable?this.connection.stream.destroy():this.connection.end(),e)this.connection.once("end",e);else return new this._Promise(r=>{this.connection.once("end",r)})}};jd.Query=SO;EO.exports=jd});var IO=E((wne,TO)=>{"use strict";var SJ=require("events").EventEmitter,CO=function(){},PO=(t,e)=>{let r=t.findIndex(e);return r===-1?void 0:t.splice(r,1)[0]},uv=class{constructor(e,r,n){this.client=e,this.idleListener=r,this.timeoutId=n}},bo=class{constructor(e){this.callback=e}};function EJ(){throw new Error("Release called on client which has already been released to the pool.")}function $d(t,e){if(e)return{callback:e,result:void 0};let r,n,i=function(s,o){s?r(s):n(o)},a=new t(function(s,o){n=s,r=o}).catch(s=>{throw Error.captureStackTrace(s),s});return{callback:i,result:a}}function AJ(t,e){return function r(n){n.client=e,e.removeListener("error",r),e.on("error",()=>{t.log("additional client error after disconnection due to error",n)}),t._remove(e),t.emit("error",n,e)}}var lv=class extends SJ{constructor(e,r){super(),this.options=Object.assign({},e),e!=null&&"password"in e&&Object.defineProperty(this.options,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),e!=null&&e.ssl&&e.ssl.key&&Object.defineProperty(this.options.ssl,"key",{enumerable:!1}),this.options.max=this.options.max||this.options.poolSize||10,this.options.min=this.options.min||0,this.options.maxUses=this.options.maxUses||1/0,this.options.allowExitOnIdle=this.options.allowExitOnIdle||!1,this.options.maxLifetimeSeconds=this.options.maxLifetimeSeconds||0,this.log=this.options.log||function(){},this.Client=this.options.Client||r||pv().Client,this.Promise=this.options.Promise||global.Promise,typeof this.options.idleTimeoutMillis>"u"&&(this.options.idleTimeoutMillis=1e4),this._clients=[],this._idle=[],this._expired=new WeakSet,this._pendingQueue=[],this._endCallback=void 0,this.ending=!1,this.ended=!1}_isFull(){return this._clients.length>=this.options.max}_isAboveMin(){return this._clients.length>this.options.min}_pulseQueue(){if(this.log("pulse queue"),this.ended){this.log("pulse queue ended");return}if(this.ending){this.log("pulse queue on ending"),this._idle.length&&this._idle.slice().map(r=>{this._remove(r.client)}),this._clients.length||(this.ended=!0,this._endCallback());return}if(!this._pendingQueue.length){this.log("no queued requests");return}if(!this._idle.length&&this._isFull())return;let e=this._pendingQueue.shift();if(this._idle.length){let r=this._idle.pop();clearTimeout(r.timeoutId);let n=r.client;n.ref&&n.ref();let i=r.idleListener;return this._acquireClient(n,e,i,!1)}if(!this._isFull())return this.newClient(e);throw new Error("unexpected condition")}_remove(e,r){let n=PO(this._idle,a=>a.client===e);n!==void 0&&clearTimeout(n.timeoutId),this._clients=this._clients.filter(a=>a!==e);let i=this;e.end(()=>{i.emit("remove",e),typeof r=="function"&&r()})}connect(e){if(this.ending){let i=new Error("Cannot use a pool after calling end on the pool");return e?e(i):this.Promise.reject(i)}let r=$d(this.Promise,e),n=r.result;if(this._isFull()||this._idle.length){if(this._idle.length&&process.nextTick(()=>this._pulseQueue()),!this.options.connectionTimeoutMillis)return this._pendingQueue.push(new bo(r.callback)),n;let i=(o,u,c)=>{clearTimeout(s),r.callback(o,u,c)},a=new bo(i),s=setTimeout(()=>{PO(this._pendingQueue,o=>o.callback===i),a.timedOut=!0,r.callback(new Error("timeout exceeded when trying to connect"))},this.options.connectionTimeoutMillis);return s.unref&&s.unref(),this._pendingQueue.push(a),n}return this.newClient(new bo(r.callback)),n}newClient(e){let r=new this.Client(this.options);this._clients.push(r);let n=AJ(this,r);this.log("checking client timeout");let i,a=!1;this.options.connectionTimeoutMillis&&(i=setTimeout(()=>{this.log("ending client due to timeout"),a=!0,r.connection?r.connection.stream.destroy():r.end()},this.options.connectionTimeoutMillis)),this.log("connecting new client"),r.connect(s=>{if(i&&clearTimeout(i),r.on("error",n),s)this.log("client failed to connect",s),this._clients=this._clients.filter(o=>o!==r),a&&(s=new Error("Connection terminated due to connection timeout",{cause:s})),this._pulseQueue(),e.timedOut||e.callback(s,void 0,CO);else{if(this.log("new client connected"),this.options.maxLifetimeSeconds!==0){let o=setTimeout(()=>{this.log("ending client due to expired lifetime"),this._expired.add(r),this._idle.findIndex(c=>c.client===r)!==-1&&this._acquireClient(r,new bo((c,f,m)=>m()),n,!1)},this.options.maxLifetimeSeconds*1e3);o.unref(),r.once("end",()=>clearTimeout(o))}return this._acquireClient(r,e,n,!0)}})}_acquireClient(e,r,n,i){i&&this.emit("connect",e),this.emit("acquire",e),e.release=this._releaseOnce(e,n),e.removeListener("error",n),r.timedOut?i&&this.options.verify?this.options.verify(e,e.release):e.release():i&&this.options.verify?this.options.verify(e,a=>{if(a)return e.release(a),r.callback(a,void 0,CO);r.callback(void 0,e,e.release)}):r.callback(void 0,e,e.release)}_releaseOnce(e,r){let n=!1;return i=>{n&&EJ(),n=!0,this._release(e,r,i)}}_release(e,r,n){if(e.on("error",r),e._poolUseCount=(e._poolUseCount||0)+1,this.emit("release",n,e),n||this.ending||!e._queryable||e._ending||e._poolUseCount>=this.options.maxUses)return e._poolUseCount>=this.options.maxUses&&this.log("remove expended client"),this._remove(e,this._pulseQueue.bind(this));if(this._expired.has(e))return this.log("remove expired client"),this._expired.delete(e),this._remove(e,this._pulseQueue.bind(this));let a;this.options.idleTimeoutMillis&&this._isAboveMin()&&(a=setTimeout(()=>{this.log("remove idle client"),this._remove(e,this._pulseQueue.bind(this))},this.options.idleTimeoutMillis),this.options.allowExitOnIdle&&a.unref()),this.options.allowExitOnIdle&&e.unref(),this._idle.push(new uv(e,r,a)),this._pulseQueue()}query(e,r,n){if(typeof e=="function"){let a=$d(this.Promise,e);return setImmediate(function(){return a.callback(new Error("Passing a function as the first parameter to pool.query is not supported"))}),a.result}typeof r=="function"&&(n=r,r=void 0);let i=$d(this.Promise,n);return n=i.callback,this.connect((a,s)=>{if(a)return n(a);let o=!1,u=c=>{o||(o=!0,s.release(c),n(c))};s.once("error",u),this.log("dispatching query");try{s.query(e,r,(c,f)=>{if(this.log("query dispatched"),s.removeListener("error",u),!o)return o=!0,s.release(c),c?n(c):n(void 0,f)})}catch(c){return s.release(c),n(c)}}),i.result}end(e){if(this.log("ending"),this.ending){let n=new Error("Called end on pool more than once");return e?e(n):this.Promise.reject(n)}this.ending=!0;let r=$d(this.Promise,e);return this._endCallback=r.callback,this._pulseQueue(),r.result}get waitingCount(){return this._pendingQueue.length}get idleCount(){return this._idle.length}get expiredCount(){return this._clients.reduce((e,r)=>e+(this._expired.has(r)?1:0),0)}get totalCount(){return this._clients.length}};TO.exports=lv});var NO=E((_ne,RO)=>{"use strict";var kO=require("events").EventEmitter,CJ=require("util"),dv=fo(),xo=RO.exports=function(t,e,r){kO.call(this),t=dv.normalizeQueryConfig(t,e,r),this.text=t.text,this.values=t.values,this.name=t.name,this.queryMode=t.queryMode,this.callback=t.callback,this.state="new",this._arrayMode=t.rowMode==="array",this._emitRowEvents=!1,this.on("newListener",function(n){n==="row"&&(this._emitRowEvents=!0)}.bind(this))};CJ.inherits(xo,kO);var PJ={sqlState:"code",statementPosition:"position",messagePrimary:"message",context:"where",schemaName:"schema",tableName:"table",columnName:"column",dataTypeName:"dataType",constraintName:"constraint",sourceFile:"file",sourceLine:"line",sourceFunction:"routine"};xo.prototype.handleError=function(t){let e=this.native.pq.resultErrorFields();if(e)for(let r in e){let n=PJ[r]||r;t[n]=e[r]}this.callback?this.callback(t):this.emit("error",t),this.state="error"};xo.prototype.then=function(t,e){return this._getPromise().then(t,e)};xo.prototype.catch=function(t){return this._getPromise().catch(t)};xo.prototype._getPromise=function(){return this._promise?this._promise:(this._promise=new Promise(function(t,e){this._once("end",t),this._once("error",e)}.bind(this)),this._promise)};xo.prototype.submit=function(t){this.state="running";let e=this;this.native=t.native,t.native.arrayMode=this._arrayMode;let r=function(n,i,a){if(t.native.arrayMode=!1,setImmediate(function(){e.emit("_done")}),n)return e.handleError(n);e._emitRowEvents&&(a.length>1?i.forEach((s,o)=>{s.forEach(u=>{e.emit("row",u,a[o])})}):i.forEach(function(s){e.emit("row",s,a)})),e.state="end",e.emit("end",a),e.callback&&e.callback(null,a)};if(process.domain&&(r=process.domain.bind(r)),this.name){this.name.length>63&&(console.error("Warning! Postgres only supports 63 characters for query names."),console.error("You supplied %s (%s)",this.name,this.name.length),console.error("This can cause conflicts and silent errors executing queries"));let n=(this.values||[]).map(dv.prepareValue);if(t.namedQueries[this.name]){if(this.text&&t.namedQueries[this.name]!==this.text){let i=new Error(`Prepared statements must be unique - '${this.name}' was used for a different statement`);return r(i)}return t.native.execute(this.name,n,r)}return t.native.prepare(this.name,this.text,n.length,function(i){return i?r(i):(t.namedQueries[e.name]=e.text,e.native.execute(e.name,n,r))})}else if(this.values){if(!Array.isArray(this.values)){let i=new Error("Query values must be an array");return r(i)}let n=this.values.map(dv.prepareValue);t.native.query(this.text,n,r)}else this.queryMode==="extended"?t.native.query(this.text,[],r):t.native.query(this.text,r)}});var DO=E((Sne,FO)=>{"use strict";var OO;try{OO=require("pg-native")}catch(t){throw t}var TJ=Ad(),jO=require("events").EventEmitter,IJ=require("util"),kJ=ky(),$O=NO(),_r=FO.exports=function(t){jO.call(this),t=t||{},this._Promise=t.Promise||global.Promise,this._types=new TJ(t.types),this.native=new OO({types:this._types}),this._queryQueue=[],this._ending=!1,this._connecting=!1,this._connected=!1,this._queryable=!0;let e=this.connectionParameters=new kJ(t);t.nativeConnectionString&&(e.nativeConnectionString=t.nativeConnectionString),this.user=e.user,Object.defineProperty(this,"password",{configurable:!0,enumerable:!1,writable:!0,value:e.password}),this.database=e.database,this.host=e.host,this.port=e.port,this.namedQueries={}};_r.Query=$O;IJ.inherits(_r,jO);_r.prototype._errorAllQueries=function(t){let e=r=>{process.nextTick(()=>{r.native=this.native,r.handleError(t)})};this._hasActiveQuery()&&(e(this._activeQuery),this._activeQuery=null),this._queryQueue.forEach(e),this._queryQueue.length=0};_r.prototype._connect=function(t){let e=this;if(this._connecting){process.nextTick(()=>t(new Error("Client has already been connected. You cannot reuse a client.")));return}this._connecting=!0,this.connectionParameters.getLibpqConnectionString(function(r,n){if(e.connectionParameters.nativeConnectionString&&(n=e.connectionParameters.nativeConnectionString),r)return t(r);e.native.connect(n,function(i){if(i)return e.native.end(),t(i);e._connected=!0,e.native.on("error",function(a){e._queryable=!1,e._errorAllQueries(a),e.emit("error",a)}),e.native.on("notification",function(a){e.emit("notification",{channel:a.relname,payload:a.extra})}),e.emit("connect"),e._pulseQueryQueue(!0),t()})})};_r.prototype.connect=function(t){if(t){this._connect(t);return}return new this._Promise((e,r)=>{this._connect(n=>{n?r(n):e()})})};_r.prototype.query=function(t,e,r){let n,i,a,s,o;if(t==null)throw new TypeError("Client was passed a null or undefined query");if(typeof t.submit=="function")a=t.query_timeout||this.connectionParameters.query_timeout,i=n=t,typeof e=="function"&&(t.callback=e);else if(a=t.query_timeout||this.connectionParameters.query_timeout,n=new $O(t,e,r),!n.callback){let u,c;i=new this._Promise((f,m)=>{u=f,c=m}).catch(f=>{throw Error.captureStackTrace(f),f}),n.callback=(f,m)=>f?c(f):u(m)}return a&&(o=n.callback,s=setTimeout(()=>{let u=new Error("Query read timeout");process.nextTick(()=>{n.handleError(u,this.connection)}),o(u),n.callback=()=>{};let c=this._queryQueue.indexOf(n);c>-1&&this._queryQueue.splice(c,1),this._pulseQueryQueue()},a),n.callback=(u,c)=>{clearTimeout(s),o(u,c)}),this._queryable?this._ending?(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client was closed and is not queryable"))}),i):(this._queryQueue.push(n),this._pulseQueryQueue(),i):(n.native=this.native,process.nextTick(()=>{n.handleError(new Error("Client has encountered a connection error and is not queryable"))}),i)};_r.prototype.end=function(t){let e=this;this._ending=!0,this._connected||this.once("connect",this.end.bind(this,t));let r;return t||(r=new this._Promise(function(n,i){t=a=>a?i(a):n()})),this.native.end(function(){e._errorAllQueries(new Error("Connection terminated")),process.nextTick(()=>{e.emit("end"),t&&t()})}),r};_r.prototype._hasActiveQuery=function(){return this._activeQuery&&this._activeQuery.state!=="error"&&this._activeQuery.state!=="end"};_r.prototype._pulseQueryQueue=function(t){if(!this._connected||this._hasActiveQuery())return;let e=this._queryQueue.shift();if(!e){t||this.emit("drain");return}this._activeQuery=e,e.submit(this);let r=this;e.once("_done",function(){r._pulseQueryQueue()})};_r.prototype.cancel=function(t){this._activeQuery===t?this.native.cancel(function(){}):this._queryQueue.indexOf(t)!==-1&&this._queryQueue.splice(this._queryQueue.indexOf(t),1)};_r.prototype.ref=function(){};_r.prototype.unref=function(){};_r.prototype.setTypeParser=function(t,e,r){return this._types.setTypeParser(t,e,r)};_r.prototype.getTypeParser=function(t,e){return this._types.getTypeParser(t,e)}});var fv=E((Ene,MO)=>{"use strict";MO.exports=DO()});var pv=E((Cne,Bu)=>{"use strict";var RJ=AO(),NJ=Mu(),OJ=iv(),jJ=Ny(),$J=fo(),FJ=IO(),DJ=Ad(),{DatabaseError:MJ}=tv(),{escapeIdentifier:qJ,escapeLiteral:LJ}=fo(),BJ=t=>class extends FJ{constructor(r){super(r,t)}},mv=function(t){this.defaults=NJ,this.Client=t,this.Query=this.Client.Query,this.Pool=BJ(this.Client),this._pools=[],this.Connection=OJ,this.types=Du(),this.DatabaseError=MJ,this.TypeOverrides=DJ,this.escapeIdentifier=qJ,this.escapeLiteral=LJ,this.Result=jJ,this.utils=$J};typeof process.env.NODE_PG_FORCE_NATIVE<"u"?Bu.exports=new mv(fv()):(Bu.exports=new mv(RJ),Object.defineProperty(Bu.exports,"native",{configurable:!0,enumerable:!1,get(){let t=null;try{t=new mv(fv())}catch(e){if(e.code!=="MODULE_NOT_FOUND")throw e}return Object.defineProperty(Bu.exports,"native",{value:t}),t}}))});var kr,Pne,Tne,Ine,kne,Rne,Nne,One,jne,$ne,Fne,Dne,Ci,Fd=S(()=>{kr=er(pv(),1),Pne=kr.default.Client,Tne=kr.default.Pool,Ine=kr.default.Connection,kne=kr.default.types,Rne=kr.default.Query,Nne=kr.default.DatabaseError,One=kr.default.escapeIdentifier,jne=kr.default.escapeLiteral,$ne=kr.default.Result,Fne=kr.default.TypeOverrides,Dne=kr.default.defaults,Ci=kr.default});function F(t,e){if(!t||typeof t!="object")return!1;if(t instanceof e)return!0;if(!Object.prototype.hasOwnProperty.call(e,_))throw new Error(`Class "${e.name??"<unknown>"}" doesn't look like a Drizzle entity. If this is incorrect and the class is provided by Drizzle, please report this as a bug.`);let r=Object.getPrototypeOf(t).constructor;if(r)for(;r;){if(_ in r&&r[_]===e[_])return!0;r=Object.getPrototypeOf(r)}return!1}var _,qne,H=S(()=>{_=Symbol.for("drizzle:entityKind"),qne=Symbol.for("drizzle:hasOwnEntityKind")});var hv,Dd,Md,qd=S(()=>{H();hv=class{static[_]="ConsoleLogWriter";write(e){console.log(e)}},Dd=class{static[_]="DefaultLogger";writer;constructor(e){this.writer=e?.writer??new hv}logQuery(e,r){let n=r.map(a=>{try{return JSON.stringify(a)}catch{return String(a)}}),i=n.length?` -- params: [${n.join(", ")}]`:"";this.writer.write(`Query: ${e}${i}`)}},Md=class{static[_]="NoopLogger";logQuery(){}}});var nr,Ln=S(()=>{H();nr=class{static[_]="QueryPromise";[Symbol.toStringTag]="QueryPromise";catch(e){return this.then(void 0,e)}finally(e){return this.then(r=>(e?.(),r),r=>{throw e?.(),r})}then(e,r){return this.execute().then(e,r)}}});var De,yn=S(()=>{H();De=class{constructor(e,r){this.table=e,this.config=r,this.name=r.name,this.keyAsName=r.keyAsName,this.notNull=r.notNull,this.default=r.default,this.defaultFn=r.defaultFn,this.onUpdateFn=r.onUpdateFn,this.hasDefault=r.hasDefault,this.primary=r.primaryKey,this.isUnique=r.isUnique,this.uniqueName=r.uniqueName,this.uniqueType=r.uniqueType,this.dataType=r.dataType,this.columnType=r.columnType,this.generated=r.generated,this.generatedIdentity=r.generatedIdentity}static[_]="Column";name;keyAsName;primary;notNull;default;defaultFn;onUpdateFn;hasDefault;isUnique;uniqueName;uniqueType;dataType;columnType;enumValues=void 0;generated=void 0;generatedIdentity=void 0;config;mapFromDriverValue(e){return e}mapToDriverValue(e){return e}shouldDisableInsert(){return this.config.generated!==void 0&&this.config.generated.type!=="byDefault"}}});var Ld,gv=S(()=>{H();Ld=class{static[_]="ColumnBuilder";config;constructor(e,r,n){this.config={name:e,keyAsName:e==="",notNull:!1,default:void 0,hasDefault:!1,primaryKey:!1,isUnique:!1,uniqueName:void 0,uniqueType:void 0,dataType:r,columnType:n,generated:void 0}}$type(){return this}notNull(){return this.config.notNull=!0,this}default(e){return this.config.default=e,this.config.hasDefault=!0,this}$defaultFn(e){return this.config.defaultFn=e,this.config.hasDefault=!0,this}$default=this.$defaultFn;$onUpdateFn(e){return this.config.onUpdateFn=e,this.config.hasDefault=!0,this}$onUpdate=this.$onUpdateFn;primaryKey(){return this.config.primaryKey=!0,this.config.notNull=!0,this}setName(e){this.config.name===""&&(this.config.name=e)}}});var tn,Bd=S(()=>{tn=Symbol.for("drizzle:Name")});var Ud,yv,vv=S(()=>{H();Bd();Ud=class{static[_]="PgForeignKeyBuilder";reference;_onUpdate="no action";_onDelete="no action";constructor(e,r){this.reference=()=>{let{name:n,columns:i,foreignColumns:a}=e();return{name:n,columns:i,foreignTable:a[0].table,foreignColumns:a}},r&&(this._onUpdate=r.onUpdate,this._onDelete=r.onDelete)}onUpdate(e){return this._onUpdate=e===void 0?"no action":e,this}onDelete(e){return this._onDelete=e===void 0?"no action":e,this}build(e){return new yv(e,this)}},yv=class{constructor(e,r){this.table=e,this.reference=r.reference,this.onUpdate=r._onUpdate,this.onDelete=r._onDelete}static[_]="PgForeignKey";reference;onUpdate;onDelete;getName(){let{name:e,columns:r,foreignColumns:n}=this.reference(),i=r.map(o=>o.name),a=n.map(o=>o.name),s=[this.table[tn],...i,n[0].table[tn],...a];return e??`${s.join("_")}_fk`}}});function Vd(t,...e){return t(...e)}var bv=S(()=>{});function _v(t,e){return`${t[tn]}_${e.join("_")}_unique`}var xv,qO,wv,Sv=S(()=>{H();Bd();xv=class{constructor(e,r){this.name=r,this.columns=e}static[_]="PgUniqueConstraintBuilder";columns;nullsNotDistinctConfig=!1;nullsNotDistinct(){return this.nullsNotDistinctConfig=!0,this}build(e){return new wv(e,this.columns,this.nullsNotDistinctConfig,this.name)}},qO=class{static[_]="PgUniqueOnConstraintBuilder";name;constructor(e){this.name=e}on(...e){return new xv(e,this.name)}},wv=class{constructor(e,r,n,i){this.table=e,this.columns=r,this.name=i??_v(this.table,this.columns.map(a=>a.name)),this.nullsNotDistinct=n}static[_]="PgUniqueConstraint";columns;name;nullsNotDistinct=!1;getName(){return this.name}}});function LO(t,e,r){for(let n=e;n<t.length;n++){let i=t[n];if(i==="\\"){n++;continue}if(i==='"')return[t.slice(e,n).replace(/\\/g,""),n+1];if(!r&&(i===","||i==="}"))return[t.slice(e,n).replace(/\\/g,""),n]}return[t.slice(e).replace(/\\/g,""),t.length]}function BO(t,e=0){let r=[],n=e,i=!1;for(;n<t.length;){let a=t[n];if(a===","){(i||n===e)&&r.push(""),i=!0,n++;continue}if(i=!1,a==="\\"){n+=2;continue}if(a==='"'){let[u,c]=LO(t,n+1,!0);r.push(u),n=c;continue}if(a==="}")return[r,n+1];if(a==="{"){let[u,c]=BO(t,n+1);r.push(u),n=c;continue}let[s,o]=LO(t,n,!1);r.push(s),n=o}return[r,n]}function UO(t){let[e]=BO(t,1);return e}function Ev(t){return`{${t.map(e=>Array.isArray(e)?Ev(e):typeof e=="string"?`"${e.replace(/\\/g,"\\\\").replace(/"/g,'\\"')}"`:`${e}`).join(",")}}`}var Av=S(()=>{});var re,z,Cv,wo,Pv,Tv,Pe=S(()=>{gv();yn();H();vv();bv();Sv();Av();re=class extends Ld{foreignKeyConfigs=[];static[_]="PgColumnBuilder";array(e){return new Pv(this.config.name,this,e)}references(e,r={}){return this.foreignKeyConfigs.push({ref:e,actions:r}),this}unique(e,r){return this.config.isUnique=!0,this.config.uniqueName=e,this.config.uniqueType=r?.nulls,this}generatedAlwaysAs(e){return this.config.generated={as:e,type:"always",mode:"stored"},this}buildForeignKeys(e,r){return this.foreignKeyConfigs.map(({ref:n,actions:i})=>Vd((a,s)=>{let o=new Ud(()=>{let u=a();return{columns:[e],foreignColumns:[u]}});return s.onUpdate&&o.onUpdate(s.onUpdate),s.onDelete&&o.onDelete(s.onDelete),o.build(r)},n,i))}buildExtraConfigColumn(e){return new Cv(e,this.config)}},z=class extends De{constructor(e,r){r.uniqueName||(r.uniqueName=_v(e,[r.name])),super(e,r),this.table=e}static[_]="PgColumn"},Cv=class extends z{static[_]="ExtraConfigColumn";getSQLType(){return this.getSQLType()}indexConfig={order:this.config.order??"asc",nulls:this.config.nulls??"last",opClass:this.config.opClass};defaultConfig={order:"asc",nulls:"last",opClass:void 0};asc(){return this.indexConfig.order="asc",this}desc(){return this.indexConfig.order="desc",this}nullsFirst(){return this.indexConfig.nulls="first",this}nullsLast(){return this.indexConfig.nulls="last",this}op(e){return this.indexConfig.opClass=e,this}},wo=class{static[_]="IndexedColumn";constructor(e,r,n,i){this.name=e,this.keyAsName=r,this.type=n,this.indexConfig=i}name;keyAsName;type;indexConfig},Pv=class extends re{static[_]="PgArrayBuilder";constructor(e,r,n){super(e,"array","PgArray"),this.config.baseBuilder=r,this.config.size=n}build(e){let r=this.config.baseBuilder.build(e);return new Tv(e,this.config,r)}},Tv=class t extends z{constructor(e,r,n,i){super(e,r),this.baseColumn=n,this.range=i,this.size=r.size}size;static[_]="PgArray";getSQLType(){return`${this.baseColumn.getSQLType()}[${typeof this.size=="number"?this.size:""}]`}mapFromDriverValue(e){return typeof e=="string"&&(e=UO(e)),e.map(r=>this.baseColumn.mapFromDriverValue(r))}mapToDriverValue(e,r=!1){let n=e.map(i=>i===null?null:F(this.baseColumn,t)?this.baseColumn.mapToDriverValue(i,!0):this.baseColumn.mapToDriverValue(i));return r?n:Ev(n)}}});function VO(t){return!!t&&typeof t=="function"&&Iv in t&&t[Iv]===!0}function zO(t,e,r){let n=Object.assign(i=>new kv(i??"",n),{enumName:t,enumValues:e,schema:r,[Iv]:!0});return n}var Iv,kv,Rv,zd=S(()=>{H();Pe();Iv=Symbol.for("drizzle:isPgEnum");kv=class extends re{static[_]="PgEnumColumnBuilder";constructor(e,r){super(e,"string","PgEnumColumn"),this.config.enum=r}build(e){return new Rv(e,this.config)}},Rv=class extends z{static[_]="PgEnumColumn";enum=this.config.enum;enumValues=this.config.enum.enumValues;constructor(e,r){super(e,r),this.enum=r.enum}getSQLType(){return this.enum.enumName}}});var Tt,_o,vn=S(()=>{H();Tt=class{static[_]="Subquery";constructor(e,r,n,i=!1){this._={brand:"Subquery",sql:e,selectedFields:r,alias:n,isWith:i}}},_o=class extends Tt{static[_]="WithSubquery"}});var HO,QO=S(()=>{HO="0.39.3"});var Nv,Ov,tt,Bn=S(()=>{bv();QO();tt={startActiveSpan(t,e){return Nv?(Ov||(Ov=Nv.trace.getTracer("drizzle-orm",HO)),Vd((r,n)=>n.startActiveSpan(t,i=>{try{return e(i)}catch(a){throw i.setStatus({code:r.SpanStatusCode.ERROR,message:a instanceof Error?a.message:"Unknown error"}),a}finally{i.end()}}),Nv,Ov)):e()}}});var rt,Un=S(()=>{rt=Symbol.for("drizzle:ViewBaseConfig")});function Fv(t){return typeof t=="object"&&t!==null&&GO in t}function Sr(t){return t[tn]}function Da(t){return`${t[Hd]??"public"}.${t[tn]}`}var Hd,Qd,WO,jv,$v,Uu,KO,GO,K,Er=S(()=>{H();Bd();Hd=Symbol.for("drizzle:Schema"),Qd=Symbol.for("drizzle:Columns"),WO=Symbol.for("drizzle:ExtraConfigColumns"),jv=Symbol.for("drizzle:OriginalName"),$v=Symbol.for("drizzle:BaseName"),Uu=Symbol.for("drizzle:IsAlias"),KO=Symbol.for("drizzle:ExtraConfigBuilder"),GO=Symbol.for("drizzle:IsDrizzleTable"),K=class{static[_]="Table";static Symbol={Name:tn,Schema:Hd,OriginalName:jv,Columns:Qd,ExtraConfigColumns:WO,BaseName:$v,IsAlias:Uu,ExtraConfigBuilder:KO};[tn];[jv];[Hd];[Qd];[WO];[$v];[Uu]=!1;[GO]=!0;[KO]=void 0;constructor(e,r,n){this[tn]=this[jv]=e,this[Hd]=r,this[$v]=n}}});function Dv(t){return t!=null&&typeof t.getSQL=="function"}function UJ(t){let e={sql:"",params:[]};for(let r of t)e.sql+=r.sql,e.params.push(...r.params),r.typings?.length&&(e.typings||(e.typings=[]),e.typings.push(...r.typings));return e}function YO(t){return typeof t=="object"&&t!==null&&"mapToDriverValue"in t&&typeof t.mapToDriverValue=="function"}function y(t,...e){let r=[];(e.length>0||t.length>0&&t[0]!=="")&&r.push(new It(t[0]));for(let[n,i]of e.entries())r.push(i,new It(t[n+1]));return new G(r)}function Mv(t,e){return t.map(r=>{if(F(r,Vn)){if(!(r.name in e))throw new Error(`No value for placeholder "${r.name}" was provided`);return e[r.name]}if(F(r,Ar)&&F(r.value,Vn)){if(!(r.value.name in e))throw new Error(`No value for placeholder "${r.value.name}" was provided`);return r.encoder.mapToDriverValue(e[r.value.name])}return r})}function tj(t){return typeof t=="object"&&t!==null&&ej in t}var JO,It,G,Vu,XO,ZO,Nie,Ar,Vn,ej,mr,kt=S(()=>{H();zd();vn();Bn();Un();yn();Er();JO=class{static[_]="FakePrimitiveParam"};It=class{static[_]="StringChunk";value;constructor(e){this.value=Array.isArray(e)?e:[e]}getSQL(){return new G([this])}},G=class t{constructor(e){this.queryChunks=e}static[_]="SQL";decoder=XO;shouldInlineParams=!1;append(e){return this.queryChunks.push(...e.queryChunks),this}toQuery(e){return tt.startActiveSpan("drizzle.buildSQL",r=>{let n=this.buildQueryFromSourceParams(this.queryChunks,e);return r?.setAttributes({"drizzle.query.text":n.sql,"drizzle.query.params":JSON.stringify(n.params)}),n})}buildQueryFromSourceParams(e,r){let n=Object.assign({},r,{inlineParams:r.inlineParams||this.shouldInlineParams,paramStartIndex:r.paramStartIndex||{value:0}}),{casing:i,escapeName:a,escapeParam:s,prepareTyping:o,inlineParams:u,paramStartIndex:c}=n;return UJ(e.map(f=>{if(F(f,It))return{sql:f.value.join(""),params:[]};if(F(f,Vu))return{sql:a(f.value),params:[]};if(f===void 0)return{sql:"",params:[]};if(Array.isArray(f)){let m=[new It("(")];for(let[l,p]of f.entries())m.push(p),l<f.length-1&&m.push(new It(", "));return m.push(new It(")")),this.buildQueryFromSourceParams(m,n)}if(F(f,t))return this.buildQueryFromSourceParams(f.queryChunks,{...n,inlineParams:u||f.shouldInlineParams});if(F(f,K)){let m=f[K.Symbol.Schema],l=f[K.Symbol.Name];return{sql:m===void 0||f[Uu]?a(l):a(m)+"."+a(l),params:[]}}if(F(f,De)){let m=i.getColumnCasing(f);if(r.invokeSource==="indexes")return{sql:a(m),params:[]};let l=f.table[K.Symbol.Schema];return{sql:f.table[Uu]||l===void 0?a(f.table[K.Symbol.Name])+"."+a(m):a(l)+"."+a(f.table[K.Symbol.Name])+"."+a(m),params:[]}}if(F(f,mr)){let m=f[rt].schema,l=f[rt].name;return{sql:m===void 0||f[rt].isAlias?a(l):a(m)+"."+a(l),params:[]}}if(F(f,Ar)){if(F(f.value,Vn))return{sql:s(c.value++,f),params:[f],typings:["none"]};let m=f.value===null?null:f.encoder.mapToDriverValue(f.value);if(F(m,t))return this.buildQueryFromSourceParams([m],n);if(u)return{sql:this.mapInlineParam(m,n),params:[]};let l=["none"];return o&&(l=[o(f.encoder)]),{sql:s(c.value++,m),params:[m],typings:l}}return F(f,Vn)?{sql:s(c.value++,f),params:[f],typings:["none"]}:F(f,t.Aliased)&&f.fieldAlias!==void 0?{sql:a(f.fieldAlias),params:[]}:F(f,Tt)?f._.isWith?{sql:a(f._.alias),params:[]}:this.buildQueryFromSourceParams([new It("("),f._.sql,new It(") "),new Vu(f._.alias)],n):VO(f)?f.schema?{sql:a(f.schema)+"."+a(f.enumName),params:[]}:{sql:a(f.enumName),params:[]}:Dv(f)?f.shouldOmitSQLParens?.()?this.buildQueryFromSourceParams([f.getSQL()],n):this.buildQueryFromSourceParams([new It("("),f.getSQL(),new It(")")],n):u?{sql:this.mapInlineParam(f,n),params:[]}:{sql:s(c.value++,f),params:[f],typings:["none"]}}))}mapInlineParam(e,{escapeString:r}){if(e===null)return"null";if(typeof e=="number"||typeof e=="boolean")return e.toString();if(typeof e=="string")return r(e);if(typeof e=="object"){let n=e.toString();return r(n==="[object Object]"?JSON.stringify(e):n)}throw new Error("Unexpected param value: "+e)}getSQL(){return this}as(e){return e===void 0?this:new t.Aliased(this,e)}mapWith(e){return this.decoder=typeof e=="function"?{mapFromDriverValue:e}:e,this}inlineParams(){return this.shouldInlineParams=!0,this}if(e){return e?this:void 0}},Vu=class{constructor(e){this.value=e}static[_]="Name";brand;getSQL(){return new G([this])}};XO={mapFromDriverValue:t=>t},ZO={mapToDriverValue:t=>t},Nie={...XO,...ZO},Ar=class{constructor(e,r=ZO){this.value=e,this.encoder=r}static[_]="Param";brand;getSQL(){return new G([this])}};(t=>{function e(){return new G([])}t.empty=e;function r(u){return new G(u)}t.fromList=r;function n(u){return new G([new It(u)])}t.raw=n;function i(u,c){let f=[];for(let[m,l]of u.entries())m>0&&c!==void 0&&f.push(c),f.push(l);return new G(f)}t.join=i;function a(u){return new Vu(u)}t.identifier=a;function s(u){return new Vn(u)}t.placeholder=s;function o(u,c){return new Ar(u,c)}t.param=o})(y||(y={}));(t=>{class e{constructor(n,i){this.sql=n,this.fieldAlias=i}static[_]="SQL.Aliased";isSelectionField=!1;getSQL(){return this.sql}clone(){return new e(this.sql,this.fieldAlias)}}t.Aliased=e})(G||(G={}));Vn=class{constructor(e){this.name=e}static[_]="Placeholder";getSQL(){return new G([this])}};ej=Symbol.for("drizzle:IsDrizzleView"),mr=class{static[_]="View";[rt];[ej]=!0;constructor({name:e,schema:r,selectedFields:n,query:i}){this[rt]={name:e,originalName:e,schema:r,selectedFields:n,query:i,isExisting:!i,isAlias:!1}}getSQL(){return new G([this])}};De.prototype.getSQL=function(){return new G([this])};K.prototype.getSQL=function(){return new G([this])};Tt.prototype.getSQL=function(){return new G([this])}});function zu(t,e){return new Proxy(t,new So(e,!1))}function bn(t,e){return new Proxy(t,new Ma(new Proxy(t.table,new So(e,!1))))}function qv(t,e){return new G.Aliased(Hu(t.sql,e),t.fieldAlias)}function Hu(t,e){return y.join(t.queryChunks.map(r=>F(r,De)?bn(r,e):F(r,G)?Hu(r,e):F(r,G.Aliased)?qv(r,e):r))}var Ma,So,rj,Wd=S(()=>{yn();H();kt();Er();Un();Ma=class{constructor(e){this.table=e}static[_]="ColumnAliasProxyHandler";get(e,r){return r==="table"?this.table:e[r]}},So=class{constructor(e,r){this.alias=e,this.replaceOriginalName=r}static[_]="TableAliasProxyHandler";get(e,r){if(r===K.Symbol.IsAlias)return!0;if(r===K.Symbol.Name)return this.alias;if(this.replaceOriginalName&&r===K.Symbol.OriginalName)return this.alias;if(r===rt)return{...e[rt],name:this.alias,isAlias:!0};if(r===K.Symbol.Columns){let i=e[K.Symbol.Columns];if(!i)return i;let a={};return Object.keys(i).map(s=>{a[s]=new Proxy(i[s],new Ma(new Proxy(e,this)))}),a}let n=e[r];return F(n,De)?new Proxy(n,new Ma(new Proxy(e,this))):n}},rj=class{constructor(e){this.alias=e}static[_]="RelationTableAliasProxyHandler";get(e,r){return r==="sourceTable"?zu(e.sourceTable,this.alias):e[r]}}});var Ge,Pi=S(()=>{Wd();yn();H();kt();vn();Un();Ge=class t{static[_]="SelectionProxyHandler";config;constructor(e){this.config={...e}}get(e,r){if(r==="_")return{...e._,selectedFields:new Proxy(e._.selectedFields,this)};if(r===rt)return{...e[rt],selectedFields:new Proxy(e[rt].selectedFields,this)};if(typeof r=="symbol")return e[r];let i=(F(e,Tt)?e._.selectedFields:F(e,mr)?e[rt].selectedFields:e)[r];if(F(i,G.Aliased)){if(this.config.sqlAliasedBehavior==="sql"&&!i.isSelectionField)return i.sql;let a=i.clone();return a.isSelectionField=!0,a}if(F(i,G)){if(this.config.sqlBehavior==="sql")return i;throw new Error(`You tried to reference "${r}" field from a subquery, which is a raw SQL field, but it doesn't have an alias declared. Please add an alias to the field using ".as('alias')" method.`)}return F(i,De)?this.config.alias?new Proxy(i,new Ma(new Proxy(i.table,new So(this.config.alias,this.config.replaceOriginalName??!1)))):i:typeof i!="object"||i===null?i:new Proxy(i,new t(this.config))}}});function nj(t,e,r){let n={},i=t.reduce((a,{path:s,field:o},u)=>{let c;F(o,De)?c=o:F(o,G)?c=o.decoder:c=o.sql.decoder;let f=a;for(let[m,l]of s.entries())if(m<s.length-1)l in f||(f[l]={}),f=f[l];else{let p=e[u],d=f[l]=p===null?null:c.mapFromDriverValue(p);if(r&&F(o,De)&&s.length===2){let h=s[0];h in n?typeof n[h]=="string"&&n[h]!==Sr(o.table)&&(n[h]=!1):n[h]=d===null?Sr(o.table):!1}}return a},{});if(r&&Object.keys(n).length>0)for(let[a,s]of Object.entries(n))typeof s=="string"&&!r[s]&&(i[a]=null);return i}function Qr(t,e){return Object.entries(t).reduce((r,[n,i])=>{if(typeof n!="string")return r;let a=e?[...e,n]:[n];return F(i,De)||F(i,G)||F(i,G.Aliased)?r.push({path:a,field:i}):F(i,K)?r.push(...Qr(i[K.Symbol.Columns],a)):r.push(...Qr(i,a)),r},[])}function Qu(t,e){let r=Object.keys(t),n=Object.keys(e);if(r.length!==n.length)return!1;for(let[i,a]of r.entries())if(a!==n[i])return!1;return!0}function Kd(t,e){let r=Object.entries(e).filter(([,n])=>n!==void 0).map(([n,i])=>F(i,G)||F(i,De)?[n,i]:[n,new Ar(i,t[K.Symbol.Columns][n])]);if(r.length===0)throw new Error("No values to set");return Object.fromEntries(r)}function ij(t,e){for(let r of e)for(let n of Object.getOwnPropertyNames(r.prototype))n!=="constructor"&&Object.defineProperty(t.prototype,n,Object.getOwnPropertyDescriptor(r.prototype,n)||Object.create(null))}function qa(t){return t[K.Symbol.Columns]}function aj(t){return t[rt].selectedFields}function zn(t){return F(t,Tt)?t._.alias:F(t,mr)?t[rt].name:F(t,G)?void 0:t[K.Symbol.IsAlias]?t[K.Symbol.Name]:t[K.Symbol.BaseName]}function ke(t,e){return{name:typeof t=="string"&&t.length>0?t:"",config:typeof t=="object"?t:e}}function sj(t){if(typeof t!="object"||t===null||t.constructor.name!=="Object")return!1;if("logger"in t){let e=typeof t.logger;return!(e!=="boolean"&&(e!=="object"||typeof t.logger.logQuery!="function")&&e!=="undefined")}if("schema"in t){let e=typeof t.logger;return!(e!=="object"&&e!=="undefined")}if("casing"in t){let e=typeof t.logger;return!(e!=="string"&&e!=="undefined")}if("mode"in t)return!(t.mode!=="default"||t.mode!=="planetscale"||t.mode!==void 0);if("connection"in t){let e=typeof t.connection;return!(e!=="string"&&e!=="object"&&e!=="undefined")}if("client"in t){let e=typeof t.client;return!(e!=="object"&&e!=="function"&&e!=="undefined")}return Object.keys(t).length===0}var Je=S(()=>{yn();H();kt();vn();Er();Un()});var Wu,oj=S(()=>{H();Ln();Pi();Er();Bn();Je();Wu=class extends nr{constructor(e,r,n,i){super(),this.session=r,this.dialect=n,this.config={table:e,withList:i}}static[_]="PgDelete";config;where(e){return this.config.where=e,this}returning(e=this.config.table[K.Symbol.Columns]){return this.config.returningFields=e,this.config.returning=Qr(e),this}getSQL(){return this.dialect.buildDeleteQuery(this.config)}toSQL(){let{typings:e,...r}=this.dialect.sqlToQuery(this.getSQL());return r}_prepare(e){return tt.startActiveSpan("drizzle.prepareQuery",()=>this.session.prepareQuery(this.dialect.sqlToQuery(this.getSQL()),this.config.returning,e,!0))}prepare(e){return this._prepare(e)}authToken;setToken(e){return this.authToken=e,this}execute=e=>tt.startActiveSpan("drizzle.operation",()=>this._prepare().execute(e,this.authToken));getSelectedFields(){return this.config.returningFields?new Proxy(this.config.returningFields,new Ge({alias:Sr(this.config.table),sqlAliasedBehavior:"alias",sqlBehavior:"error"})):void 0}$dynamic(){return this}}});function VJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).map(r=>r.toLowerCase()).join("_")}function zJ(t){return(t.replace(/['\u2019]/g,"").match(/[\da-z]+|[A-Z]+(?![a-z])|[A-Z][\da-z]+/g)??[]).reduce((r,n,i)=>{let a=i===0?n.toLowerCase():`${n[0].toUpperCase()}${n.slice(1)}`;return r+a},"")}function HJ(t){return t}var Gd,cj=S(()=>{H();Er();Gd=class{static[_]="CasingCache";cache={};cachedTables={};convert;constructor(e){this.convert=e==="snake_case"?VJ:e==="camelCase"?zJ:HJ}getColumnCasing(e){if(!e.keyAsName)return e.name;let r=e.table[K.Symbol.Schema]??"public",n=e.table[K.Symbol.OriginalName],i=`${r}.${n}.${e.name}`;return this.cache[i]||this.cacheTable(e.table),this.cache[i]}cacheTable(e){let r=e[K.Symbol.Schema]??"public",n=e[K.Symbol.OriginalName],i=`${r}.${n}`;if(!this.cachedTables[i]){for(let a of Object.values(e[K.Symbol.Columns])){let s=`${i}.${a.name}`;this.cache[s]=this.convert(a.name)}this.cachedTables[i]=!0}}clearCache(){this.cache={},this.cachedTables={}}}});var Ku,Jd,Yd=S(()=>{H();Ku=class extends Error{static[_]="DrizzleError";constructor({message:e,cause:r}){super(e),this.name="DrizzleError",this.cause=r}},Jd=class extends Ku{static[_]="TransactionRollbackError";constructor(){super({message:"Rollback"})}}});var Hn,Gu=S(()=>{H();Pe();Hn=class extends re{static[_]="PgIntColumnBaseBuilder";generatedAlwaysAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"always",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"always"};return this.config.hasDefault=!0,this.config.notNull=!0,this}generatedByDefaultAsIdentity(e){if(e){let{name:r,...n}=e;this.config.generatedIdentity={type:"byDefault",sequenceName:r,sequenceOptions:n}}else this.config.generatedIdentity={type:"byDefault"};return this.config.hasDefault=!0,this.config.notNull=!0,this}}});function Ju(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Lv(r):new Uv(r)}var Lv,Bv,Uv,Vv,zv=S(()=>{H();Je();Pe();Gu();Lv=class extends Hn{static[_]="PgBigInt53Builder";constructor(e){super(e,"number","PgBigInt53")}build(e){return new Bv(e,this.config)}},Bv=class extends z{static[_]="PgBigInt53";getSQLType(){return"bigint"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Uv=class extends Hn{static[_]="PgBigInt64Builder";constructor(e){super(e,"bigint","PgBigInt64")}build(e){return new Vv(e,this.config)}},Vv=class extends z{static[_]="PgBigInt64";getSQLType(){return"bigint"}mapFromDriverValue(e){return BigInt(e)}}});function uj(t,e){let{name:r,config:n}=ke(t,e);return n.mode==="number"?new Hv(r):new Wv(r)}var Hv,Qv,Wv,Kv,Gv=S(()=>{H();Je();Pe();Hv=class extends re{static[_]="PgBigSerial53Builder";constructor(e){super(e,"number","PgBigSerial53"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new Qv(e,this.config)}},Qv=class extends z{static[_]="PgBigSerial53";getSQLType(){return"bigserial"}mapFromDriverValue(e){return typeof e=="number"?e:Number(e)}},Wv=class extends re{static[_]="PgBigSerial64Builder";constructor(e){super(e,"bigint","PgBigSerial64"),this.config.hasDefault=!0}build(e){return new Kv(e,this.config)}},Kv=class extends z{static[_]="PgBigSerial64";getSQLType(){return"bigserial"}mapFromDriverValue(e){return BigInt(e)}}});function Ti(t){return new Jv(t??"")}var Jv,Yv,Xv=S(()=>{H();Pe();Jv=class extends re{static[_]="PgBooleanBuilder";constructor(e){super(e,"boolean","PgBoolean")}build(e){return new Yv(e,this.config)}},Yv=class extends z{static[_]="PgBoolean";getSQLType(){return"boolean"}}});function lj(t,e={}){let{name:r,config:n}=ke(t,e);return new Zv(r,n)}var Zv,eb,tb=S(()=>{H();Je();Pe();Zv=class extends re{static[_]="PgCharBuilder";constructor(e,r){super(e,"string","PgChar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new eb(e,this.config)}},eb=class extends z{static[_]="PgChar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"char":`char(${this.length})`}}});function pj(t){return new rb(t??"")}var rb,nb,ib=S(()=>{H();Pe();rb=class extends re{static[_]="PgCidrBuilder";constructor(e){super(e,"string","PgCidr")}build(e){return new nb(e,this.config)}},nb=class extends z{static[_]="PgCidr";getSQLType(){return"cidr"}}});function dj(t){return(e,r)=>{let{name:n,config:i}=ke(e,r);return new ab(n,i,t)}}var ab,sb,ob=S(()=>{H();Je();Pe();ab=class extends re{static[_]="PgCustomColumnBuilder";constructor(e,r,n){super(e,"custom","PgCustomColumn"),this.config.fieldConfig=r,this.config.customTypeParams=n}build(e){return new sb(e,this.config)}},sb=class extends z{static[_]="PgCustomColumn";sqlName;mapTo;mapFrom;constructor(e,r){super(e,r),this.sqlName=r.customTypeParams.dataType(r.fieldConfig),this.mapTo=r.customTypeParams.toDriver,this.mapFrom=r.customTypeParams.fromDriver}getSQLType(){return this.sqlName}mapFromDriverValue(e){return typeof this.mapFrom=="function"?this.mapFrom(e):e}mapToDriverValue(e){return typeof this.mapTo=="function"?this.mapTo(e):e}}});var xn,Xd=S(()=>{H();kt();Pe();xn=class extends re{static[_]="PgDateColumnBaseBuilder";defaultNow(){return this.default(y`now()`)}}});function fj(t,e){let{name:r,config:n}=ke(t,e);return n?.mode==="date"?new cb(r):new ub(r)}var cb,Yu,ub,Xu,lb=S(()=>{H();Je();Pe();Xd();cb=class extends xn{static[_]="PgDateBuilder";constructor(e){super(e,"date","PgDate")}build(e){return new Yu(e,this.config)}},Yu=class extends z{static[_]="PgDate";getSQLType(){return"date"}mapFromDriverValue(e){return new Date(e)}mapToDriverValue(e){return e.toISOString()}},ub=class extends xn{static[_]="PgDateStringBuilder";constructor(e){super(e,"string","PgDateString")}build(e){return new Xu(e,this.config)}},Xu=class extends z{static[_]="PgDateString";getSQLType(){return"date"}}});function mj(t){return new pb(t??"")}var pb,db,fb=S(()=>{H();Pe();pb=class extends re{static[_]="PgDoublePrecisionBuilder";constructor(e){super(e,"number","PgDoublePrecision")}build(e){return new db(e,this.config)}},db=class extends z{static[_]="PgDoublePrecision";getSQLType(){return"double precision"}mapFromDriverValue(e){return typeof e=="string"?Number.parseFloat(e):e}}});function hj(t){return new mb(t??"")}var mb,hb,gb=S(()=>{H();Pe();mb=class extends re{static[_]="PgInetBuilder";constructor(e){super(e,"string","PgInet")}build(e){return new hb(e,this.config)}},hb=class extends z{static[_]="PgInet";getSQLType(){return"inet"}}});function Z(t){return new yb(t??"")}var yb,vb,bb=S(()=>{H();Pe();Gu();yb=class extends Hn{static[_]="PgIntegerBuilder";constructor(e){super(e,"number","PgInteger")}build(e){return new vb(e,this.config)}},vb=class extends z{static[_]="PgInteger";getSQLType(){return"integer"}mapFromDriverValue(e){return typeof e=="string"?Number.parseInt(e):e}}});function gj(t,e={}){let{name:r,config:n}=ke(t,e);return new xb(r,n)}var xb,wb,_b=S(()=>{H();Je();Pe();xb=class extends re{static[_]="PgIntervalBuilder";constructor(e,r){super(e,"string","PgInterval"),this.config.intervalConfig=r}build(e){return new wb(e,this.config)}},wb=class extends z{static[_]="PgInterval";fields=this.config.intervalConfig.fields;precision=this.config.intervalConfig.precision;getSQLType(){let e=this.fields?` ${this.fields}`:"",r=this.precision?`(${this.precision})`:"";return`interval${e}${r}`}}});function yj(t){return new Sb(t??"")}var Sb,Zu,Eb=S(()=>{H();Pe();Sb=class extends re{static[_]="PgJsonBuilder";constructor(e){super(e,"json","PgJson")}build(e){return new Zu(e,this.config)}},Zu=class extends z{static[_]="PgJson";constructor(e,r){super(e,r)}getSQLType(){return"json"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function Qe(t){return new Ab(t??"")}var Ab,el,Cb=S(()=>{H();Pe();Ab=class extends re{static[_]="PgJsonbBuilder";constructor(e){super(e,"json","PgJsonb")}build(e){return new el(e,this.config)}},el=class extends z{static[_]="PgJsonb";constructor(e,r){super(e,r)}getSQLType(){return"jsonb"}mapToDriverValue(e){return JSON.stringify(e)}mapFromDriverValue(e){if(typeof e=="string")try{return JSON.parse(e)}catch{return e}return e}}});function vj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Pb(r):new Ib(r)}var Pb,Tb,Ib,kb,Rb=S(()=>{H();Je();Pe();Pb=class extends re{static[_]="PgLineBuilder";constructor(e){super(e,"array","PgLine")}build(e){return new Tb(e,this.config)}},Tb=class extends z{static[_]="PgLine";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n),Number.parseFloat(i)]}mapToDriverValue(e){return`{${e[0]},${e[1]},${e[2]}}`}},Ib=class extends re{static[_]="PgLineABCBuilder";constructor(e){super(e,"json","PgLineABC")}build(e){return new kb(e,this.config)}},kb=class extends z{static[_]="PgLineABC";getSQLType(){return"line"}mapFromDriverValue(e){let[r,n,i]=e.slice(1,-1).split(",");return{a:Number.parseFloat(r),b:Number.parseFloat(n),c:Number.parseFloat(i)}}mapToDriverValue(e){return`{${e.a},${e.b},${e.c}}`}}});function bj(t){return new Nb(t??"")}var Nb,Ob,jb=S(()=>{H();Pe();Nb=class extends re{static[_]="PgMacaddrBuilder";constructor(e){super(e,"string","PgMacaddr")}build(e){return new Ob(e,this.config)}},Ob=class extends z{static[_]="PgMacaddr";getSQLType(){return"macaddr"}}});function xj(t){return new $b(t??"")}var $b,Fb,Db=S(()=>{H();Pe();$b=class extends re{static[_]="PgMacaddr8Builder";constructor(e){super(e,"string","PgMacaddr8")}build(e){return new Fb(e,this.config)}},Fb=class extends z{static[_]="PgMacaddr8";getSQLType(){return"macaddr8"}}});function qb(t,e){let{name:r,config:n}=ke(t,e);return new Mb(r,n?.precision,n?.scale)}var Mb,tl,Kt,Lb=S(()=>{H();Je();Pe();Mb=class extends re{static[_]="PgNumericBuilder";constructor(e,r,n){super(e,"string","PgNumeric"),this.config.precision=r,this.config.scale=n}build(e){return new tl(e,this.config)}},tl=class extends z{static[_]="PgNumeric";precision;scale;constructor(e,r){super(e,r),this.precision=r.precision,this.scale=r.scale}getSQLType(){return this.precision!==void 0&&this.scale!==void 0?`numeric(${this.precision}, ${this.scale})`:this.precision===void 0?"numeric":`numeric(${this.precision})`}};Kt=qb});function wj(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Bb(r):new Vb(r)}var Bb,Ub,Vb,zb,Hb=S(()=>{H();Je();Pe();Bb=class extends re{static[_]="PgPointTupleBuilder";constructor(e){super(e,"array","PgPointTuple")}build(e){return new Ub(e,this.config)}},Ub=class extends z{static[_]="PgPointTuple";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return[Number.parseFloat(r),Number.parseFloat(n)]}return[e.x,e.y]}mapToDriverValue(e){return`(${e[0]},${e[1]})`}},Vb=class extends re{static[_]="PgPointObjectBuilder";constructor(e){super(e,"json","PgPointObject")}build(e){return new zb(e,this.config)}},zb=class extends z{static[_]="PgPointObject";getSQLType(){return"point"}mapFromDriverValue(e){if(typeof e=="string"){let[r,n]=e.slice(1,-1).split(",");return{x:Number.parseFloat(r),y:Number.parseFloat(n)}}return e}mapToDriverValue(e){return`(${e.x},${e.y})`}}});function QJ(t){let e=[];for(let r=0;r<t.length;r+=2)e.push(Number.parseInt(t.slice(r,r+2),16));return new Uint8Array(e)}function _j(t,e){let r=new ArrayBuffer(8),n=new DataView(r);for(let i=0;i<8;i++)n.setUint8(i,t[e+i]);return n.getFloat64(0,!0)}function Qb(t){let e=QJ(t),r=0,n=e[r];r+=1;let i=new DataView(e.buffer),a=i.getUint32(r,n===1);r+=4;let s;if(a&536870912&&(s=i.getUint32(r,n===1),r+=4),(a&65535)===1){let o=_j(e,r);r+=8;let u=_j(e,r);return r+=8,[o,u]}throw new Error("Unsupported geometry type")}var Sj=S(()=>{});function Ej(t,e){let{name:r,config:n}=ke(t,e);return!n?.mode||n.mode==="tuple"?new Wb(r):new Gb(r)}var Wb,Kb,Gb,Jb,Yb=S(()=>{H();Je();Pe();Sj();Wb=class extends re{static[_]="PgGeometryBuilder";constructor(e){super(e,"array","PgGeometry")}build(e){return new Kb(e,this.config)}},Kb=class extends z{static[_]="PgGeometry";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){return Qb(e)}mapToDriverValue(e){return`point(${e[0]} ${e[1]})`}},Gb=class extends re{static[_]="PgGeometryObjectBuilder";constructor(e){super(e,"json","PgGeometryObject")}build(e){return new Jb(e,this.config)}},Jb=class extends z{static[_]="PgGeometryObject";getSQLType(){return"geometry(point)"}mapFromDriverValue(e){let r=Qb(e);return{x:r[0],y:r[1]}}mapToDriverValue(e){return`point(${e.x} ${e.y})`}}});function Aj(t){return new Xb(t??"")}var Xb,Zb,ex=S(()=>{H();Pe();Xb=class extends re{static[_]="PgRealBuilder";constructor(e,r){super(e,"number","PgReal"),this.config.length=r}build(e){return new Zb(e,this.config)}},Zb=class extends z{static[_]="PgReal";constructor(e,r){super(e,r)}getSQLType(){return"real"}mapFromDriverValue=e=>typeof e=="string"?Number.parseFloat(e):e}});function Ye(t){return new tx(t??"")}var tx,rx,nx=S(()=>{H();Pe();tx=class extends re{static[_]="PgSerialBuilder";constructor(e){super(e,"number","PgSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new rx(e,this.config)}},rx=class extends z{static[_]="PgSerial";getSQLType(){return"serial"}}});function Cj(t){return new ix(t??"")}var ix,ax,sx=S(()=>{H();Pe();Gu();ix=class extends Hn{static[_]="PgSmallIntBuilder";constructor(e){super(e,"number","PgSmallInt")}build(e){return new ax(e,this.config)}},ax=class extends z{static[_]="PgSmallInt";getSQLType(){return"smallint"}mapFromDriverValue=e=>typeof e=="string"?Number(e):e}});function Pj(t){return new ox(t??"")}var ox,cx,ux=S(()=>{H();Pe();ox=class extends re{static[_]="PgSmallSerialBuilder";constructor(e){super(e,"number","PgSmallSerial"),this.config.hasDefault=!0,this.config.notNull=!0}build(e){return new cx(e,this.config)}},cx=class extends z{static[_]="PgSmallSerial";getSQLType(){return"smallserial"}}});function $(t,e={}){let{name:r,config:n}=ke(t,e);return new lx(r,n)}var lx,px,dx=S(()=>{H();Je();Pe();lx=class extends re{static[_]="PgTextBuilder";constructor(e,r){super(e,"string","PgText"),this.config.enumValues=r.enum}build(e){return new px(e,this.config)}},px=class extends z{static[_]="PgText";enumValues=this.config.enumValues;getSQLType(){return"text"}}});function Tj(t,e={}){let{name:r,config:n}=ke(t,e);return new fx(r,n.withTimezone??!1,n.precision)}var fx,rl,mx=S(()=>{H();Je();Pe();Xd();fx=class extends xn{constructor(e,r,n){super(e,"string","PgTime"),this.withTimezone=r,this.precision=n,this.config.withTimezone=r,this.config.precision=n}static[_]="PgTimeBuilder";build(e){return new rl(e,this.config)}},rl=class extends z{static[_]="PgTime";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`time${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function we(t,e={}){let{name:r,config:n}=ke(t,e);return n?.mode==="string"?new gx(r,n.withTimezone??!1,n.precision):new hx(r,n?.withTimezone??!1,n?.precision)}var hx,nl,gx,il,yx=S(()=>{H();Je();Pe();Xd();hx=class extends xn{static[_]="PgTimestampBuilder";constructor(e,r,n){super(e,"date","PgTimestamp"),this.config.withTimezone=r,this.config.precision=n}build(e){return new nl(e,this.config)}},nl=class extends z{static[_]="PgTimestamp";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":` (${this.precision})`}${this.withTimezone?" with time zone":""}`}mapFromDriverValue=e=>new Date(this.withTimezone?e:e+"+0000");mapToDriverValue=e=>e.toISOString()},gx=class extends xn{static[_]="PgTimestampStringBuilder";constructor(e,r,n){super(e,"string","PgTimestampString"),this.config.withTimezone=r,this.config.precision=n}build(e){return new il(e,this.config)}},il=class extends z{static[_]="PgTimestampString";withTimezone;precision;constructor(e,r){super(e,r),this.withTimezone=r.withTimezone,this.precision=r.precision}getSQLType(){return`timestamp${this.precision===void 0?"":`(${this.precision})`}${this.withTimezone?" with time zone":""}`}}});function Ij(t){return new vx(t??"")}var vx,al,bx=S(()=>{H();kt();Pe();vx=class extends re{static[_]="PgUUIDBuilder";constructor(e){super(e,"string","PgUUID")}defaultRandom(){return this.default(y`gen_random_uuid()`)}build(e){return new al(e,this.config)}},al=class extends z{static[_]="PgUUID";getSQLType(){return"uuid"}}});function Gt(t,e={}){let{name:r,config:n}=ke(t,e);return new xx(r,n)}var xx,wx,_x=S(()=>{H();Je();Pe();xx=class extends re{static[_]="PgVarcharBuilder";constructor(e,r){super(e,"string","PgVarchar"),this.config.length=r.length,this.config.enumValues=r.enum}build(e){return new wx(e,this.config)}},wx=class extends z{static[_]="PgVarchar";length=this.config.length;enumValues=this.config.enumValues;getSQLType(){return this.length===void 0?"varchar":`varchar(${this.length})`}}});function kj(t,e){let{name:r,config:n}=ke(t,e);return new Sx(r,n)}var Sx,Ex,Ax=S(()=>{H();Je();Pe();Sx=class extends re{static[_]="PgBinaryVectorBuilder";constructor(e,r){super(e,"string","PgBinaryVector"),this.config.dimensions=r.dimensions}build(e){return new Ex(e,this.config)}},Ex=class extends z{static[_]="PgBinaryVector";dimensions=this.config.dimensions;getSQLType(){return`bit(${this.dimensions})`}}});function Rj(t,e){let{name:r,config:n}=ke(t,e);return new Cx(r,n)}var Cx,Px,Tx=S(()=>{H();Je();Pe();Cx=class extends re{static[_]="PgHalfVectorBuilder";constructor(e,r){super(e,"array","PgHalfVector"),this.config.dimensions=r.dimensions}build(e){retur
2026-Jan-18 17:01:11.231394 ----------------------------------------
2026-Jan-18 17:01:11.256702 Removing old containers.
2026-Jan-18 17:01:11.284742 ----------------------------------------
2026-Jan-18 17:01:11.313425 WARNING: Dockerfile or Docker Image based deployment detected. The healthcheck needs a curl or wget command to check the health of the application. Please make sure that it is available in the image or turn off healthcheck on Coolify's UI.
2026-Jan-18 17:01:11.340499 ----------------------------------------
2026-Jan-18 17:01:11.366238 New container is not healthy, rolling back to the old container.
2026-Jan-18 17:01:11.793170 [CMD]: docker stop -t 30 zsg08co8ocgcgoo4o8okgccw-165738101001
2026-Jan-18 17:01:11.793170 zsg08co8ocgcgoo4o8okgccw-165738101001
2026-Jan-18 17:01:12.208188 [CMD]: docker rm -f zsg08co8ocgcgoo4o8okgccw-165738101001
2026-Jan-18 17:01:12.208188 zsg08co8ocgcgoo4o8okgccw-165738101001
2026-Jan-18 17:01:12.226143 Rolling update completed.
2026-Jan-18 17:01:13.353757 Gracefully shutting down build container: hcckg4sggwwogskw8soscgcw
2026-Jan-18 17:01:13.895585 [CMD]: docker stop -t 30 hcckg4sggwwogskw8soscgcw
2026-Jan-18 17:01:13.895585 hcckg4sggwwogskw8soscgcw