docker compose logs -f simulavoto
WARN[0000] Found multiple config files with supported names: /opt/simulavoto/docker-compose.yml, /opt/simulavoto/docker-compose.yaml 
WARN[0000] Using /opt/simulavoto/docker-compose.yml     
simulavoto  | === SimulaVoto - Sistema Eleitoral Brasileiro ===
simulavoto  | Environment: production
simulavoto  | Port: 5000
simulavoto  | Database mode: EXTERNAL (Supabase/cloud)
simulavoto  | Host: 72.60.255.204:5432
simulavoto  | Host is already an IPv4 address: 72.60.255.204
simulavoto  | DATABASE_SSL=auto
simulavoto  | SSL: auto mode - testing connection...
simulavoto  | SSL: SSL failed, testing without SSL...
simulavoto  | SSL: connected WITHOUT SSL
simulavoto  | Final host: 72.60.255.204
simulavoto  | 
simulavoto  | Running database schema sync (db:push)...
simulavoto  | 
simulavoto  | > rest-express@1.0.0 db:push
simulavoto  | > drizzle-kit push
simulavoto  | 
simulavoto  | No config path provided, using default 'drizzle.config.ts'
simulavoto  | Reading config file '/app/drizzle.config.ts'
simulavoto  | Using 'pg' driver for database querying
simulavoto  | [⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[✓] Pulling schema from database...
simulavoto  | [✓] Changes applied
simulavoto  | npm notice
simulavoto  | npm notice New major version of npm available! 10.8.2 -> 11.10.0
simulavoto  | npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.10.0
simulavoto  | npm notice To update run: npm install -g npm@11.10.0
simulavoto  | npm notice
simulavoto  | db:push completed successfully!
simulavoto  | 
simulavoto  | Starting application...
simulavoto  | 
simulavoto  | > rest-express@1.0.0 start
simulavoto  | > NODE_ENV=production node dist/index.cjs
simulavoto  | 
simulavoto  | Starting database initialization...
simulavoto  | NODE_ENV: production
simulavoto  | DATABASE_URL exists: true
simulavoto  | Database mode: EXTERNAL (Supabase/cloud)
simulavoto  | DATABASE_URL host: 72.60.255.204
simulavoto  | DATABASE_URL port: 5432
simulavoto  | DATABASE_URL protocol: postgresql:
simulavoto  | Resolving external database hostname to IPv4...
simulavoto  | SSL mode: auto (DATABASE_SSL=auto)
simulavoto  | SSL: auto - trying with SSL first...
simulavoto  | SSL: connection with SSL failed, trying without SSL...
simulavoto  | SSL error: The server does not support SSL connections
simulavoto  | SSL: connected successfully WITHOUT SSL
simulavoto  | Database pool initialized successfully
simulavoto  | Testing database connection...
simulavoto  | Database connection test successful!
simulavoto  | [Migration] 4 indexes missing, creating in background (server will start now)...
simulavoto  | Registering routes...
simulavoto  | [Startup] Checking for stuck import jobs from previous crash...
simulavoto  | [Migration/BG] Creating index idx_tse_cv_nm_urna_upper...
simulavoto  | [Startup] No stuck import jobs found.
simulavoto  | [SessionStore] Session table ready
simulavoto  | Routes registered successfully!
simulavoto  | WebSocket server initialized on /ws/imports
simulavoto  | WebSocket server initialized
simulavoto  | 6:46:38 PM [express] serving on port 5000
simulavoto  | Report scheduler started (checking every 5 minutes)
simulavoto  | 6:46:42 PM [express] HEAD /api/health 200 in 14ms :: {"status":"healthy","timestamp":"2026-02-19T18:46:42.033Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | [Migration/BG] Index idx_tse_cv_nm_urna_upper created.
simulavoto  | [Migration/BG] Creating index idx_tse_cv_nm_cand_upper...
simulavoto  | [Migration/BG] Index idx_tse_cv_nm_cand_upper created.
simulavoto  | [Migration/BG] Creating index idx_tse_cv_nm_candidato_trgm...
simulavoto  | 6:47:12 PM [express] HEAD /api/health 200 in 24ms :: {"status":"healthy","timestamp":"2026-02-19T18:47:12.132Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | 6:47:42 PM [express] HEAD /api/health 200 in 23ms :: {"status":"healthy","timestamp":"2026-02-19T18:47:42.236Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | 6:48:12 PM [express] HEAD /api/health 200 in 32ms :: {"status":"healthy","timestamp":"2026-02-19T18:48:12.356Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | 6:48:42 PM [express] HEAD /api/health 200 in 24ms :: {"status":"healthy","timestamp":"2026-02-19T18:48:42.466Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | [Migration/BG] Index idx_tse_cv_nm_candidato_trgm created.
simulavoto  | [Migration/BG] Creating index idx_tse_cv_nm_urna_trgm...
simulavoto  | 6:49:12 PM [express] HEAD /api/health 200 in 37ms :: {"status":"healthy","timestamp":"2026-02-19T18:49:12.585Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | 6:49:42 PM [express] HEAD /api/health 200 in 34ms :: {"status":"healthy","timestamp":"2026-02-19T18:49:42.720Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | 6:50:08 PM [express] GET /api/notifications 401 in 22ms :: {"error":"Unauthorized"}
simulavoto  | 6:50:12 PM [express] HEAD /api/health 200 in 44ms :: {"status":"healthy","timestamp":"2026-02-19T18:50:12.860Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | 6:50:38 PM [express] GET /api/notifications 401 in 5ms :: {"error":"Unauthorized"}
simulavoto  | [Migration/BG] Index idx_tse_cv_nm_urna_trgm created.
simulavoto  | [Migration/BG] Background index creation complete.
simulavoto  | 6:50:42 PM [express] HEAD /api/health 200 in 9ms :: {"status":"healthy","timestamp":"2026-02-19T18:50:42.939Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | 6:51:08 PM [express] GET /api/notifications 401 in 1ms :: {"error":"Unauthorized"}
simulavoto  | 6:51:13 PM [express] HEAD /api/health 200 in 30ms :: {"status":"healthy","timestamp":"2026-02-19T18:51:13.051Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}
simulavoto  | 6:51:25 PM [express] GET /api/auth/me 401 in 2ms :: {"error":"Unauthorized"}
simulavoto  | 6:51:43 PM [express] HEAD /api/health 200 in 12ms :: {"status":"healthy","timestamp":"2026-02-19T18:51:43.151Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":8}}

