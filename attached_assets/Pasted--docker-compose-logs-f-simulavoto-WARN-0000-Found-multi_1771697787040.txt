 docker compose logs -f simulavoto
WARN[0000] Found multiple config files with supported names: /opt/simulavoto/docker-compose.yml, /opt/simulavoto/docker-compose.yaml 
WARN[0000] Using /opt/simulavoto/docker-compose.yml     
simulavoto  | === SimulaVoto - Sistema Eleitoral Brasileiro ===
simulavoto  | Environment: production
simulavoto  | Port: 5000
simulavoto  | Database mode: EXTERNAL (Supabase/cloud)
simulavoto  | Host: 72.60.255.204:5432
simulavoto  | Host is already an IPv4 address: 72.60.255.204
simulavoto  | DATABASE_SSL=auto
simulavoto  | SSL: auto mode - testing connection...
simulavoto  | SSL: SSL failed, testing without SSL...
simulavoto  | SSL: connected WITHOUT SSL
simulavoto  | Final host: 72.60.255.204
simulavoto  | 
simulavoto  | Running database schema sync (db:push)...
simulavoto  | 
simulavoto  | > rest-express@1.0.0 db:push
simulavoto  | > drizzle-kit push
simulavoto  | 
simulavoto  | No config path provided, using default 'drizzle.config.ts'
simulavoto  | Reading config file '/app/drizzle.config.ts'
simulavoto  | Using 'pg' driver for database querying
simulavoto  | [⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[⣯] Pulling schema from database...
[⣟] Pulling schema from database...
[⡿] Pulling schema from database...
[⢿] Pulling schema from database...
[⣻] Pulling schema from database...
[⣽] Pulling schema from database...
[⣷] Pulling schema from database...
[✓] Pulling schema from database...
simulavoto  | [✓] Changes applied
simulavoto  | npm notice
simulavoto  | npm notice New major version of npm available! 10.8.2 -> 11.10.1
simulavoto  | npm notice Changelog: https://github.com/npm/cli/releases/tag/v11.10.1
simulavoto  | npm notice To update run: npm install -g npm@11.10.1
simulavoto  | npm notice
simulavoto  | db:push completed successfully!
simulavoto  | 
simulavoto  | Starting application...
simulavoto  | 
simulavoto  | > rest-express@1.0.0 start
simulavoto  | > NODE_ENV=production node dist/index.cjs
simulavoto  | 
simulavoto  | Starting database initialization...
simulavoto  | NODE_ENV: production
simulavoto  | DATABASE_URL exists: true
simulavoto  | Database mode: EXTERNAL (Supabase/cloud)
simulavoto  | DATABASE_URL host: 72.60.255.204
simulavoto  | DATABASE_URL port: 5432
simulavoto  | DATABASE_URL protocol: postgresql:
simulavoto  | Resolving external database hostname to IPv4...
simulavoto  | SSL mode: auto (DATABASE_SSL=auto)
simulavoto  | SSL: auto - trying with SSL first...
simulavoto  | SSL: connection with SSL failed, trying without SSL...
simulavoto  | SSL error: The server does not support SSL connections
simulavoto  | SSL: connected successfully WITHOUT SSL
simulavoto  | Database pool initialized successfully
simulavoto  | Testing database connection...
simulavoto  | Database connection test successful!
simulavoto  | [Migration] 7 indexes missing, creating in background (server will start now)...
simulavoto  | Registering routes...
simulavoto  | [Startup] Checking for stuck import jobs from previous crash...
simulavoto  | [Migration/BG] Creating index idx_tse_cv_nm_urna_upper...
simulavoto  | [Startup] No stuck import jobs found.
simulavoto  | [SessionStore] Session table ready
simulavoto  | Routes registered successfully!
simulavoto  | WebSocket server initialized on /ws/imports
simulavoto  | WebSocket server initialized
simulavoto  | 6:09:20 PM [express] serving on port 5000
simulavoto  | Report scheduler started (checking every 5 minutes)
simulavoto  | 6:09:24 PM [express] HEAD /api/health 200 in 14ms :: {"status":"healthy","timestamp":"2026-02-21T18:09:24.320Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | [Migration/BG] Index idx_tse_cv_nm_urna_upper created.
simulavoto  | [Migration/BG] Creating index idx_tse_cv_nm_cand_upper...
simulavoto  | [Migration/BG] Index idx_tse_cv_nm_cand_upper created.
simulavoto  | [Migration/BG] Creating index idx_tse_cv_partido_votos...
simulavoto  | 6:09:54 PM [express] HEAD /api/health 200 in 26ms :: {"status":"healthy","timestamp":"2026-02-21T18:09:54.409Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | [Migration/BG] Index idx_tse_cv_partido_votos created.
simulavoto  | [Migration/BG] Creating index idx_tse_pv_partido_legenda...
simulavoto  | [Migration/BG] Index idx_tse_pv_partido_legenda created.
simulavoto  | [Migration/BG] Creating index idx_tse_pv_ano_uf...
simulavoto  | [Migration/BG] Index idx_tse_pv_ano_uf created.
simulavoto  | [Migration/BG] Creating index idx_tse_cv_nm_candidato_trgm...
simulavoto  | 6:10:24 PM [express] HEAD /api/health 200 in 28ms :: {"status":"healthy","timestamp":"2026-02-21T18:10:24.499Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | 6:10:54 PM [express] HEAD /api/health 200 in 24ms :: {"status":"healthy","timestamp":"2026-02-21T18:10:54.598Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | 6:11:24 PM [express] HEAD /api/health 200 in 37ms :: {"status":"healthy","timestamp":"2026-02-21T18:11:24.697Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | 6:11:54 PM [express] HEAD /api/health 200 in 22ms :: {"status":"healthy","timestamp":"2026-02-21T18:11:54.780Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | [Migration/BG] Index idx_tse_cv_nm_candidato_trgm created.
simulavoto  | [Migration/BG] Creating index idx_tse_cv_nm_urna_trgm...
simulavoto  | 6:12:24 PM [express] HEAD /api/health 200 in 20ms :: {"status":"healthy","timestamp":"2026-02-21T18:12:24.871Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | 6:12:54 PM [express] HEAD /api/health 200 in 29ms :: {"status":"healthy","timestamp":"2026-02-21T18:12:54.960Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | 6:13:25 PM [express] HEAD /api/health 200 in 27ms :: {"status":"healthy","timestamp":"2026-02-21T18:13:25.053Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | [Migration/BG] Index idx_tse_cv_nm_urna_trgm created.
simulavoto  | [Migration/BG] Background index creation complete.
simulavoto  | 6:13:55 PM [express] HEAD /api/health 200 in 7ms :: {"status":"healthy","timestamp":"2026-02-21T18:13:55.141Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | 6:14:25 PM [express] HEAD /api/health 200 in 7ms :: {"status":"healthy","timestamp":"2026-02-21T18:14:25.226Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | 6:14:55 PM [express] HEAD /api/health 200 in 21ms :: {"status":"healthy","timestamp":"2026-02-21T18:14:55.306Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | 6:15:25 PM [express] HEAD /api/health 200 in 30ms :: {"status":"healthy","timestamp":"2026-02-21T18:15:25.398Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}
simulavoto  | 6:15:55 PM [express] HEAD /api/health 200 in 26ms :: {"status":"healthy","timestamp":"2026-02-21T18:15:55.499Z","version":"1.0.0","database":"connected","stats":{"parties":32,"candidates":90}}

